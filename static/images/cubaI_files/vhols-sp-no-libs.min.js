//v5.5.9
!function(){"use strict";angular.module("vhols-application-state",[]),angular.module("vhols-popular-destinations",[]),angular.module("vhols-submit",["vhols-dates"]),angular.module("vhols-bookingtype-select",["vhols-bookingtypes","LocalStorageModule","vhols-search-panel-tpls","vhols-search-tracking"]),angular.module("vhols-bookingtypes",["LocalStorageModule"]),angular.module("vhols-checkbox-list",["vhols-search-panel-tpls"]),angular.module("vhols-date-picker",["vhols-dates","ui.bootstrap","LocalStorageModule","vhols-search-panel-tpls"]),angular.module("vhols-date-select-list",["vhols-dates","LocalStorageModule","vhols-search-panel-tpls"]),angular.module("vhols-departure-gateway-picker",["LocalStorageModule","vhols-application-state","vhols-search-panel-tpls"]),angular.module("vhols-destinations-list",["vhols-popular-destinations","vhols-bookingtypes","vhols-departure-gateway-picker","vhols-checkbox-list","vhols-search-panel-tpls"]),angular.module("vhols-destinations-list-modal",["vhols-destinations-list","vhols-search-panel-tpls"]),angular.module("vhols-destinations-list-dropdown",[]),angular.module("vhols-duration-picker",["vhols-dates","LocalStorageModule","vhols-search-panel-tpls"]),angular.module("vhols-party-composition",["LocalStorageModule","vhols-search-panel-tpls"]),angular.module("vhols-search-panel-api",["vhols-bookingtypes","vhols-application-state","vhols-dates"]),angular.module("vhols-synchronise-checkbox",["LocalStorageModule","vhols-search-panel-tpls","vhols-application-state"]),angular.module("vhols-time-picker",["vhols-dates","LocalStorageModule","vhols-search-panel-tpls"]),angular.module("vhols-type-ahead",["ui.bootstrap","LocalStorageModule","vhols-application-state","vhols-search-panel-tpls"]),angular.module("vhols-submit-cookie",[]),angular.module("vhols-ab-config",["ipCookie"]),angular.module("vhols-search-tracking",["vhols-ab-config"]),angular.module("vhols-range-picker",["ui.bootstrap","vhols-search-panel-tpls","vhols-date-utils"]),angular.module("vhols-persistent-checkbox",["vhols-search-panel-tpls","LocalStorageModule"]),angular.module("vhols-multiple-departure-picker",["vhols-search-panel-tpls","LocalStorageModule"]),angular.module("vhols-utils",[]),angular.module("vhols-date-utils",[]),angular.module("vhols-resize",[]),angular.module("vhols-nine-plus",["ngResource"]),angular.module("vhols-pattern-icon",[]),angular.module("vhols-validation",[]),angular.module("vhols-holiday-picker",["vhols-party-composition","vhols-date-utils"]),angular.module("vholsSearchPanel",["LocalStorageModule","ipCookie","vhols-ab-config","vhols-search-tracking","vhols-dates","vhols-type-ahead","vhols-date-picker","vhols-party-composition","vhols-bookingtype-select","vhols-destinations-list-modal","vhols-destinations-list-dropdown","vhols-departure-gateway-picker","vhols-time-picker","vhols-synchronise-checkbox","vhols-date-select-list","vhols-submit","vhols-persistence","vhols-search-panel-api","vhols-duration-picker","vhols-submit-cookie","vhols-multiple-departure-picker","vhols-persistent-checkbox","vhols-range-picker","vhols-utils","vhols-holiday-picker","vhols-resize","vhols-nine-plus","vhols-pattern-icon","vhols-validation"])}(),function(){"use strict";angular.module("vholsSearchPanel").run(["ABConfig",function(e){}])}(),function(){"use strict";function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}return"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}(),function(){"use strict";var e=function(e){var t={config:{},_onSetConfig:function(e,t){},_onGetConfig:function(e,t){return t}};return t.setConfig=function(e,a,n){n&&void 0!==t.config[e]||(t.config[e]=a,t._onSetConfig(e,a))},t.getConfig=function(e){return t._onGetConfig(e,t.config[e])},e.VHAB?e.VHAB:(e.VHAB=t,t)};e(window),angular.module("vhols-ab-config").factory("ABConfig",["$window","ipCookie","AB_CONST","$rootScope",function(t,a,n,i){function o(e,t){i.$broadcast(n.PREFIX+e,t)}function s(e){var t;try{t=a()}catch(i){t={}}angular.forEach(t,function(t,a){0===a.indexOf(n.PREFIX)&&e.setConfig(a.substring(n.PREFIX.length),t,!0)})}function l(e){var a;try{a=t.location.search.substring(1).split("&")}catch(i){a=[]}angular.forEach(a,function(t){var a=t.split("=");if(0===a[0].indexOf(n.PREFIX)){var i=decodeURIComponent(a[1]);try{i=JSON.parse(i)}finally{e.setConfig(a[0].substring(n.PREFIX.length),i,!0)}}})}var r={config:{}};r.get=function(e){return r.config[e]},r.set=function(e,t){r.config[e]=t,o(e,t)};var c=e(t);return r.config=c.config,l(c),s(c),c._onSetConfig=function(e,t){o(e,t)},r}])}(),function(){"use strict";angular.module("vholsSearchPanel").constant("JS_EVENTS",{CLICK:"click",DESTROY:"$destroy"}).constant("EVENTS",{CLOSE_DATE_PICKERS:"closeDatePickers",DEST_LIST_SELECTED:"destinationsList:selected",ROOMS_TOGGLE:"rooms:toggle",SELECT_BOOKING_TYPE_TAB:"select:bookingTypeTab",TOUR_MONTH_CHANGED:"tourmonth:changed",PARTY_COMP_INVALID:"partyComp:invalid"}).constant("MULTI_CENTRE_CONFIG",{MONTHS_TO_SHOW:11,UNTIL_END_OF:"month"}).constant("DATES",{DATE_FORMAT:"EEE, dd MMM yyyy",MONTH_YEAR:"MMM YYYY",PERSIST_STRING:"YYYY/MM/DD",URL_STRING:"DD-MM-YYYY",URL_TIME:"HH:mm"}).constant("LOCATIONS",{LOCATION_SEARCH:"/locations-public-api/search/location",BOOKINGTYPES:"/locations-public-api/refdata/BOOKINGTYPE",TOURS:"/locations-public-api/refdata/TOURSDESTINATIONS",CRUISE:"/locations-public-api/refdata/CRUISEDESTINATIONS",POPULAR_DESTINATIONS:"/locations-public-api/refdata/POPULARDESTINATIONS",TOUR_DATES:"/locations-public-api/tour-dates/{{brand}}/{{tourId}}",CRUISE_DATES:"/locations-public-api/cruise-dates/{{brand}}/{{cruiseId}}"}).constant("LOCATION_TYPE_ID",{REGION:"10",COUNTRY:"20",STATE:"30",CITY:"40",HOTEL:"100"}).constant("BOOKING_TYPE_CONST",{COMPLETE_HOLIDAY:"COMPLETE_HOLIDAY",FLY_DRIVE:"FLY_DRIVE",HOTEL_ONLY:"HOTEL_ONLY",MULTI_CENTRE:"MULTI_CENTRE",TOURS:"TOURS",CRUISE:"CRUISE"}).constant("URL",{DELIMITER:"&"}).constant("API_EVENTS",{INIT_BT:"SearchPanel:initBookingType",BT_CHANGED:"SearchPanel:bookingTypeChanged",STATE_CHANGED:"SearchPanel:stateChanged",POPULATE:"SearchPanel:populate",LOAD:"SearchPanel:load",LOADED:"SearchPanel:loaded",SUBMITTED:"SearchPanel:submitted",DO_SEARCH:"SearchPanel:doSearch",OVERRIDE_DEFAULT_SUBMIT:"SearchPanel:overrideDefaultSubmit",READ_ONLY:"SearchPanel:readOnly",UPDATE_SEARCH_CRITERIA:"SearchPanel:updateSearchCriteria",LOCATION_CHANGED:"SearchPanel:locationChanged"}).constant("HANDOFF",{LIVE_URL:"http://book.virginholidays.co.uk/",TOURS:"/destinations/",TOURS_ANY:"/holiday-types/tours-and-safaris/tours",CRUISE:"//www.virginholidayscruises.co.uk/redirect.phtml?product=cruise&sid=16956&monthyear=",CAR:"https://cars.virginholidays.co.uk/#/search/car/205/"}).constant("ERROR_MESSAGING",{POPULAR_DESTINATIONS_NOT_AVAILABLE:"Popular destinations have not been loaded",NO_POPULAR_DESTINATIONS_FOR_BOOKING_TYPE:"Popular destinations have not been loaded for booking type: "}).constant("AB_CONST",{PREFIX:"vhab."})}(),function(){"use strict";angular.module("vhols-popular-destinations").factory("PopularDestinations",["$q","$http","$log","BookingTypeFactory","LOCATIONS","ERROR_MESSAGING",function(e,t,a,n,i,o){function s(e,t){return e.reduce(function(e,a){return a.bookingType===t&&e.push(a.destination),e},[])}var l={};return l.getDestinations=function(){var a=n.getSelectedBookingType();return e(function(e,n){t.get(i.POPULAR_DESTINATIONS).success(function(t){if(t&&t.values&&0!==t.values.length){var i=s(t.values,a.id);i&&0!==i.length?e(i):n(o.NO_POPULAR_DESTINATIONS_FOR_BOOKING_TYPE+a.id)}else n(o.POPULAR_DESTINATIONS_NOT_AVAILABLE)}).error(function(){n(o.POPULAR_DESTINATIONS_NOT_AVAILABLE)})})},l}])}(),function(){"use strict";angular.module("vhols-type-ahead").constant("SPELLING_CORRECTIONS",{carr:"caribbean",carri:"caribbean",carrib:"caribbean",carribe:"caribbean",carribea:"caribbean",carribean:"caribbean",caribe:"caribbean",caribea:"caribbean",caribean:"caribbean"}).controller("TypeAheadCtrl",["$scope","$rootScope","$log","locationService","localStorageService","ApplicationState","SearchTracking","API_EVENTS","JS_EVENTS","SPELLING_CORRECTIONS",function(e,t,a,n,i,o,s,l,r,c){function d(){var t;e.useTracking&&"carhire"!==e.$parent.searchType&&(t=e.asyncSelected?e.asyncSelected.locationDescription:void 0,s.sendEvent({name:"Destination Change",holidayType:e.$parent.searchType,destination:t}))}function u(a,i,o){e.asyncSelected=void 0,n.findExact(a,i,o).then(function(a){a.data&&(e.asyncSelected=a.data,t.$emit(l.LOCATION_CHANGED,a.data))})}function m(){return p()&&null!=e.asyncSelected.locationUrlDescription}function p(){return null!=e.asyncSelected}function h(){return p()&&e.asyncSelected.length<3}function v(){e.noResults=null,e.asyncSelected=null,d()}function g(e){return c[e.toLowerCase()]||e}e.init=function(){if(!e.persistKey)throw"a persistence key has not been provided";e.useTracking="undefined"==typeof e.useTracking||e.useTracking;var a=t.$on(l.STATE_CHANGED,function(){var t;o.state===o.POPULATED?"undefined"!=typeof e.asyncSelected&&"undefined"!=typeof e.asyncSelected.locationUrlDescription&&u(e.asyncSelected.locationUrlDescription,e.brand,e.bookingType):(t=i.get(e.persistKey))?u(t,e.brand,e.bookingType):null!==e.defaultLoc&&void 0!==e.defaultLoc&&u(e.defaultLoc,e.brand,e.bookingType),e.$on("$destroy",e.$watch("asyncSelected",function(){h()&&(e.noResults=!1),m()&&(d(),i.set(e.persistKey,e.asyncSelected.locationUrlDescription),e.noResults=!1)}))});e.$on(r.DESTROY,a)},e.getLocation=function(t){return t=g(t),n.find(t,e.brand,e.bookingType,e.maxResults,e.withEcmsId,e.locationTypes).then(function(t){return e.noResults=0===t.length,t})},e.clear=function(){v()}}])}(),function(){"use strict";angular.module("vhols-type-ahead").directive("typeAheadValidation",function(){return{restrict:"A",link:function(e,t,a){var n=t.find("input").controller("ngModel");e.$on("$destroy",e.$watch("noResults",function(e){n.$setValidity("noResultsError",!e)})),e.$on("$destroy",e.$watch("asyncSelected.locationMetadata",function(e){n.$setValidity("locationError",!!e)}))}}})}(),function(){"use strict";angular.module("vhols-type-ahead").directive("vholsTypeaheadTitle",["LOCATION_TYPE_ID",function(e){var t={hotels:0,destinations:0};return{restrict:"A",replace:!0,scope:{type:"=",go:"="},link:function(a,n){a.$on("$destroy",a.$watchCollection("go",function(){t.hotels>0&&a.type==e.HOTEL&&n.remove(),t.destinations>0&&a.type!=e.HOTEL&&n.remove(),a.type==e.HOTEL?t.hotels++:t.destinations++})),t.hotels=0,t.destinations=0}}}]).directive("vholsTypeAhead",["$parse","$window","$templateCache",function(e,t,a){return{restrict:"EA",replace:!0,scope:{name:"@",asyncSelected:"=",brand:"@",bookingType:"@",withEcmsId:"=",defaultLoc:"=",maxResults:"@",persistKey:"@",prompt:"@",noResults:"=",popularDestinations:"=",locationTypes:"=",isFormSubmitted:"="},link:function(e,a){e.init();var n=/msie 9/i.test(t.navigator.userAgent);n&&e.$on("$destroy",e.$watch("asyncSelected",function(){if(!e.asyncSelected){var t=angular.element(a.find("input"));t.val(t.attr("placeholder")),t.bind("focus",function(){t.val()===t.attr("placeholder")&&t.val("")})}}))},controller:"TypeAheadCtrl",template:a.get("template/typeahead/typeahead.html")}}]).directive("vholsPatternTypeAhead",["$parse","$window","$templateCache",function(e,t,a){return{restrict:"EA",replace:!0,scope:{name:"@",asyncSelected:"=",brand:"@",bookingType:"@",withEcmsId:"=",defaultLoc:"=",maxResults:"@",persistKey:"@",prompt:"@",noResults:"=",popularDestinations:"=",locationTypes:"=",useTracking:"=?"},link:function(e,a){e.init();var n=/msie 9/i.test(t.navigator.userAgent);n&&e.$on("$destroy",e.$watch("asyncSelected",function(){if(!e.asyncSelected){var t=angular.element(a.find("input"));t.val(t.attr("placeholder")),t.bind("focus",function(){t.val()===t.attr("placeholder")&&t.val("")})}}))},controller:"TypeAheadCtrl",template:a.get("template/typeahead/pattern-typeahead.html")}}])}(),function(){"use strict";angular.module("vhols-type-ahead").service("locationService",["$http","LOCATIONS","LOCATION_TYPE_ID",function(e,t,a){function n(e,a,n,i,o,s){var l=t.LOCATION_SEARCH+"?q="+encodeURIComponent(e.toLowerCase())+"&brand="+a+"&resultSize="+i+"&bookingType="+n+"&searchableOnly=true&withECMSId="+o;return s&&s.length&&angular.forEach(s,function(e){l+="&locationType="+e}),l}function i(e){var t=[],n=[],i=[],o=e.data.totals,s=o.filter(function(e){return e.locationTypes.indexOf(a.HOTEL)!==-1});return s=void 0!==s[0]?s[0].totalCount:0,e.data.items.map(function(e){e.locationTypeId==a.HOTEL?i.push(angular.extend({totalCount:s},e)):n.push(e)}),t.concat(n,i)}this.find=function(t,a,o,s,l,r){var c=n(t,a,o,s,l,r);return e.get(c,{cache:!1}).then(i)},this.findExact=function(a,n,i){var o=t.LOCATION_SEARCH+"/"+a+"?bookingType="+i+"&brand="+n;return e.get(o,{cache:!0})}}])}(),function(){"use strict";angular.module("vhols-bookingtypes").factory("BookingTypeFactory",["localStorageService","BOOKING_TYPES",function(e,t){var a=t,n={bookingType:null};return n.getBookingTypes=function(){return a},n.getBookingType=function(e){for(var t=n.getBookingTypes(),a=0;a<t.length;a++)if(t[a].id===e)return t[a]},n.getSelectedBookingType=function(){return n.bookingType},n.setSelectedBookingType=function(e){n.bookingType=e},n.getBookingTypeFromMapping=function(e){if(!e)return null;for(var t=null,a=n.getBookingTypes(),i=0;i<a.length;i++){var o=a[i].mappingValue;if(o&&e.indexOf(o)>0){t=a[i];break}}return t},n}])}(),function(){"use strict";angular.module("vhols-bookingtype-select").constant("MULTICENTRE_TAB_ID",6).controller("BookingTypeSelectCtrl",["$rootScope","$scope","BookingTypeFactory","localStorageService","ApplicationState","SearchTracking","JS_EVENTS","API_EVENTS","PERSIST_KEY","EVENTS","LocationUtils","ABConfig","MULTICENTRE_TAB_ID","$timeout","FLYDRIVE_NAME_TEST","persist",function(e,t,a,n,i,o,s,l,r,c,d,u,m,p,h,v){function g(){var e=d.getLocationSearchObject(location),t=f(e);t&&n.set(y,t)}function f(e){var t=null,n="utm_campaign",i=e[n];return i&&(t=a.getBookingTypeFromMapping(i)),t}var y=r.BOOKING_TYPE_KEY,b=!1;t.init=function(){var e=v(t),n=e.get(h);if(t.name_type=2==n?"b":"a",t.showList=!1,t.bookingTypes=a.getBookingTypes(),t.isMultiCentreEnabled=!0,!t.isMultiCentreEnabled){var i=t.bookingTypes.map(function(e){return e.id}).indexOf(m);i>-1&&t.bookingTypes.splice(i,1)}};var D=e.$on(l.INIT_BT,function(){i.state===i.POPULATED?a.bookingType=a.getBookingType(i.criteria.selectedBookingType.id):(b||(g(),b=!0),a.bookingType=n.get(y)?n.get(y):a.getBookingTypes()[a.getBookingTypes().map(function(e){return e["default"]}).indexOf(!0)]),p(function(){t.selectedBookingType=a.bookingType,t.selectedBookingType.hideOtherTabs||n.set(y,t.selectedBookingType)})}),k=e.$on(c.SELECT_BOOKING_TYPE_TAB,function(e,n){t.setSelectedBookingType(a.getBookingType(n))});t.$on(s.DESTROY,D),t.$on(s.DESTROY,k),t.setSelectedBookingType=function(i){a.bookingType=i,e.$emit(l.BT_CHANGED),t.selectedBookingType=a.bookingType,n.set(y,t.selectedBookingType),o.sendEvent({name:"Holiday Type Tab Change",holidayType:i.shortName})}}])}(),function(){"use strict";angular.module("vhols-bookingtype-select").directive("vholsBookingtypeSelect",["$templateCache",function(e){return{replace:!0,scope:{id:"@",selectedBookingType:"=",label:"@"},template:e.get("bookingtype.html"),controller:"BookingTypeSelectCtrl",link:function(e){e.init()}}}]).directive("tabbedBar",["$window","$timeout",function(e,t){return{link:function(a,n){function i(t){var a=new CustomEvent("initialise-tabbed-bar",{detail:{tabbedBar:t}});e.dispatchEvent(a)}var o=n[0].querySelector(".bar-tabs-container"),s=angular.element(n[0].querySelector(".scroller"));e.addEventListener("orientationchange",function(){t(function(){s.toggleClass("hidden",n[0].offsetWidth>=o.scrollWidth),i(n)},100)}),a.$on("$destroy",a.$watch(function(){return n[0].offsetWidth>0&&n[0].offsetWidth<o.scrollWidth},function(e){s.toggleClass("hidden",!e),e?i(n):o.style.transform=""})),a.$on("$destroy",a.$on("visibilityChanged",function(){s.toggleClass("hidden",n[0].offsetWidth>=o.scrollWidth),i(n)})),a.$on("$destroy",function(){e.removeEventListener("orientationchange")})}}}])}(),function(){"use strict";angular.module("vhols-bookingtype-select").factory("LocationUtils",function(){function e(e){var a=e&&e.search&&e.search.substring(1),n={};if(a)try{n=t(a)}catch(i){try{n=t(encodeURI(a))}catch(i){n={}}}return n}function t(e){return JSON.parse('{"'+e.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,t){return""===e?t:decodeURIComponent(t)})}return{getLocationSearchObject:e}})}(),function(){"use strict";angular.module("vhols-date-picker").controller("DateInputCtrl",["$rootScope","$scope","dates","localStorageService","ApplicationState","SearchTracking","API_EVENTS","JS_EVENTS","EVENTS","DATES","ObjectUtils",function(e,t,a,n,i,o,s,l,r,c,d){function u(){var e=i.criteria&&i.criteria[t.persistKey];return e||(e=n.get(t.persistKey)),e}function m(){p(),n.get(k)&&(t.noNights=n.get(k))}function p(){if(!t.watchCheckIn){var e=u();!e||a(e).isBefore(t.minDate,"day")||a(e).isAfter(t.maxDate,"day")?t.date=t.initialDate:t.date=a(e).asDate()}}function h(){var a={};a[k]=t.noNights,a[t.persistKey]=t.date,e.$emit(s.UPDATE_SEARCH_CRITERIA,a)}function v(e,n){for(var i=[],o=new Date,s="end"===t.popupType?t.minDate:o,l=0;l<=e;l++){var r={label:a(s).addMonths(l).format(D),idx:l,move:l-n};i.push(r)}return t.selectedMonth=i[n],i}function g(e){angular.element(document.querySelector(".opened .calendar")).length>0&&angular.element(document.querySelector(".opened .calendar")).scope().$parent.move(e)}function f(e,t){angular.element(e).length>0&&angular.element(e).scope().$parent.select(t)}function y(){var e="end"===t.popupType?t.date:t.monthOnView,n=t.dateSelections.filter(function(t){return t.label==a(e).format(D)})[0];if(n)return t.dateSelections=v(t.monthsToShow,n.idx),n.idx}function b(){if(t.useTracking){var e=d.searchScopeParents(t,"searchType");"carhire"!==e&&o.sendEvent({name:"Departure Date Change",holidayType:e,startDate:moment(t.date).format("DD-MM-YYYY")})}}var D=c.MONTH_YEAR;t.selectedMonth={},t.monthsToShow=t.monthsToShow?t.monthsToShow:8;var k="noNights";if(t.format=c.DATE_FORMAT,t.showWeeks=!1,t.opened=!1,t.dateOptions={"starting-day":1,"show-button-bar":!1,"show-weeks":!1},t.useTracking="undefined"==typeof t.useTracking||t.useTracking,!t.persistKey)throw"a persistence key has not been provided";m();var S=t.$watch(k,function(e){n.set(k,e)}),T=t.$watch("watchCheckIn",function(e){"undefined"!=typeof e&&(t.date=a(e).addDays(t.noNights).asDate(),t.minDate=a(e).addDays(t.minNights).asDate(),t.maxDate=a(e).addDays(t.maxNights).asDate())}),C=t.$watch("date",function(e,i){n.set(t.persistKey,a(e).format()),0!==moment(e).diff(moment(i))&&b(),h()});t.$on(l.DESTROY,S),t.$on(l.DESTROY,T),t.$on(l.DESTROY,C),setTimeout(function(){var e=t.$watch("watchCheckOut",function(e){"undefined"!=typeof e&&(t.noNights=a(t.watchCheckIn).diffDays(a(e)))}),n=t.$watchGroup(["minDate","maxDate"],function(){m()});t.$on(l.DESTROY,e),t.$on(l.DESTROY,n)}),t.open=function(e){function n(){return a(t.minDate).isSame(t.maxDate,"months")}a(t.monthOnView).isSame(t.date,"months")||(t.monthOnView=t.date,f(document.querySelector("."+t.popupType+" .calendar"),t.date)),t.$parent.$broadcast(r.CLOSE_DATE_PICKERS),e.preventDefault(),e.stopPropagation(),"end"===t.popupType&&(t.monthsToShow=n()?0:1),t.dateSelections=v(t.monthsToShow,0),t.monthsFromStart=y(),t.opened=!0},t.monthSelection=function(e){t.dateSelections=v(t.monthsToShow,e)},t.monthMove=function(e){t.monthOnView=a(new Date).addMonths(t.monthsFromStart).asDate(),g(e)}}])}(),function(){"use strict";angular.module("vhols-date-picker").directive("dateInput",["$templateCache","EVENTS",function(e,t){return{scope:{dateLabel:"=",dateName:"=",initialDate:"=",persistKey:"@",minDate:"=",maxDate:"=",minNights:"=",maxNights:"=",watchCheckIn:"=",watchCheckOut:"=",monthsToShow:"=",showNights:"=",noNights:"=",label:"@",srLabel:"=",popupType:"@",dateInputId:"@",datepickerAppendToBody:"@",directFlightEndpoint:"@",useTracking:"=?"},template:e.get("dateinput.html"),controller:"DateInputCtrl",link:function(e){e.$on(t.CLOSE_DATE_PICKERS,function(){e.opened=!1}),e.$watch("initialDate",function(){e.initialDate&&(e.date=e.initialDate)})}}}]),angular.module("vhols-date-picker").directive("datepickerPopup",function(){return{restrict:"EAC",require:"ngModel",link:function(e,t,a,n){n.$formatters.shift()}}})}(),function(){"use strict";angular.module("vhols-departure-gateway-picker").controller("DepartureGatewayCtrl",["$scope","localStorageService","ApplicationState","$timeout","$rootScope","API_EVENTS","SearchTracking",function(e,t,a,n,i,o,s){e.init=function(){function n(t){if(e.useTracking&&null!==t)if(["tour","cruise"].indexOf(e.$parent.searchType)>-1)s.sendEvent({name:"Destination Change",holidayType:e.$parent.searchType,destination:t.description||t.name});else if(null!==t){var a="undefined"!=typeof t&&"undefined"!=typeof t.code?[t.code]:[];s.sendEvent({name:"Departure Point Change",holidayType:e.$parent.searchType,gateway:a})}}function l(){if(a.state===a.POPULATED&&a.criteria.gatewayCode)return a.criteria.gatewayCode;var n=t.get(e.persistKey);return n?n:null}function r(t){var a=e.gateways,n=a.filter(function(e){return(e.code||e.id)===t});n.length>0?(e.selectedDepartureGateway=n[0],e.persist(e.selectedDepartureGateway)):e.selectedDepartureGateway=a[0]}function c(e){i.$emit(o.UPDATE_SEARCH_CRITERIA,{selectedDepartureGateway:e})}if(e.useTracking="undefined"==typeof e.useTracking||e.useTracking,!e.persistKey)throw"a persistence key has not been provided";e.$on("$destroy",e.$watch("gateways",function(){if(e.gateways){var t=l();t?r(t):e.selectedDepartureGateway=e.gateways[0]}})),e.$on("$destroy",e.$watch("selectedDepartureGateway",function(e){c(e),n(e)})),e.persist=function(a){a&&t.set(e.persistKey,a.code||a.id)}}}])}(),function(){"use strict";angular.module("vhols-departure-gateway-picker").directive("departureGateway",["$templateCache",function(e){return{restrict:"E",replace:!0,scope:{gateways:"=",selectedDepartureGateway:"=",persistKey:"@",useTracking:"=?"},template:e.get("departureGateway.html"),controller:"DepartureGatewayCtrl",link:function(e){e.init()}}}])}(),function(){"use strict";angular.module("vhols-departure-gateway-picker").directive("patternDepartureGateway",["$templateCache",function(e){return{restrict:"E",replace:!0,scope:{gateways:"=",selectedDepartureGateway:"=",persistKey:"@",required:"=?",name:"@",useTracking:"=?"},template:e.get("patternDepartureGateway.html"),controller:"DepartureGatewayCtrl",link:function(e){e.init()}}}])}(),function(){"use strict";angular.module("vhols-checkbox-list").controller("checkboxListCtl",["$scope",function(e){e.items=[],e.$on("$destroy",e.$watch("items",function(e){e.sort(function(e,t){return e.index-t.index})})),e.performToggle=function(t){e.toggledItem=t,e.items.forEach(function(a){a[e.itemId]!=t[e.itemId]&&(a.disabled=t.selected)})}}])}(),function(){"use strict";angular.module("vhols-checkbox-list").directive("checkboxList",["$templateCache",function(e){return{restrict:"E",replace:!0,controller:"checkboxListCtl",scope:{items:"=",toggledItem:"=",itemId:"@"},template:e.get("checkboxList.html")}}])}(),function(){"use strict";angular.module("vhols-destinations-list").constant("CLICK_THRESHOLD",100).controller("destinationsListCtl",["$scope","$log","$filter","BookingTypeFactory","PopularDestinations","locationsFactory","CLICK_THRESHOLD",function(e,t,a,n,i,o,s){function l(){i.getDestinations().then(function(e){u=e},function(e){u=[],t.warn(e)})["finally"](function(){r()})}function r(){function n(e){return e.sort(function(e,t){return e.locationDescription<t.locationDescription?-1:e.locationDescription>t.locationDescription?1:0})}function i(e){var t=[],i=[],o=[];return e.map(function(e){u.indexOf(e.locationId)!=-1?(e.type="popular",i.push(e)):(e.type="other",o.push(e))}),t.concat(a("orderBy")(i,["!!index","index"]),n(o))}var s={brand:e.brand,level:0,bookingType:e.bookingType,resultSize:e.resultSize,withECMSId:e.withEcmsId};t.debug("retrieving the parent locations for criteria: ",s);var l=function(a){t.debug("retrieved "+a.length+" parent locations"),e.parentLocations=i(a),e.selectedParentLocation=a[0]};o.getLocations(s,l)}function c(a){var n={brand:e.brand,level:a.selectedParentLocation.hierarchyLevel+1,parent:a.selectedParentLocation.locationId,bookingType:e.bookingType,resultSize:e.resultSize,withECMSId:e.withEcmsId};angular.extend(n,a.filters),t.debug("retrieving the child locations for criteria: ",n),o.getLocations(n,a.successCallback)}function d(e){var t=new Date;return m!==e?(m=e,p=t,!1):(m=e,t.getTime()-p.getTime()<=s?(p=t,!0):(p=t,!1))}e.selectedIdx=-1;var u,m=-1,p=new Date;e.selectLocation=function(a,n){if(!d(n)&&a){var i=function(i){t.debug("retrieved "+i.length+" child locations"),a.children||(a.children=i),e.selectedIdx=e.selectedIdx===n?-1:n};c({selectedParentLocation:a,successCallback:i})}},e.selectLocationForSearch=function(t){e.selectedChildLocation=t},e.init=function(){l()}}])}(),function(){"use strict";angular.module("vhols-destinations-list").directive("destinationsList",["$templateCache",function(e){var t=1;return{restrict:"E",replace:!0,controller:"destinationsListCtl",scope:{brand:"@",level:"@",parent:"@",bookingType:"@",locationType:"@",resultSize:"@",requiresDepartureGateway:"@",withEcmsId:"=",popularDestinations:"=",selectedParentLocation:"=",selectedChildLocation:"=",selectedDepartureGateway:"="},template:e.get("destinationsList.html"),link:function(e){e.uniqueId=t++,e.init()}}}])}(),function(){"use strict";angular.module("vhols-destinations-list").factory("locationsFactory",["$http","$log","LOCATION_TYPE_ID","LOCATIONS","URL",function(e,t,a,n,i){function o(e){var t=[],n=[],i=[];return e.items.map(function(e){e.locationTypeId==a.HOTEL?i.push(e):n.push(e)}),t.concat(n,i)}var s=n.LOCATION_SEARCH+"?",l={};return l.getLocations=function(a,n,i){var r=function(e){var t=o(e);return n(t)};a.searchableOnly=!0;var c=l.constructUrl(s,a);t.debug("attempting to call locations service with url:  "+c),i||(i=function(e){t.error(e)}),e.get(c,{cache:!0}).success(r).error(i)},l.constructUrl=function(e,t){var a=[];for(var n in t)t.hasOwnProperty(n)&&a.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));var o=a.join(i.DELIMITER);return e+o},l}])}(),function(){"use strict";angular.module("vhols-destinations-list-modal").controller("destinationListModalInstanceCtl",["$scope","$log","$modalInstance","instanceAttrs","$rootScope","EVENTS",function(e,t,a,n,i,o){e.brand=n.brand,e.level=n.level,e.parent=n.parent,e.bookingType=n.bookingType,e.locationType=n.locationType,e.resultSize=n.resultSize,e.requiresDepartureGateway=n.requiresDepartureGateway,e.withECMSId=n.withECMSId,e.popularDestinations=n.popularDestinations,e.$on("$destroy",e.$watch("selectedChildLocation",function(n){if(n){var s={selectedParentLocation:e.selectedParentLocation,selectedChildLocation:e.selectedChildLocation,selectedDepartureGateway:e.selectedDepartureGateway};a.close(s),i.$emit(o.DEST_LIST_SELECTED),t.debug("returned following result from modal instance",s)}})),e.cancel=function(){a.dismiss("cancel")},e.isValid=function(){return"true"===e.requiresDepartureGateway?null!==e.selectedDepartureGateway:null!==e.selectedChildLocation}}])}(),function(){"use strict";angular.module("vhols-destinations-list-modal").directive("stopEvent",function(){return{restrict:"A",link:function(e,t,a){t.on(a.stopEvent,function(e){e.stopPropagation()})}}}).directive("destinationsListModal",["$templateCache","$modal","$window","SearchTracking",function(e,t,a,n){return{transclude:!0,restrict:"EA",replace:!0,template:e.get("destinationsListOpen.html"),scope:{brand:"@",level:"@",parent:"@",bookingType:"=",locationType:"@",resultSize:"@",requiresDepartureGateway:"@",withEcmsId:"=",selectedParentLocation:"=",selectedChildLocation:"=",selectedDepartureGateway:"=",popularDestinations:"="},link:function(i){i.trackClick=function(){return void 0!==a.trackEvent&&void a.trackEvent("search form","click view as a list "+i.bookingType.name,"magnolia")},i.open=function(){n.sendEvent({name:"Destinations List",holidayType:i.bookingType.shortName});var o=a.innerWidth<1024,s=t.open({template:e.get("destinationsListModal.html"),size:"sm",openedClass:"destinations-list-modal-open",windowClass:"app-modal-window",controller:"destinationListModalInstanceCtl",backdrop:!o||"static",resolve:{instanceAttrs:function(){return{brand:i.brand,level:i.level,parent:i.parent,bookingType:i.bookingType.id,locationType:i.locationType,resultSize:i.resultSize,requiresDepartureGateway:i.requiresDepartureGateway,withECMSId:i.withEcmsId,popularDestinations:i.popularDestinations}}}});s.result.then(function(e){i.selectedParentLocation=e.selectedParentLocation,i.selectedChildLocation=e.selectedChildLocation,i.selectedDepartureGateway=e.selectedDepartureGateway})}}}}])}(),function(){"use strict";angular.module("vhols-destinations-list-dropdown").directive("destinationsListDropdown",["$templateCache",function(e){function t(e,t,a,n,i,o,s,l,r){function c(){var e=o.$on(i.STATE_CHANGED,function(){var e=r.state!==r.POPULATED;p(e)});t.$on("$destroy",e),t.$on("$destroy",t.$watch("selectedItem",function(){"undefined"!=typeof t.selectedItem&&"undefined"!=typeof t.selectedItem.locationId&&v()}))}function d(){var n=s.defer(),i=[],o=1,l=!!t.allowParentSelect&&t.allowParentSelect,r=!0,c=!1;return e.getItems(t.brand,t.bookingType,o,t.maxResults,t.withEcmsId,r,c,l).then(function(e){e=u(e,l),t.dropdownList=i.concat(e),n.resolve(t.dropdownList)},function(){t.dropdownList=i.concat([]),a.error("Could not load list items"),n.resolve(t.dropdownList)}),n.promise}function u(e,t){for(var a=[],n=0;n<e.length;n++){var i=e[n];i.groupLabel=i.parentDescriptionForDisplay,i.listName=i.locationDescription,i.displayOrder=i.index||0,0===i.hierarchyLevel?(i.displayOrder+=100,i.listName="All "+i.locationDescription,i.groupLabel=i.locationDescription):i.displayOrder+=1e3,t&&i.hierarchyLevel<1?a.push(i):i.hierarchyLevel<2&&a.push(i)}return a}function m(e,t,a){var n;if(e)return e.map(function(e){"undefined"!=typeof e[t]&&e[t]===a&&(n=e)}),n}function p(e){t.dropdownList?h(t.dropdownList,e):d().then(function(t){h(t,e)})}function h(e,a){var n=a?y():t.selectedItem&&t.selectedItem.locationUrlDescription,i=a?"locationId":"locationUrlDescription";"undefined"!=typeof n&&(t.selectedItem=m(e,i,n),v())}function v(){g(),f(t.selectedItem)}function g(){"undefined"!=typeof t.selectedItem&&"undefined"!=typeof t.selectedItem.locationDescription&&l.sendEvent({name:"Destination Change",holidayType:t.$parent.searchType,destination:t.selectedItem.locationDescription})}function f(e){"undefined"==typeof e||"undefined"==typeof e.locationId?n.remove(t.persistKey):n.set(t.persistKey,e.locationId)}function y(){return n.get(t.persistKey)}t.updateSelection=v,c()}return t.$inject=["DestinationListItemsService","$scope","$log","localStorageService","API_EVENTS","$rootScope","$q","SearchTracking","ApplicationState"],{restrict:"EA",template:e.get("destinationsListDropdown.html"),controller:t,scope:{selectedItem:"=selectedChildLocation",brand:"@",maxResults:"@",bookingType:"@",withEcmsId:"=",allowParentSelect:"=?",isFormSubmitted:"="}}}])}(),function(){"use strict";function e(e,t,a){function n(n,i,o,s,l,r,c,d){d="undefined"!=typeof d&&!!d;var u=["brand="+(n||205),"bookingType="+(i||6),"resultSize="+(s||100),"withECMSId="+("undefined"!=typeof l&&l),"searchableOnly="+("undefined"==typeof r||r)];d||u.push("level="+("undefined"!=typeof o?o:1));var m=a.LOCATION_SEARCH+"/?"+u.join("&");e.get(m,{cache:"undefined"!=typeof c&&c}).then(function(e){"undefined"!=typeof e.data&&"undefined"!=typeof e.data.items?p.resolve(e.data.items):p.resolve([])},function(e){p.reject(e)});var p=t.defer();return p.promise}this.getItems=n}angular.module("vhols-destinations-list-dropdown").service("DestinationListItemsService",e),e.$inject=["$http","$q","LOCATIONS"];
}(),function(){"use strict";angular.module("vhols-party-composition").constant("VIEW_STATE",{FORM:0,SUMMARY:1}).controller("RoomsCtrl",["$rootScope","$scope","partyCompositionService","localStorageService","ApplicationState","SearchTracking","VIEW_STATE","API_EVENTS","BOOKING_TYPE_CONST","JS_EVENTS","BUSINESS_CONTEXT",function(e,t,a,n,i,o,s,l,r,c,d){function u(){if(i.state===i.POPULATED&&i.criteria.selectedRooms)t.selectedRooms=T.buildRoomsUsingChildrenAndInfants(i.criteria.selectedRooms);else{var e=n.get(S);0===t.maxChildren&&angular.isArray(e)&&h(e),t.selectedRooms=T.buildRoomsUsingMinors(e),m(e,i)}}function m(e,a){null!=e&&e.length>0&&a.isFirstEntry()&&(t.viewState=s.SUMMARY)}function p(){var e=t.$watch("selectedRooms",function(e){t.selectedRooms&&(n.set(S,t.selectedRooms),v())},!0);return e}function h(e){e.forEach(function(e){e.children=[],e.minors=[],e.numberOfChildren=0,e.numberOfInfants=0,e.numberOfMinors=0})}function v(){t.errorsSet=[],t.maxRooms=4,t.showRemove=t.selectedRooms.length>1,t.minAdultAge=parseInt(t.maxChildAge)+1,t.adults=T.range(1,parseInt(t.maxAdults)+1),t.children=T.range(0,parseInt(t.maxChildren)+1),t.infants=T.range(0,parseInt(t.maxInfants)+1),t.childAges=T.range(parseInt(t.minChildAge),parseInt(t.maxChildAge)+1);var e=T.calculatePartyCompositionTotals(t.selectedRooms);t.paxTotal=e.paxTotal,t.totalSelectedAdults=e.totalAdults,t.totalSelectedMinors=e.totalMinors,t.errorMessages={pax:"<p>To book online please select a maximum of 9 passengers, to book 10 adults or more please call this number 0344 557 3978</p>",childAges:"<p>Please enter all child ages below</p>",infants:"<p>There must be 1 adult per child under two years of age travelling, please adjust your passenger number</p>"},f(),g()}function g(){var e=T.calculatePartyCompositionTotals(t.selectedRooms),a=[r.COMPLETE_HOLIDAY,r.FLY_DRIVE,r.MULTI_CENTRE];if(a.indexOf(t.context)>-1&&e.totalAdults<e.totalInfants){var n=t.errorMessages.infants;t.infantError=!0,t.errorsSet.indexOf(n)<=-1&&t.errorsSet.push(n)}else t.infantError=!1;if(e.paxTotal>t.maxPax){var i=t.errorMessages.pax;t.paxError=!0,t.errorsSet.indexOf(i)<=-1&&t.errorsSet.push(i)}else t.paxError=!1;D()}function f(){function e(e){return"undefined"==typeof e.age}var a=[];if(t.selectedRooms.forEach(function(e){e.minors.forEach(function(e){a.push(e)})}),a.filter(e).length>0)t.childAgeMissingError=t.errorMessages.childAges,t.childAgeError=!0,t.childAgeValid=!t.childAgeError,t.errorsSet.indexOf(t.childAgeMissingError)<=-1&&t.errorsSet.push(t.childAgeMissingError),k()&&(t.isFormSubmitted=!1);else if(t.childAgeError=!1,t.childAgeValid=!t.childAgeError,t.errorsSet.indexOf(t.childAgeMissingError)>-1){var n=t.errorsSet.indexOf(t.childAgeMissingError);t.errorsSet.splice(n,1)}D()}function y(e){o.sendEvent({name:"add"==e?"Room Added":"Room Removed",rooms:t.selectedRooms.length})}function b(){o.sendEvent({name:"Party Changed",totalPax:t.paxTotal,totalAdults:t.totalSelectedAdults,totalChildren:t.totalSelectedMinors,rooms:t.selectedRooms.length})}function D(){t.partyCompValid=!(t.errorsSet.length>0||!t.childAgeValid),t.formError=t.infantError||t.paxError&&!t.ninePlusEnabled}function k(){return"300"===d.CONTEXT}var S,T=new a;t.viewState=s.FORM,t.ninePlusEnabled=t.ninePlusEnabled||!1,t.init=function(){if(!t.persistKey)throw"a persistence key has not been provided";S=t.persistKey+"SelectedRooms";var a=p(),n=e.$on(l.STATE_CHANGED,function(e){u()});t.$on(c.DESTROY,function(){n(),a()})},t.addRoom=function(){if(t.selectedRooms.length<t.maxRooms){var e=t.selectedRooms.length;t.selectedRooms.push(T.newRoom(e,2,0)),t.showRemove=!0}f(),g(),y("add")},t.removeRoom=function(){t.selectedRooms.length>1&&(t.selectedRooms.pop(),t.selectedRooms.length<=1&&(t.showRemove=!1)),f(),g(),y("remove")},t.passengerChange=function(e){T.updateMinorsInRoom(e);var a=T.calculatePartyCompositionTotals(t.selectedRooms);t.paxTotal=a.paxTotal,t.totalSelectedAdults=a.totalAdults,t.totalSelectedMinors=a.totalMinors,f(),g(),b()},t.validateOnClick=function(){f(),g()},t.toggleAddRoom=function(){return t.selectedRooms.length<t.maxRooms},t.validateChildAges=function(){f()}}])}(),function(){"use strict";angular.module("vhols-party-composition").directive("focusBlur",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,n){n&&n.$viewChangeListeners&&n.$viewChangeListeners.push(function(){t[0].blur()})}}}])}(),function(){"use strict";function e(e){return function(t,a,n){return{scope:{selectedRooms:"=",maxPax:"=",context:"=",maxAdults:"=",maxChildAge:"=",maxChildren:"=",maxInfants:"=",minChildAge:"=",childAgeValid:"=",partyCompValid:"=",isFormSubmitted:"=",persistKey:"@",totalSelectedAdults:"=",totalSelectedMinors:"=",viewState:"=",columnOffset:"@?",roomLinksOffset:"=?",ninePlusEnabled:"=?",partyLabel:"=?"},templateUrl:e,restrict:"EA",replace:!0,controller:"RoomsCtrl",link:function(e){function i(){return n.ROOMS_TOGGLE+":"+e.persistKey}e.init(),e.VIEW_STATE=t,e.showRooms=!0,e.$on("$destroy",e.$watch("viewState",function(a,n){n!==a&&"FLY_DRIVE"!==e.context&&"CRUISE"!==e.context&&(e.showRooms=e.viewState!==t.SUMMARY)})),e.columnOffset=e.columnOffset||8,e.roomLinksOffset=e.roomLinksOffset||4,e.toggleRooms=function(){a.$emit(i())};var o=a.$on(i(),function(){e.showRooms=!e.showRooms});e.$on("$destroy",o)}}}}angular.module("vhols-party-composition").directive("partySummary",["VIEW_STATE","$rootScope","EVENTS",e("room-summary.html")]).directive("roomPartyComposition",["VIEW_STATE","$rootScope","EVENTS",e("rooms.html")])}(),function(){"use strict";angular.module("vhols-party-composition").directive("infantValidation",function(){return{restrict:"A",link:function(e,t,a){var n=t.find("select").controller("ngModel");e.$on("$destroy",e.$watch(a.infantError,function(e){n.$setValidity("infantError",!e)}))}}})}(),function(){"use strict";angular.module("vhols-party-composition").factory("partyCompositionService",function(){function e(e){return r(0,e,function(){return new c})}function t(e,t){return null!=e?e:t}function a(e,t){return[0].concat(t).reduce(function(t,a){return t+=i(a.minors,e)})}function n(e,t){return e.filter(function(e){return t(e)})}function i(e,t){return n(e,t).length}function o(e){var t=e.numberOfMinors;if(e.minors.length===t)e.calculateMinors();else{for(;e.minors.length>t;)e.removeMinor();for(;e.minors.length<t;)e.addMinor()}}function s(){}var l=function(e){return e},r=function(e,t,a){var n,i=[];for(a=a||l,n=e;n<t;n++)i.push(a(n,e,t));return i},c=function(){function e(e){this.id=e}return e}(),d=function(a,o,s){this.roomNumber=a,this.adults=o,this.minors=e(t(s,[])),this.removeMinor=function(){this.minors.pop()&&this.calculateMinors()},this.addMinor=function(){this.minors.push(new c(this.minors.length+1)),this.calculateMinors()},this.addMinors=function(e){this.minors=e,this.calculateMinors()},this.addInfant=function(){var e=new c;e.age=1,this.minors.push(e)},this.calculateMinors=function(){this.numberOfMinors=this.minors.length,this.children=n(this.minors,h),this.numberOfChildren=i(this.minors,h),this.numberOfInfants=i(this.minors,v)},this.calculateMinors()},u=function(e,t,a){return new d(e+1,t,a)},m=function(e,t){if(!e)return p(1);for(var a=[],n=0;n<e.length;n++){var i=e[n],o=t(i),s=new d(n+1,i.adults,o);s.addMinors(o),a.push(s)}return a},p=function(e){return r(0,e,function(e){return new d(e+1,2,0)})},h=function(e){return null==e.age||e.age>=2},v=function(e){return e.age<2},g=function(e){var t=[0].concat(e).reduce(function(e,t){return e+t.adults+t.minors.length}),n=[0].concat(e).reduce(function(e,t){return e+t.adults}),i=a(h,e),o=a(v,e),s=i+o;return{paxTotal:t,totalAdults:n,totalMinors:s,totalChildren:i,totalInfants:o}},f=function(e){var t=function(e){for(var t=e.children.slice(0),a=0;a<e.numberOfInfants;a++){var n=t.length+1,i=new c(n);i.age=1,t.push(i)}return t};return m(e,t)},y=function(e){var t=function(e){return e.minors};return m(e,t)};return s.prototype.range=r,s.prototype.buildRoomsUsingChildrenAndInfants=f,s.prototype.buildRoomsUsingMinors=y,s.prototype.newRoom=u,s.prototype.calculatePartyCompositionTotals=g,s.prototype.updateMinorsInRoom=o,s})}(),function(){"use strict";angular.module("vhols-party-composition").filter("infantAgeFormatter",function(){return function(e){return 1===e?"< 2":e}})}(),function(e){"use strict";function t(t,a,n){function i(){c.currentStep=0,c.submitter=t("/.rest/groupform/v1/enquiry",null,{submit:{method:"POST"}})}function o(){c.currentStep=c.currentStep>0?0:1}function s(){if(c.travelplans.$setSubmitted(!0),c.travelplans.$valid){c.currentStep=2;var t={name:"nineplus-continue",destination:"undefined"!=typeof c.selectedChildLocation&&"undefined"!=typeof c.selectedChildLocation.indexedDescription?c.selectedChildLocation.indexedDescription:void 0,flyingFrom:"undefined"!=typeof c.nineplus.flyingFrom&&"undefined"!=typeof c.nineplus.flyingFrom.description?c.nineplus.flyingFrom.description:void 0,when:e(c.checkInDate).format("DD-MM-YYYY"),howLong:c.nineplus.duration,adults:c.nineplus.adults,children:c.nineplus.children};n.sendEvent(t)}}function l(){if(c.contact.$setSubmitted(!0),c.travelplans.$valid&&c.contact.$valid){var t={title:c.nineplus.title,forename:c.nineplus.firstname,surname:c.nineplus.lastname,email:c.nineplus.email,homePhone:c.nineplus.telephone,destination:c.selectedChildLocation.indexedDescription,flyingFrom:c.nineplus.flyingFrom.description,when:c.checkInDate,howLong:c.nineplus.duration,adults:c.nineplus.adults,children:c.nineplus.children},a={name:"nineplus-email-submit",title:t.title,forename:t.forename,surname:t.surname,email:t.email,homePhone:t.homePhone,destination:t.destination,flyingFrom:t.flyingFrom,when:e(t.when).format("DD-MM-YYYY"),howLong:t.howLong,adults:t.adults,children:t.children};n.sendEvent(a);c.submitter.submit(t,function(){c.currentStep=3},function(e){c.error=e,c.currentStep=3})}}function r(e,t){return Array.apply(null,Array(t-(e-1))).map(function(t,a){return e+a})}var c=this;c.nineplus={},c.details=o,c.doContinue=s,c.doSubmit=l,c.range=r,c.travelplans=void 0,c.currentStep=0,c.submitter=void 0,c.minDepartureDate=e().add(3,"days").toDate(),c.maxDepartureDate=null,c.monthsToShowStart=12,c.nineplus.duration=7,c.useTracking=!1,c.depGwPersistKey="nineplusgateway";var d=new Date;d.setHours(0,0,0,0),i()}angular.module("vhols-nine-plus").controller("NinePlusPanelController",t),t.$inject=["$resource","dates","SearchTracking"]}(window.moment),function(){"use strict";function e(e,t,a,n,i){function o(e,o,s){function l(a){if(a&&!e.ninePlus){var n={name:"nineplus-open",adults:e.vm.totalSelectedAdults,children:e.vm.totalSelectedMinors};i.sendEvent(n)}a?(e.ninePlus=!0,e.vm.currentStep=0,t.find("body")[0].classList.toggle("nineplus-popup-open",!0)):e.ninePlus=!1}var r=e.$watchGroup(["vm.totalSelectedAdults","vm.totalSelectedMinors"],function(t,a){if("undefined"!=typeof a[0]||"undefined"!=typeof a[1]){var n=t.reduce(function(e,t){return e+t},0);l(n>e.vm.maxPax)}}),c=a.$on(n.PARTY_COMP_INVALID,function(){var t=e.vm.totalSelectedAdults+e.vm.totalSelectedMinors;l(t>e.vm.maxPax)});e.$on("$destroy",function(){r(),c()}),e.closeNinePlus=function(e){t.find("body")[0].classList.toggle("nineplus-popup-open",!1)},o.on("click",function(t){t.target.getAttribute("class")&&t.target.getAttribute("class").match("nineplus-lightbox")&&e.closeNinePlus()})}var s={template:e.get("ninePlus.html"),bindToController:!0,controller:"NinePlusPanelController",controllerAs:"vm",link:o,restrict:"AE",scope:{totalSelectedAdults:"=",totalSelectedMinors:"=",maxPax:"=",checkInDate:"=",initialCheckInDate:"=",brand:"@",bookingType:"@",typeaheadPersistKey:"@",selectedChildLocation:"=",depGwPersistKey:"@"}};return s}angular.module("vhols-nine-plus").directive("vholsNinePlusPanel",e),e.$inject=["$templateCache","$document","$rootScope","EVENTS","SearchTracking"]}(),function(){"use strict";angular.module("vhols-time-picker").controller("TimePickerCtrl",["$scope","dates","$log","localStorageService","ApplicationState",function(e,t,a,n,i){function o(){var e=l(),t=r();s(e,t)}function s(a,n){for(var i=t(a).diffMinutes(n),o=i/e.incrementBy,s=[a],l=a,r=1;r<o;r++){var c=t(l).addMinutes(e.incrementBy).asDate();s.push(c),l=c}e.pickUpTimes=s}function l(){var t=c();return u(e.forDate,t.start)}function r(){var a=c();return t(u(e.forDate,a.end))}function c(){var t=d(),a=e.location.details.openingTimes,n=a.filter(function(e){return e.isoDayOfWeek===t});return n[0]}function d(){return t(e.forDate).isoWeekday()}function u(e,a){var n=a.split(":"),i=t(e).asDate();return i.setHours(n[0],n[1],0,0),i}function m(){e.pickUpTimes=null}function p(){var t;i.state===i.POPULATED&&(t=h(e.requiredTime))?(e.selectedTime=t,e.update()):(t=h(g()))?e.selectedTime=t:v()}function h(t){return!!t&&e.pickUpTimes.filter(function(e){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()})[0]}function v(){e.selectedTime=e.pickUpTimes[0]}function g(){if(e.persistKey){var t=n.get(e.persistKey);if(t)return new Date(t)}}e.init=function(){e.$on("$destroy",e.$watchGroup(["location","forDate"],function(){e.inputValuesValid()?(o(),p()):m()}))},e.inputValuesValid=function(){var t=e.location,n=(null!=e.forDate,null!=t&&null!=t.details);if(!n)return!1;var i=null!=t.details.openingTimes&&t.details.openingTimes.length>0;if(!i)return a.error("location has no opening times",t),!1;var o=null!=t.details.carLocationId;return!!o||(a.error("location details does not have location id",t),!1)},e.update=function(){e.persistKey&&e.selectedTime&&n.set(e.persistKey,e.selectedTime.toISOString())},e.selectedTimeTracker=function(e){if(e)return e.getHours()+":"+e.getMinutes()}}])}(),function(){"use strict";angular.module("vhols-time-picker").directive("timePicker",["$templateCache",function(e){return{restrict:"E",scope:{forDate:"=",location:"=",selectedTime:"=",requiredTime:"=",incrementBy:"@",persistKey:"@",id:"@"},template:e.get("timePicker.html"),controller:"TimePickerCtrl",link:function(e,t,a){e.init()}}}])}(),function(){"use strict";angular.module("vhols-search-tracking").factory("SearchTracking",["$window","ABConfig","$log",function(e,t,a){function n(e){var n=new CustomEvent(o.TRACKING_EVENT_NAME,{detail:e});if(o.TRACKING_EVENT_TARGET.dispatchEvent(n),t.get("f8633c")&&(a.info(o.TRACKING_EVENT_NAME,e),"debug"===t.get("f8633c")))for(var i in e)e.hasOwnProperty(i)&&a.debug(i,e[i])}function i(n,i){e.universal_variable=e.universal_variable||{},e.universal_variable[n]=i,t.get("f8633c")&&a.info("Set Universal Variable",{key:n,value:i})}var o={};return o.TRACKING_EVENT_NAME="vhmTrackingEvent",o.TRACKING_EVENT_TARGET=e,o.sendEvent=n,o.setUVTrackingData=i,o}])}(),function(){"use strict";angular.module("vhols-synchronise-checkbox").controller("SynchroniseCheckboxCtl",["$rootScope","$scope","localStorageService","ApplicationState","API_EVENTS","JS_EVENTS",function(e,t,a,n,i,o){function s(){if(!t.persistKey)throw"a persistence key has not been provided";t.$on("$destroy",t.$watch("toggleState",function(e){e&&a.set(t.persistKey,e)},[!0]))}function l(){t.toggleState=a.get(t.persistKey)||{value:!1}}function r(){t.removeSynchronisation=t.$watch("watch",function(){t.update=t.watch})}t.init=function(){s();var a=e.$on(i.STATE_CHANGED,function(){n.state===n.POPULATED?t.toggleState={value:n.criteria.toggleState}:l(),t.toggleWatching(t.toggleState)});t.$on(o.DESTROY,a)},t.toggleWatching=function(e){e.value.toString()===t.when?t.removeSynchronisation||r():t.removeSynchronisation&&(t.removeSynchronisation(),t.removeSynchronisation=null)}}])}(),function(){"use strict";angular.module("vhols-synchronise-checkbox").directive("synchroniseCheckbox",["$templateCache",function(e){return{restrict:"E",scope:{watch:"=",update:"=",when:"@",toggleState:"=",persistKey:"@"},template:e.get("synchroniseCheckbox.html"),controller:"SynchroniseCheckboxCtl",link:function(e){e.init()}}}])}(),function(){"use strict";angular.module("vhols-application-state").factory("ApplicationState",function(){var e={POPULATED:"POPULATED",LOADED:"LOADED",state:"LOADED",criteria:null,isFirstTime:!0};return e.setLoadedState=function(){e.state=e.LOADED,e.setIsFirstEntry()},e.setPopulatedState=function(t){e.state=e.POPULATED,e.criteria=t,e.setIsFirstEntry()},e.setIsFirstEntry=function(){e.isFirstTime=!1},e.isFirstEntry=function(){return e.isFirstTime},e})}(),function(){"use strict";angular.module("vhols-search-panel-api").factory("SearchPanelApiFactory",["BookingTypeFactory","ApplicationState","dates","$rootScope","API_EVENTS","DATES","DepartureGatewayPersistenceService","$log","ABConfig",function(e,t,a,n,i,o,s,l,r){function c(t){var n={checkInDate:t.checkInDate,noNights:a(t.checkInDate).diffDays(a(t.checkOutDate)),selectedBookingType:{id:e.bookingType.id,brand:t.businessContext}};return t.selectedRooms&&(n.selectedRooms=t.selectedRooms),t.selectedChildLocation&&(n.selectedChildLocation={locationUrlDescription:t.selectedChildLocation.locationUrlDescription,parentLocationUrlDescription:t.selectedChildLocation.parentLocationUrlDescription}),t.selectedDepartureGateway&&(n.gatewayCode=t.selectedDepartureGateway.code),t.selectedDepartureGateways&&(n.gatewayCodes=s.toString(t.selectedDepartureGateways)),t.selectedPickUpDepot&&(n.pickUpDepot=t.selectedPickUpDepot.locationUrlDescription,n.dropOffDepot=t.selectedDropOffDepot.locationUrlDescription,n.pickUpTime=a(t.selectedPickupTime).format(o.URL_TIME),n.dropOffTime=a(t.selectedDropOffTime).format(o.URL_TIME)),n}var d={};return n.$on(i.POPULATE,function(e,a){t.setPopulatedState(a),r.get("f10397")&&l.debug(a),n.$emit(i.INIT_BT),n.$emit(i.STATE_CHANGED)}),n.$on(i.LOAD,function(){n.$emit(i.INIT_BT)}),n.$on(i.LOADED,function(){n.$emit(i.STATE_CHANGED)}),n.$on(i.BT_CHANGED,function(){t.setLoadedState()}),n.$on(i.SUBMITTED,function(e,a){t.setLoadedState();var o=c(a);n.$emit(i.DO_SEARCH,o)}),d}]).run(["SearchPanelApiFactory",function(e){}])}(),function(){"use strict";angular.module("vhols-submit-cookie").factory("SubmitCookie",["dates","persist","PERSISTENCE","LOCATION_TYPE_ID","HANDOFF",function(e,t,a,n,i){function o(t,a){return a?e(t).format("DD MMM YYYY"):e(t).format("M-DD-YYYY")}function s(t,a){return e(t).format("M-DD-YYYY")}function l(e){var t=e.split(",");return t.length>1?t[t.length-2].trim():t[0].trim()}function r(e){var t=e.split(",");return t[t.length-1].trim()}function c(e){if("undefined"==typeof e||e.indexOf("|")===-1)return null;var t=e.split("|");return t[t.length-1].trim()}function d(e){if("undefined"==typeof e||e.indexOf("|")===-1)return null;var t=e.split("|");return t.length>1?t[t.length-2].trim():t[0].trim()}function u(e){return e.locationTypeId===n.HOTEL?e.parentEcmsId:e.locationMetadata.ecmsId}function m(e,t,a,n,i,o,s,l){var r=v(o);return"/api/search/redirect/"+e+"/"+t+"/"+a+"/"+n+"/"+i+"/"+r+"/"+s+"/"+l}function p(e,t){return t.map(function(t){return t[e]})}function h(e){return e.map(function(e){return e.children.map(function(e){return e.age}).join("^")||"0"})}function v(e){for(var t=[],a=0;a<e.length;a++){t.push(e[a].adults),t.push(e[a].numberOfChildren),t.push(e[a].numberOfInfants);for(var n=e[a].children,i=0;i<n.length;i++)t.push(n[i].age)}return t.join("/")}var g={};return g.setGenericCookie=function(t,a,i,c,d,v){var g=o(a),f=o(a,!0),y=s(i),b=e(a).diffDays(e(i)),D=c?c.code:"null",k=d?l(d.indexedDescription):"null",S=d?r(d.indexedDescription,!0):"null",T=u(d),C="null";d&&d.locationTypeId===n.HOTEL&&(C=d.locationId);var w=m(v,T,g,y,b,t,D,C);return[{rooms:"flydrive"===v?t.length:t.length.toString(),adults:p("adults",t),children:p("numberOfChildren",t),infants:p("numberOfInfants",t),childAges:h(t),startDate:g,prettyStartDate:f,endDate:y,duration:b.toString(),airportCode:D,searchType:v,resort:k,region:S,ecmsId:T,hotelCode:C,url:w}]},g.setCarOnlyCookie=function(t,a,n,i,s,l,r,u,m){var p=t?d(t.parentLocationHierarchyId):"null",h=t?c(t.parentLocationHierarchyId):"null",v=a?d(a.parentLocationHierarchyId):p,g=t?t.locationDescription:"null",f=a?c(a.parentLocationHierarchyId):h,y=a?a.locationDescription:g,b=o(n,!0),D=t?t.locationId:"null",k=a?a:"null",S=e(s).format("DD-MM-YYYY hh!mm!ss"),T=e(l).format("DD-MM-YYYY hh!mm!ss"),C="/api/search/redirect-car/"+p+"/"+D+"/"+S+"/"+v+"/"+k+"/"+T;return[{pickupcountry:p,pickupcity:h,pickuplocation:g,dropoffcountry:v,dropoffcity:f,dropofflocation:y,dropoffisdifferent:r.value,pickupdate:e(n).formatISO(),dropoffdate:e(i).formatISO(),url:C,prettyStartDate:b,duration:u,searchType:m}]},g.setCruiseCookie=function(t,a,n){var o=e(t,"YYYY-MM-DD").asDate(),s=e(o).format("MM_YYYY"),l=e(o).format("MMM YYYY"),r=i.CRUISE+s;return[{searchType:n,destination:a,cruiseLine:"Any Cruise Line",ship:"Any Cruise Ship",DestinationId:"CruiseLineId",CruiseLineId:"ShipId",Date:s,prettyStartDate:l,url:r}]},g.setTourCookie=function(e,t,a){return[{type:"Family",destination:e.id,month:t,duration:"Any duration",searchType:a}]},g}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("CarOnlySearchPanelCtrl",["$scope","$log","localStorageService","$interpolate","dates","SubmitFactory","SubmitCookie","SearchTracking","$sce","$window","$rootScope","$timeout","$controller","API_EVENTS",function(e,t,a,n,i,o,s,l,r,c,d,u,m,p){function h(){var t,a=[];"string"!=typeof e.selectedPickUpDepot&&a.push(e.selectedPickUpDepot&&"undefined"!=typeof e.selectedPickUpDepot.locationDescription?e.selectedPickUpDepot.locationDescription:"None"),"string"!=typeof e.selectedDropOffDepot&&a.push(e.selectedDropOffDepot&&"undefined"!=typeof e.selectedDropOffDepot.locationDescription?e.selectedDropOffDepot.locationDescription:"None"),2==a.length&&(t=a.join(" - "),l.sendEvent({name:"Destination Change",holidayType:e.searchType,destination:t}))}var v=m("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,v);var g=this;this.apiMapping(),e.searchType="carhire",e.defaultLoc=null,e.monthsToShowStart=20,e.monthsToShowEnd=1,e.maxCheckInDate=null,e.minCheckOutDate=i(e.minCheckInDate).addDays(e.minimumNights).asDate(),e.maxCheckOutDate=i(e.checkInDate).addDays(e.maximumNights).asDate(),e.withECMSId=!1,e.popularDestinations=null,e.$on("$destroy",e.$watchGroup(["selectedPickUpDepot","selectedDropOffDepot"],function(){h(),e.submitted=!1})),e.submit=function(){return e.submitted=!0,e.selectedPickUpDepot&&e.selectedPickupTime&&e.selectedDropOffDepot&&e.selectedDropOffTime?(g.store(s.setCarOnlyCookie(e.selectedPickUpDepot,e.selectedDropOffDepot,e.checkInDate,e.checkOutDate,e.selectedPickupTime,e.selectedDropOffTime,e.toggleState,e.noNights,e.searchType)),v.trackSearchSubmit(),void o.submitCar(e)):(e.carOnlySearchForm.$setSubmitted(!0),e.mainFormError=!0,!1)},u(function(){d.$emit(p.LOADED)})}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("CompleteHolidaySearchPanelCtrl",["$scope","dates","SubmitFactory","$rootScope","$timeout","$controller","API_EVENTS","PERSISTENCE","LOCATION_DEFAULTS","BOOKING_TYPE_CONST","EVENTS","MULTICENTRE_TAB_ID","SHOW_MULTICENTRE_LINK_FOR_BRANDS","$log","SearchTracking",function(e,t,a,n,i,o,s,l,r,c,d,u,m,p,h){function v(e){f.trackSearchSubmit("Multi Destination Link Tab Change"),n.$emit(d.SELECT_BOOKING_TYPE_TAB,u),e.preventDefault(),e.stopPropagation()}function g(){return e.isMultiCentreEnabled&&m.indexOf(Number(e.businessContext))>-1}var f=o("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,f),this.apiMapping(),e.submitStrategy=function(){a.submitHoliday(e)},e.submit=function(t){return e.submitted=!0,e.isFormSubmitted=!0,e.holidaySearchForm.$setSubmitted(!0),e.holidaySearchForm.$invalid&&(e.mainFormError=!0),!(e.isMultipleDepartureEnabled&&!e.selectedDepartureGateway)&&void f.submit(t)},e.holidayContext=c.COMPLETE_HOLIDAY,e.searchType="complete",e.defaultLoc=r.DEFAULT_LOCATION,e.withECMSId=!1,i(function(){n.$emit(s.LOADED)}),e.selectMultiDestination=v,e.showMulticentreLink=g}])}(),function(){"use strict";function e(e,t,a,n,i,o,s,l){function r(){var t=e.brand||i.CONTEXT;return l(a.CRUISE_DATES)({brand:t,cruiseId:e.cruiseId})}var c=t("TourSearchPanelCtrl",{$scope:e});angular.extend(this,c),e.availableMonthsFrom=moment().startOf("month"),e.availableMonthsAmount=24,e.startDatePersistKey=e.startDatePersistKey||"cruiseStartDate",e.startDate=e.startDate||o.getPersistedDate(e.startDatePersistKey),e.holidayContext=n.CRUISE,e.searchType="cruise",e.partyLabel="No. of guests",e.maximumChildren=s?e.maximumChildren:0,e.tbxId=e.cruiseId,e.getPricesEndPoint=r}angular.module("vholsSearchPanel").constant("ALLOW_CRUISE_CHILDREN",!0).controller("CruiseSearchPanelCtrl",e),e.$inject=["$scope","$controller","LOCATIONS","BOOKING_TYPE_CONST","BUSINESS_CONTEXT","HolidayDatesService","ALLOW_CRUISE_CHILDREN","$interpolate"]}(),function(){"use strict";angular.module("vholsSearchPanel").controller("CruisesSearchPanelCtrl",["$scope","$http","dates","SubmitCookie","$rootScope","$controller","HANDOFF","LOCATIONS",function(e,t,a,n,i,o,s,l){var r=o("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,r);var c=this;e.searchType="cruise",t.get(l.CRUISE,{cache:!0}).then(function(t){e.gateways=t.data.values}),e.submit=function(t){e.submitted=!0,c.store(n.setCruiseCookie(e.selectedMonth,e.selectedDepartureGateway,e.searchType)),r.trackSearchSubmit(),t.target.form.submit()}}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("FlyDriveSearchPanelCtrl",["$scope","dates","SubmitFactory","$rootScope","$timeout","$controller","API_EVENTS","PERSISTENCE","LOCATION_DEFAULTS","BOOKING_TYPE_CONST","FLYDRIVE_NAME_TEST","persist",function(e,t,a,n,i,o,s,l,r,c,d,u){var m=o("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,m);var p=u(e),h=p.get(d);e.name_type=2==h?"b":"a",this.apiMapping(),e.submitStrategy=function(){a.submitFlyDrive(e)},e.holidayContext=c.FLY_DRIVE,e.searchType="flydrive",e.defaultLoc=r.DEFAULT_LOCATION,e.withECMSId=!0,e.searchTarget="flights",i(function(){n.$emit(s.LOADED)}),e.submit=function(t){e.flyDriveSearchForm.$setSubmitted(!0),e.flyDriveSearchForm.$invalid&&(e.mainFormError=!0),m.submit(t)}}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("HotelOnlySearchPanelCtrl",["$scope","dates","SubmitFactory","$rootScope","$timeout","$controller","API_EVENTS","PERSISTENCE","LOCATION_DEFAULTS","BOOKING_TYPE_CONST",function(e,t,a,n,i,o,s,l,r,c){var d=o("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,d),this.apiMapping(),e.submitStrategy=function(){a.submitHotel(e)},e.holidayContext=c.HOTEL_ONLY,e.searchType="hotelonly",e.defaultLoc=r.DEFAULT_LOCATION,e.withECMSId=!1,i(function(){n.$emit(s.LOADED)}),e.submit=function(t){e.hotelSearchForm.$setSubmitted(!0),e.hotelSearchForm.$invalid&&(e.mainFormError=!0),d.submit(t)}}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("MultiCentreSearchPanelCtrl",["$scope","dates","SubmitFactory","$rootScope","$timeout","$controller","API_EVENTS","PERSISTENCE","LOCATION_DEFAULTS","LOCATION_TYPE_ID","BOOKING_TYPE_CONST","MULTI_CENTRE_CONFIG","CONSTANTS",function(e,t,a,n,i,o,s,l,r,c,d,u,m){var p=o("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,p),this.apiMapping(),e.submitStrategy=function(){a.submitMultiCentre(e)},e.holidayContext=d.MULTI_CENTRE,e.searchType="multidestination",e.defaultLoc=r.DEFAULT_LOCATION,e.withECMSId=!1,e.locationTypes=new Array(c.REGION,c.COUNTRY,c.STATE,c.CITY),e.monthsToShow=u.MONTHS_TO_SHOW,e.multicentreMinCheckinDate=t(m.NOW).addDays(e.minimumLeadTime).asDate(),e.multicentreMaxCheckinDate=moment().add(e.monthsToShow,"M").endOf(u.UNTIL_END_OF).toDate(),i(function(){n.$emit(s.LOADED)}),e.submit=function(t){e.multiCentreSearchForm.$setSubmitted(!0),e.multiCentreSearchForm.$invalid&&(e.mainFormError=!0),p.submit(t)}}])}(),function(){"use strict";angular.module("vholsSearchPanel").constant("PERSISTENCE",{COOKIE_KEY:"saved-searches"}).constant("MULTICENTRE_TAB_ID",6).constant("SHOW_MULTICENTRE_LINK_FOR_BRANDS",[205]).constant("TOUR_TAB_ID",8).constant("CONSTANTS",function(){var e=new Date;return e.setHours(0,0,0,0),{NOW:e}}()).controller("SearchPanelCtrl",["$scope","ABConfig","SearchTracking","ApplicationState","dates","persist","SubmitCookie","$rootScope","$timeout","API_EVENTS","LOCATION_TYPE_ID","PERSISTENCE","CONSTANTS","BUSINESS_CONTEXT","DATES","EVENTS","AB_CONST","$window",function(e,t,a,n,i,o,s,l,r,c,d,u,m,p,h,v,g,f){function y(){return"undefined"!=typeof e.selectedChildLocation&&"undefined"!=typeof e.selectedChildLocation.locationUrlDescription&&"undefined"!=typeof n.criteria&&"undefined"!=typeof n.criteria.selectedChildLocation&&"undefined"!=typeof n.criteria.selectedChildLocation.locationUrlDescription&&e.selectedChildLocation.locationUrlDescription===n.criteria.selectedChildLocation.locationUrlDescription}function b(){var t=e.selectedChildLocation.locationMetadata.onSaleEnd;return t||(t=i(m.NOW).addMonths(e.defaultOnSaleEnd).asDate()),t}function D(e){var t=m.NOW.getFullYear(),a=e.asDate().getFullYear(),n=m.NOW.getMonth(),i=e.asDate().getMonth();return 12*(a-t)+(i-n)}function k(){if(e.selectedChildLocation&&e.selectedChildLocation.locationMetadata){var t=b();S(t,e)}}function S(t){var a=i(t,"YYYY-MM-DD");i(e.defaultLeadDate).isAfter(a)?a=i(m.NOW).addMonths(e.defaultOnSaleEnd):i(e.checkInDate).isAfter(a)&&(e.initialCheckInDate=e.checkInDate=i(m.NOW).addDays(e.defaultLeadTime).asDate()),e.maxCheckInDate=a.asDate(),e.monthsToShowStart=D(a)}function T(e){for(var t in e)e.hasOwnProperty(t)&&!e[t]&&delete e[t]}function C(e,t){"undefined"!=typeof e&&"undefined"!=typeof t&&(a.setUVTrackingData("searchLocation",e),a.setUVTrackingData("searchLocationId",t))}e.businessContext=p.CONTEXT,e.maximumPeople=9,e.defaultNumAdults=2,e.maximumAdults=9,e.maximumChildAge=17,e.maximumChildren=8,e.maximumInfants=8,e.minimumChildAge=1,e.defaultLeadTime=12,e.minimumLeadTime=3,e.minimumNights=1,e.maximumNights=28,e.defaultOnSaleEnd=11,e.noNights=7,e.childAgeValid=!0,e.defaultLeadDate=i(m.NOW).addDays(e.defaultLeadTime).asDate();var w=i(m.NOW).addDays(e.minimumLeadTime).asDate(),x=i(e.defaultLeadDate).addDays(e.noNights).asDate();e.initialCheckInDate=e.checkInDate=new Date(e.defaultLeadDate.getTime()),e.minCheckInDate=w,e.maxCheckInDate=i(m.NOW).addMonths(e.defaultOnSaleEnd).asDate(),e.checkOutDate=x,e.minCheckOutDate=i(w).addDays(e.minimumNights).asDate(),e.maxCheckOutDate=i(e.defaultLeadDate).addDays(e.maximumNights).asDate(),e.monthsToShowStart=e.defaultOnSaleEnd,e.selectedDepartureGateway=null,e.selectedDepartureGateways=null,e.isNinePlusEnabled=t.get("f91"),e.$on("$destroy",e.$on(g.PREFIX+"f91",function(t,a){e.isNinePlusEnabled=a,e.$apply()})),e.isMultipleDepartureEnabled=t.get("f8609"),e.$on("$destroy",e.$on(g.PREFIX+"f8609",function(t,a){e.isMultipleDepartureEnabled=a,e.$apply()})),e.isRangePickerEnabled=t.get("f8612"),e.$on("$destroy",e.$on(g.PREFIX+"f8612",function(t,a){e.isRangePickerEnabled=a,e.$apply()})),e.isMultiCentreEnabled=!0,e.isDirectFlightsCheckboxEnabled=t.get("f8611"),e.$on("$destroy",e.$on(g.PREFIX+"f8611",function(t,a){e.isDirectFlightsCheckboxEnabled=a,e.$apply()})),l.$on(c.READ_ONLY,function(t,a){t.defaultPrevented===!1&&(t.preventDefault(),t.stopPropagation(),e.hideSearchPanel=a)}),l.$on(c.UPDATE_SEARCH_CRITERIA,function(t,a){angular.extend(e,a)}),r(function(){l.$emit(c.LOAD)}),this.apiMapping=function(t){l.$on(c.STATE_CHANGED,function(){e.updateSearchPanel(e),angular.isFunction(t)&&(t(),r(function(){l.$safeApply()}))})},e.updateSearchPanel=function(e){if(n.state===n.POPULATED){if(y()?e.selectedChildLocation=angular.extend(e.selectedChildLocation,n.criteria.selectedChildLocation):e.selectedChildLocation=n.criteria.selectedChildLocation,n.criteria.selectedDate){var t=i(n.criteria.selectedDate).asDate();e.isDateWidened=!0,e.initialCheckInDate=t,e.checkInDate=t,e.departureDate=i(n.criteria.checkInDate).asDate()}else if(n.criteria.checkInDate){var a=i(n.criteria.checkInDate).asDate();e.isDateWidened=!1,e.initialCheckInDate=a,e.checkInDate=a,e.departureDate=null}e.checkOutDate=i(e.checkInDate).addDays(n.criteria.noNights).asDate(),e.noNights=n.criteria.noNights,n.criteria.selectedPickUpDepot!==n.criteria.selectedDropOffDepot&&(e.selectedDropOffDepot=n.criteria.selectedDropOffDepot),
e.requiredDropOffTime=i(n.criteria.selectedDropOffTime,h.URL_TIME).asDate(),e.selectedPickUpDepot=n.criteria.selectedPickUpDepot,e.requiredPickupTime=i(n.criteria.selectedPickupTime,h.URL_TIME).asDate(),n.criteria.selectedTour&&(T(n.criteria.selectedTour),e.tourId=n.criteria.selectedTour.tourId,e.tourName=n.criteria.selectedTour.tourName,e.urlFriendlyId=n.criteria.selectedTour.tourUrlValue,e.regionUrlValue=n.criteria.selectedTour.regionUrlValue,e.brand=n.criteria.selectedBookingType.brand,e.startDate=i(n.criteria.selectedTour.tourStartDate).asDate()),n.criteria.selectedCruise&&(T(n.criteria.selectedCruise),e.cruiseId=n.criteria.selectedCruise.cruiseId,e.cruiseName=n.criteria.selectedCruise.cruiseName,e.urlFriendlyId=n.criteria.selectedCruise.cruiseUrlValue,e.regionUrlValue=n.criteria.selectedCruise.regionUrlValue,e.brand=n.criteria.selectedBookingType.brand,e.startDate=i(n.criteria.selectedCruise.cruiseStartDate).asDate()),l.$safeApply()}},this.editPanel=function(){l.$emit(c.READ_ONLY,!1)},this.submit=function(t){return e.submitted=!0,e.isFormSubmitted=!0,e.partyCompValid||l.$emit(v.PARTY_COMP_INVALID),!!(e.selectedChildLocation&&e.selectedChildLocation.locationMetadata&&e.partyCompValid)&&(this.store(s.setGenericCookie(e.selectedRooms,e.checkInDate,e.checkOutDate,e.selectedDepartureGateway,e.selectedChildLocation,e.searchType)),this.trackSearchSubmit(),void e.submitStrategy(t))},this.store=function(t){var a=o(e);a.appendToCookie(u.COOKIE_KEY,t,2)},this.trackSearchSubmit=function(t){var n;e.selectedChildLocation?n=e.selectedChildLocation.locationDescription:e.selectedPickUpDepot&&e.selectedDropOffDepot&&(n=e.selectedPickUpDepot.locationDescription+" - "+e.selectedDropOffDepot.locationDescription);var i;e.selectedDepartureGateway&&(e.selectedDepartureGateway.description||e.selectedDepartureGateway.name||e.selectedDepartureGateway.code)&&(e.selectedDepartureGateway.code&&(i=[e.selectedDepartureGateway.code]),n||(n=e.selectedDepartureGateway.description||e.selectedDepartureGateway.name||e.selectedDepartureGateway.code));var o=moment(e.checkInDate).format("DD-MM-YYYY"),s=Number(e.noNights);["cruise","tour"].indexOf(e.searchType)>-1&&(s=void 0,o=moment(e.selectedMonth).format("DD-MM-YYYY")),a.sendEvent({name:t||"Search",holidayType:e.searchType,gateway:i,gateways:e.selectedDepartureGateways?e.selectedDepartureGateways.map(function(e){return e.code}):void 0,destination:n,startDate:o,duration:s,rooms:e.selectedRooms?e.selectedRooms.length:void 0,totalPax:"undefined"!=typeof e.totalSelectedAdults&&"undefined"!=typeof e.totalSelectedMinors?e.totalSelectedAdults+e.totalSelectedMinors:void 0,totalAdults:e.totalSelectedAdults,totalChildren:e.totalSelectedMinors,directFlight:e.isDirectFlightsCheckboxEnabled})};var E=e.$watch("selectedChildLocation",function(){e.submitted=!1,e.selectedChildLocation&&C(e.selectedChildLocation.locationUrlDescription,e.selectedChildLocation.locationId),k()}),I=e.$watch("selectedDepartureGateway",function(){e.selectedDepartureGateway&&["cruise","tour"].indexOf(e.searchType)>-1&&C(e.selectedDepartureGateway.name||e.selectedDepartureGateway.description,e.selectedDepartureGateway.id)}),$=e.$watch("selectedPickUpDepot",function(){e.selectedPickUpDepot&&C(e.selectedPickUpDepot.locationUrlDescription,e.selectedPickUpDepot.locationId)});e.$on("$destroy",function(){E(),I(),$()})}])}(),function(){"use strict";angular.module("vholsSearchPanel").constant("ALLOW_TOURS_CHILDREN",!0).controller("TourSearchPanelCtrl",["$scope","$http","$window","$rootScope","$controller","SubmitCookie","LOCATIONS","HANDOFF","SubmitFactory","BOOKING_TYPE_CONST","BUSINESS_CONTEXT","API_EVENTS","EVENTS","LOCATION_DEFAULTS","HolidayDatesService","ALLOW_TOURS_CHILDREN","$timeout","$interpolate",function(e,t,a,n,i,o,s,l,r,c,d,u,m,p,h,v,g,f){function y(){T.apiMapping(S),e.submit=function(){return e.submitted=!0,e.isFormSubmitted=!0,!!e.partyCompValid&&void r.submitTourCruise(e)},g(function(){n.$emit(u.LOADED),e.getAvailableDates()})}function b(){var t=e.brand||d.CONTEXT;return f(s.TOUR_DATES)({brand:t,tourId:e.tourId})}function D(){e.isDataLoaded=!1,h.getAvailableDays(e.tbxId,e.getPricesEndPoint()).then(function(t){e.availableDates=t,S(),e.isDataLoaded=!0})}function k(t){e.startDate=t,h.setPersistedDate(e.startDatePersistKey,e.startDate)}function S(){var t=h.getAvailableMonths(),a=moment(t[0]).startOf("month"),n=moment(t[t.length-1]).endOf("month");e.availableDates&&h.isOutsideRange(e.startDate,e.availableDates,a,n)&&(e.startDate=null)}var T=this,C=i("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,C),e.startDatePersistKey=e.startDatePersistKey||"tourStartDate",e.startDate=e.startDate||h.getPersistedDate(e.startDatePersistKey),e.holidayContext=c.TOURS,e.partyLabel="Guests",e.searchType="tour",e.maximumChildren=v?e.maximumChildren:0,e.changeSelectedDate=k,e.activate=y,e.getAvailableDates=D,e.tbxId=e.tourId,e.getPricesEndPoint=b,e.scrollTo=function(e){var t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}}])}(),function(){"use strict";angular.module("vholsSearchPanel").controller("ToursSearchPanelCtrl",["$scope","$http","$window","$rootScope","$controller","SubmitCookie","LOCATIONS","HANDOFF","dates","HolidayDatesService","EVENTS",function(e,t,a,n,i,o,s,l,r,c,d){var u=i("SearchPanelCtrl as parentCtrl",{$scope:e});angular.extend(this,u);var m=this;e.searchType="tour",t.get(s.TOURS,{cache:!0}).then(function(t){e.gateways=t.data.values}),e.$on("$destroy",e.$watch("selectedMonth",function(e,t){c.selectedMonth(e),n.$broadcast(d.TOUR_MONTH_CHANGED,e)})),e.submit=function(){var t=new Date(e.selectedMonth),n=r(t).format("YYYY-MM");e.submitted=!0;var i="Any destination"===e.selectedDepartureGateway.id?l.TOURS_ANY:l.TOURS,s=i+e.selectedDepartureGateway.name+"?depDate="+n;m.store(o.setTourCookie(e.selectedDepartureGateway,e.selectedMonth,e.searchType)),u.trackSearchSubmit(),a.location.assign(s)}}])}(),function(){"use strict";angular.module("vholsSearchPanel").directive("bgHack",["$document",function(e){return{link:function(){var t=e[0].body;t.className=t.className+" travelplus"}}}])}(),function(){"use strict";angular.module("vholsSearchPanel").directive("formValidation",function(){return{restrict:"A",link:function(e,t,a){var n=a.formValidation;e.$on("$destroy",e.$watch(function(){return e[n].$valid},function(t){t&&(e.mainFormError=!1)})),e.$on("$destroy",e.$on("setFormValidity",function(t,a,i){e[n].$setValidity(a,i)}))}}})}(),function(){"use strict";angular.module("vholsSearchPanel").directive("shimInclude",["$compile","$templateRequest",function(e,t){return{restrict:"AE",compile:function(a,n){var i;return function(a,n,o){a.$on("$destroy",a.$watch(o.src,function(o){if(null!=o){i&&(i.$destroy(),n.children().remove()),i=a.$new();var s=t(o,!0).then(function(e){return angular.element(e)});s.then(function(t){var a=t.clone();n.append(a),e(a)(i)})}}))}}}}]).directive("searchPanel",["$templateCache",function(e){return{restrict:"E",replace:!0,template:e.get("templates/searchPanel.html")}}])}(),function(e){"use strict";function t(e){var t="";return t=/script/.test(e)&&/<style/.test(e)?e.replace(/<script>[\s\S]*?<\/script>/,"").replace(/<style>[\s\S]*?<\/style>/,""):e}e.filter("to_trusted",["$sce",function(e){return function(a){var n=t(a);return e.trustAsHtml(n)}}])}(angular.module("vholsSearchPanel")),function(){"use strict";angular.module("vhols-date-select-list").controller("VholsDateSelectListCtrl",["$scope","dates","localStorageService","DATES","SearchTracking","ObjectUtils",function(e,t,a,n,i,o){function s(){var t=o.searchScopeParents(e,"searchType");"carhire"!==t&&i.sendEvent({name:"Departure Date Change",holidayType:t,startDate:moment(e.selectedMonth).format("DD-MM-YYYY")})}e.genDates=function(a){var n=e.startFrom-1,i=e.dateRange,o=e.incrementBy,s=[],l=a;l.setHours(0,0,0,0);for(var r=0;r<i;r++){var c=t(l),d=n++*o,u=c.addMonths(d).asDate();s.push(t(u).format("YYYY-MM")+"-01")}return s},e.initPersistence=function(){var i=new Date;if(e.datesArray=e.genDates(i),e.selectedMonth=e.datesArray[0],e.persistKey){e.$on("$destroy",e.$watch("selectedMonth",function(t){a.set(e.persistKey,t),s()}));var o=a.get(e.persistKey);if(o){var l=t(o,n.PERSIST_STRING),r=t(e.datesArray[0],n.PERSIST_STRING),c=l.isAfter(r);c&&(e.selectedMonth=o)}}}}])}(),function(){"use strict";angular.module("vhols-date-select-list").directive("vholsDateSelectList",["$templateCache",function(e){return{restrict:"E",replace:!0,scope:{incrementBy:"=",dateRange:"=",selectedFormat:"=",startFrom:"=",selectedMonth:"=",persistKey:"@"},template:e.get("vholsDateSelectList.html"),controller:"VholsDateSelectListCtrl",link:function(e){e.initPersistence()}}}])}(),function(){"use strict";angular.module("vhols-duration-picker").controller("DurationPickerCtrl",["$rootScope","$scope","dates","$log","localStorageService","ApplicationState","SearchTracking","API_EVENTS","ObjectUtils",function(e,t,a,n,i,o,s,l,r){function c(){t.range.indexOf("-")>-1?t.durationRange=d():t.range.indexOf(",")>-1&&(t.durationRange=t.range.split(","))}function d(){for(var e=[],a=t.range.split("-"),n=a[0],i=a[1],o=0,s=n;s<=i;s++)e[o]=s.toString(),o++;return e}function u(){t.endDate=a(t.startDate).addDays(t.selectedDuration).asDate(),e.$emit(l.UPDATE_SEARCH_CRITERIA,{checkInDate:t.startDate,checkOutDate:t.endDate,noNights:t.selectedDuration})}function m(){s.sendEvent({name:"Duration Change",holidayType:r.searchScopeParents(t,"searchType"),duration:t.selectedDuration})}function p(){var e;e=o.state===o.POPULATED&&o.criteria.noNights?o.criteria.noNights:v(),e&&h(e)?(t.selectedDuration=e.toString(),t.persist(t.selectedDuration)):t.selectedDuration=t.defaultDuration}function h(e){return t.durationRange.filter(function(t){return t===e}).length>0}function v(){if(t.persistKey)return i.get(t.persistKey)}t.init=function(){if(!t.persistKey)throw"a persistence key has not been provided";t.$on("$destroy",t.$watchGroup(["startDate","selectedDuration"],function(){u()})),t.$on("$destroy",t.$watch("selectedDuration",function(){m()})),c();var a=e.$on(l.STATE_CHANGED,function(){p()});t.$on("$destroy",a)},t.persist=function(e){e&&i.set(t.persistKey,e)}}])}(),function(){"use strict";angular.module("vhols-duration-picker").directive("durationPicker",["$templateCache",function(e){return{restrict:"E",scope:{startDate:"=",endDate:"=",defaultDuration:"@",range:"@",persistKey:"@"},template:e.get("durationPicker.html"),controller:"DurationPickerCtrl",link:function(e,t,a){e.init()}}}])}(),function(){"use strict";angular.module("vhols-duration-picker").filter("durationFormatter",function(){return function(e){var t="1"===e?"night":"nights";return e+" "+t}})}(),function(){"use strict";function e(e,t){function a(a){e.set(i.persistKey,a),t.sendEvent({name:i.eventName,holidayType:i.bookingType.shortName,directFlight:a})}function n(t){return e.get(t)}var i=this;i.getPersisted=n,i.persist=a}angular.module("vhols-persistent-checkbox").controller("PersistentCheckboxController",e),e.$inject=["localStorageService","SearchTracking"]}(),function(){"use strict";function e(e){function t(e,t,a,n){n.checkboxValue="true"===n.getPersisted(n.persistKey)}return{restrict:"E",scope:{checkboxId:"@",checkboxText:"@",persistKey:"@",checkboxValue:"=",eventName:"@",bookingType:"="},link:t,controller:"PersistentCheckboxController",controllerAs:"vm",bindToController:!0,template:e.get("persistentCheckbox.html")}}angular.module("vhols-persistent-checkbox").directive("vhmPersistentCheckbox",e),e.$inject=["$templateCache"]}(),function(){"use strict";function e(e){function t(e,t,a,n){function i(e){return o(e)||s(e)}function o(e){return!e||v(e)||g(e)}function s(e){return!e||f(e)}function l(t){return C(t,e.fromDate)||C(t,e.toDate)||C(t,e.initialFromDate)||C(t,e.initialToDate)}function r(e){return!(!e||s(e))&&(c(e)||d(e)||u(e))}function c(t){return!(!e.fromDate||!e.toDate)&&(moment(t).isAfter(e.fromDate)&&moment(t).isBefore(e.toDate))}function d(t){return!!e.fromDate&&(moment(t).isAfter(e.fromDate)&&moment(t).isBefore(n.hoverDay))}function u(t){return!(!e.initialFromDate||!e.initialToDate)&&(moment(t).isAfter(e.initialFromDate)&&moment(t).isBefore(e.initialToDate))}function m(e){o(e)||s(e)||n.selectDay(e)}function p(e){n.hoverDay=e?e:null}function h(){n.hoverDay=null}function v(t){return e.fromDate&&moment(t).isBefore(e.fromDate)}function g(t){return e.minDate&&moment(t).isBefore(e.minDate,"days")}function f(t){return e.maxDate&&moment(t).isAfter(e.maxDate,"days")}function y(e){for(var t=e.year(),a=e.month(),n=new Date(t,a,1),i=[],o=b(n);T(n,a);){do o.push(new Date(n)),n.setDate(n.getDate()+1);while(!S(n)&&T(n,a));o.length<7&&D(o,7-o.length),i.push(o),o=[]}return i}function b(e){var t=[],a=k(e);return a>1&&D(t,a-1),t}function D(e,t){for(var a=0;a<t;a++)e.push("")}function k(e){return 0===e.getDay()?7:e.getDay()}function S(e){return 1===k(e)}function T(e,t){return e.getMonth()===t}function C(e,t){return!(!e||!t)&&e.getTime()===t.getTime()}n.hoverDay=null,e.selectedMonthWeeks=y(moment(e.month)),e.isOutsideRange=i,e.isSelectedDate=l,e.isBetween=r,e.selectDay=m,e.onMouseOver=p,e.onMouseLeave=h,e.$on("$destroy",e.$on("$destroy",e.$watch("month",function(t){e.selectedMonthWeeks=y(moment(t))})))}return{scope:{initialFromDate:"=",initialToDate:"=",fromDate:"=",toDate:"=",minDate:"=",maxDate:"=",month:"="},restrict:"E",link:t,require:"^vhmRangepickerContent",template:e.get("content/date-picker/date-picker.html")}}angular.module("vhols-range-picker").directive("vholsDatePicker",e),e.$inject=["$templateCache"]}(),function(){"use strict";function e(e){return{scope:{list:"=",selected:"=",format:"@"},restrict:"E",require:"^vhmRangepickerContent",link:t,template:e.get("content/date-select/date-select.html")}}function t(e,t,a,n){function i(t){n.selectMonth(t),e.listVisible=!1}function o(t){return t===e.selected}function s(){e.listVisible=!e.listVisible}function l(a){t[0].contains(a.target)||(e.listVisible=!1,e.$apply())}e.listVisible=!1,e.format=e.format||"MMMM yyyy",e.select=i,e.isSelected=o,e.show=s,angular.element(document).on("click",l)}angular.module("vhols-range-picker").directive("vholsDateSelect",e),e.$inject=["$templateCache"]}(),function(){"use strict";function e(e,t,a){function n(t){e.close(t)}function i(e){s.errorMessage="",a(function(){s.errorMessage=e},0)}function o(){e.dismiss("cancel")}var s=this;s.initialFromDate=t.fromDate,s.initialToDate=t.toDate,s.fromDate=t.returnOnly?t.fromDate:null,s.toDate=null,s.minDate=t.minDate,s.maxDate=t.maxDate,s.minRange=t.minRange,s.maxRange=t.maxRange,s.isReselect=!!s.initialFromDate,s.monthsToShow=t.monthsToShow,s.bookingType=t.bookingType,s.errorMessage=null,s.ok=n,s.error=i,s.cancel=o}angular.module("vhols-range-picker").controller("RangePickerModalController",e),e.$inject=["$modalInstance","rangePickerConfig","$timeout"]}(),function(){"use strict";function e(e,t,a,n,i,o,s){function l(e,o,l){function c(o,s){t.set(e.checkInPersistKey,a(o).format()),t.set(e.checkOutPersistKey,a(s).format()),e.duration=moment(s).diff(moment(o),"days"),t.set(e.durationPersistKey,e.duration),n.$emit(i.UPDATE_SEARCH_CRITERIA,{checkInDate:o,checkOutDate:s,noNights:e.duration})}e.duration=e.duration||s,e.updateRange=c;var d=n.$on(i.STATE_CHANGED,function(){r(e)});e.$on("$destroy",e.$watchGroup(["minDate","maxDate"],function(){r(e)})),e.$on("$destroy",d)}function r(e){var a,n,i;o.state===o.POPULATED&&o.criteria.noNights?(o.criteria.selectedDate?(a=u(o.criteria.selectedDate),n=moment(a).add(o.criteria.noNights,"days").toDate()):(a=u(o.criteria.checkInDate),n=u(o.criteria.checkOutDate)),i=o.criteria.noNights):(a=c(e.checkInPersistKey,e.minDate,e.maxDate),n=c(e.checkOutPersistKey,e.minDate,e.maxDate),i=t.get(e.durationPersistKey)),e.duration=i?i:e.duration,e.checkInDate=a?a:e.initialCheckInDate,e.checkOutDate=n?n:d(e.initialCheckInDate,e.duration),e.updateRange(e.checkInDate,e.checkOutDate)}function c(e,n,i){var o=t.get(e)?a(t.get(e)).asDate():null;return o&&(a(o).isBefore(n,"day")||a(o).isAfter(i,"day"))&&(o=null),o}function d(e,t){return moment(e).add(t,"days").toDate()}function u(e){var t=null;return e instanceof Date?t=e:"string"==typeof e&&(t=a(e).asDate()),t}return{restrict:"E",scope:{checkInDate:"=",checkOutDate:"=",initialCheckInDate:"=",minDate:"=",maxDate:"=",minNights:"=",maxNights:"=",duration:"=",monthsToShow:"=",checkInPersistKey:"@",checkOutPersistKey:"@",durationPersistKey:"@",fromDateLabel:"@",toDateLabel:"@",bookingType:"="},link:l,template:e.get("rangepicker-wrapper.html")}}angular.module("vhols-range-picker").directive("vhmRangepickerWrapper",e).constant("DEFAULT_DURATION",7),e.$inject=["$templateCache","localStorageService","dates","$rootScope","API_EVENTS","ApplicationState","DEFAULT_DURATION"]}(),function(){"use strict";function e(e,t){function a(a,n,i){n.bind("click",function(){var n=e.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",template:t.get("rangepicker-modal.html"),controller:"RangePickerModalController",controllerAs:"modal",resolve:{rangePickerConfig:function(){return{fromDate:a.fromDate,toDate:a.toDate,minDate:a.minDate,maxDate:a.maxDate,minRange:a.minRange,maxRange:a.maxRange,returnOnly:a.returnOnly,monthsToShow:a.monthsToShow,bookingType:a.bookingType}}}});n.result.then(function(e){a.fromDate=e.fromDate,a.toDate=e.toDate,a.onChange&&a.onChange(e.fromDate,e.toDate)})})}return{restrict:"A",scope:{minDate:"=",maxDate:"=",minRange:"=",maxRange:"=",fromDate:"=",toDate:"=",returnOnly:"@",monthsToShow:"=",onChange:"=",bookingType:"="},link:a}}angular.module("vhols-range-picker").directive("vhmRangepicker",e),e.$inject=["$modal","$templateCache"]}(),function(){"use strict";function e(e){function a(e,t,a,o){function s(e,t){t=t||moment(),e=+e||12;for(var a,n=[],i=0;i<=e;i++)a=moment().startOf("month").add(i,"months"),a.isBefore(moment(t),"months")||n.push(a.toDate());return n}function l(e,t){var a=0;if(!e)return a;for(var n,i=moment(e),o=0;o<t.length;o++)if(n=moment(t[o]),i.year()===n.year()&&i.month()===n.month()){a=o;break}return a}o.availableMonths=s(o.monthsToShow,o.minDate);var r=o.fromDate?o.initialToDate:o.initialFromDate,c=l(r,o.availableMonths);o.selectedMonth=o.availableMonths[c],o.nextMonth=moment(o.selectedMonth).add(1,"months").toDate(),o.duration=i(o,"days"),e.$on("$destroy",e.$watch("vm.hoverDay",function(){o.hoverDuration=o.fromDate?n(o.fromDate,o.hoverDay,"days"):i(o,"days")}))}function n(e,t,a){var n=moment(t).isAfter(e)||moment(t).isSame(e);return n?moment(t).diff(moment(e),a):void 0}function i(e,t){var a=e.toDate||e.initialToDate,n=e.fromDate||e.initialFromDate,i=moment(a).isAfter(n)||moment(a).isSame(n);return n&&a&&i?moment(a).diff(moment(e.fromDate||e.initialFromDate),t):void 0}return{restrict:"E",link:a,scope:{initialFromDate:"=",initialToDate:"=",fromDate:"=",toDate:"=",minDate:"=",maxDate:"=",minRange:"=",maxRange:"=",monthsToShow:"=",onComplete:"=",onError:"=",bookingType:"="},controller:t,controllerAs:"vm",bindToController:!0,template:e.get("content/rangepicker-content.html")}}function t(e){function t(e){v.fromDate?l(e)?o():r(e)?s():n(e):a(e)}function a(t){v.fromDate=t,v.initialFromDate=null,v.initialToDate=null,e.sendEvent({name:"Departure Date Change",holidayType:v.bookingType.shortName,startDate:moment(v.fromDate).format("DD-MM-YYYY"),duration:i()})}function n(t){v.toDate=t,v.onComplete({fromDate:v.fromDate||v.initialFromDate,toDate:v.toDate||v.initialToDate}),e.sendEvent({name:"Duration Change",holidayType:v.bookingType.shortName,startDate:moment(v.fromDate).format("DD-MM-YYYY"),duration:i()})}function i(){var e=v.toDate||v.initialToDate,t=v.fromDate||v.initialFromDate;return t&&e?moment(e).diff(moment(v.fromDate||v.initialFromDate),"days"):void 0}function o(){v.onError("Minimum holiday duration is "+h(v.minRange))}function s(){v.onError("Maximum holiday duration is "+h(v.maxRange)),v.maxDate=moment(v.fromDate).add(v.maxRange,"days").toDate()}function l(e){return moment(e).isBefore(moment(v.fromDate).add(v.minRange,"days"),"days")}function r(e){return moment(e).isAfter(moment(v.fromDate).add(v.maxRange,"days"),"days")}function c(e){v.selectedMonth=e,v.nextMonth=moment(e).add(1,"months").toDate()}function d(){var e=p(v.selectedMonth);c(v.availableMonths[e+1])}function u(){return m(v.selectedMonth)}function m(e){var t=p(e);return v.availableMonths.length===t+1}function p(e){return v.availableMonths.indexOf(e)}function h(e){var t=e+" night";return t+=e>1?"s":""}var v=this;v.reselect=!0,v.selectDay=t,v.selectMonth=c,v.selectNextMonth=d,v.isLastMonthSelected=u}angular.module("vhols-range-picker").directive("vhmRangepickerContent",e),e.$inject=["$templateCache"],t.$inject=["SearchTracking"]}(),function(){"use strict";function e(e,t){var a=t("TourSearchPanelCtrl",{$scope:e});angular.extend(this,a),e.activate()}function t(e,t){var a=t("CruiseSearchPanelCtrl",{$scope:e});angular.extend(this,a),e.activate()}angular.module("vhols-holiday-picker").controller("TourPickerCtrl",e).controller("CruisePickerCtrl",t),e.$inject=["$scope","$controller"],t.$inject=["$scope","$controller"]}(),function(){"use strict";angular.module("vhols-holiday-picker").directive("toursPicker",["$templateCache",function(e){return{scope:{tourId:"@",urlFriendlyId:"@",regionUrlValue:"@",startDatePersistKey:"@"},template:e.get("tourspicker.html"),controller:"TourPickerCtrl"}}]).directive("cruisePicker",["$templateCache",function(e){return{scope:{cruiseId:"@",urlFriendlyId:"@",regionUrlValue:"@",startDatePersistKey:"@"},template:e.get("cruisepicker.html"),controller:"CruisePickerCtrl"}}])}(),function(){"use strict";function e(e){function a(e,t,a,n){}return{restrict:"E",scope:{date:"=",availableDates:"=",onDateSelected:"=",availableMonthsFrom:"=",availableMonthsAmount:"="},controller:t,link:a,controllerAs:"vm",bindToController:!0,template:e.get("datepicker/holiday-datepicker.html")}}function t(e,t,a){function n(){var n=S.availableMonthsFrom,o=S.availableMonthsAmount;S.availableMonths=e.getAvailableMonths(n,o),S.minDate=moment(S.availableMonths[0]).startOf("month"),S.maxDate=moment(S.availableMonths[S.availableMonths.length-1]).endOf("month"),i(),b(e.selectedMonth()),t.$on("$destroy",t.$watch("vm.date",function(e,t){e!=t&&b(e)})),t.$on("$destroy",t.$on(a.TOUR_MONTH_CHANGED,function(e,t){b(t)}))}function i(){S.selectedDay=null,b(S.selectedDay)}function o(t,a){e.selectedMonth(t),S.selectedMonthWeeks=g(moment(t)),a|=v(t).index,S.selectedMonthIndex=a}function s(){return S.selectedMonthIndex>0}function l(){return S.selectedMonthIndex<S.availableMonths.length-1}function r(){S.selectedMonth=S.availableMonths[S.selectedMonthIndex-1],S.selectedMonthIndex--,o(S.selectedMonth,S.selectedMonthIndex)}function c(){S.selectedMonth=S.availableMonths[S.selectedMonthIndex+1],S.selectedMonthIndex++,o(S.selectedMonth,S.selectedMonthIndex)}function d(t){return e.isOutsideRange(t,S.availableDates,S.minDate,S.maxDate)}function u(e,t){return moment(e).isSame(t,"month")}function m(e,t){return moment(e).isSame(t,"month")||moment(e).isAfter(t,"month")}function p(e){return y(e,S.selectedDay)}function h(e){if(S.selectedDay=e,S.onDateSelected&&S.onDateSelected(S.selectedDay),S.selectedDay&&!u(S.selectedDay,S.selectedMonth)){var t=v(S.selectedDay);S.selectedMonth=t.month,o(t.month,t.index)}}function v(e){for(var t={month:S.availableMonths[0],index:0},a=0;a<S.availableMonths.length;a++)if(u(S.availableMonths[a],e)){t.month=S.availableMonths[a],t.index=a;break}return t}function g(e){for(var t=e.year(),a=e.month(),n=moment(new Date(t,a,1)).startOf("isoWeek"),i=[],o=[];i.length<6;){do o.push(n.toDate()),n=moment(n).add(1,"days");while(!f(n));i.push(o),o=[]}return i}function f(e){return 1===e.isoWeekday()}function y(e,t){return!(!e||!t)&&e.getTime()===t.getTime()}function b(e){e=D(e),k(e)}function D(e){for(var t,a=0;a<S.availableDates.length;a++)if(m(S.availableDates[a],S.availableMonths[0])){t=S.availableDates[a];break}return t&&!e?t:e||S.availableMonths[0]}function k(e){var t=v(e);S.selectedMonth=t.month,o(t.month,t.index)}var S=this;S.changeSelectedMonth=o,S.hasPrevMonth=s,S.hasNextMonth=l,S.selectPrevMonth=r,S.selectNextMonth=c,S.isOutsideRange=d,S.isSameMonth=u,S.isSelectedDate=p,S.changeSelectedDay=h,n()}angular.module("vhols-holiday-picker").directive("vhmHolidayDatePicker",e).controller("HolidayDatePickerController",t),e.$inject=["$templateCache"],t.$inject=["HolidayDatesService","$scope","EVENTS"]}(),function(){"use strict";function e(e,t){function a(t){t&&e.close(t)}function n(){e.dismiss("cancel")}var i=this;i.date=t.date,i.availableDates=t.availableDates,i.onDateSelected=t.onDateSelected,i.ok=a,i.cancel=n}angular.module("vhols-holiday-picker").controller("HolidayDatePickerModalController",e),e.$inject=["$modalInstance","datepickerConfig"]}(),function(){"use strict";function e(e,t){function a(a,n,i){n.bind("click",function(){var n=e.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",windowClass:"holiday-modal",template:t.get("datepicker-popup/holiday-datepicker-modal.html"),controller:"HolidayDatePickerModalController",controllerAs:"vm",resolve:{datepickerConfig:function(){return{date:a.date,availableDates:a.availableDates,onDateSelected:a.onDateSelected}}}});n.result.then(function(e){a.onDateSelected&&a.onDateSelected(e)})})}return{restrict:"E",scope:{label:"@",date:"=",availableDates:"=",onDateSelected:"="},template:t.get("datepicker-popup/holiday-datepicker-popup.html"),link:a}}angular.module("vhols-holiday-picker").directive("vhmHolidayDatePickerPopup",e),e.$inject=["$modal","$templateCache"]}(),function(){"use strict";function e(e,t,a,n){function i(a,n){var i=t.defer();return p[a]?i.resolve(p[a]):e.get(n,{cache:!0}).then(function(e){p[a]=e.data.dates.map(function(e){return moment(e.departureStartDate,"YYYY-MM-DD").toDate()}),i.resolve(p[a])})["catch"](function(e){i.resolve([])}),i.promise}function o(e,t,a,n){return!l(e,t)||moment(e).isBefore(a)||moment(e).isAfter(n)}function s(e,t){e=e||r(),t=t||14;for(var a=[],n=0;n<t;n++){var i=moment(e);a.push(i.add(n,"month").toDate())}return a}function l(e,t){var a=!1;if(t&&t.length>0)for(var n=0;n<t.length;n++)if(moment(t[n]).isSame(e,"day")){a=!0;break}return a}function r(){return moment().add(1,"month").startOf("month")}function c(e){return m=null!=e?e:m}function d(e){return a.get(e)?n(a.get(e)).asDate():null}function u(e,t){t?a.set(e,n(t).format()):a.remove(e)}var m,p={};return{getAvailableDays:i,isOutsideRange:o,getAvailableMonths:s,selectedMonth:c,getPersistedDate:d,setPersistedDate:u}}angular.module("vhols-holiday-picker").factory("HolidayDatesService",e),e.$inject=["$http","$q","localStorageService","dates"]}(),function(){"use strict";function e(){function e(e,t,a,n){n.$formatters.shift(),n.$formatters.push(function(t){var a=e.format?e.format:"DD.MM.YYYY";if(t)return moment(t).format(a)})}return{restrict:"A",scope:{format:"@vhmDateField"},require:"ngModel",link:e}}angular.module("vhols-date-utils").directive("vhmDateField",e),e.$inject=[]}(),function(){"use strict";angular.module("vhols-resize").directive("vholsMoveTo",["$window",function(e){return{restrict:"A",scope:{vholsMoveTo:"@",moveBreakpointPx:"@",moveElement:"@"},link:function(t,a,n){function i(){if(!t.isMoved){var e=document.getElementById(t.vholsMoveTo),a=document.getElementById(t.moveElement);e.appendChild(a),t.isMoved=!0}}function o(){if(t.isMoved){var e=document.getElementById(t.moveElement);a[0].appendChild(e),t.isMoved=!1}}function s(){return e.innerWidth<=t.moveBreakpointPx}t.isMoved=!1,s()&&i(n.vholsMoveTo,n.moveElement),angular.element(e).bind("resize",function(){s()?i():o()}),t.$on("$destroy",function(){a.remove()})}}}])}(),function(){"use strict";function e(e,t){function a(e,t){var a=o(e),n=c(a);return r(t,n)}function n(t,a){var n=i(a);e.set(t,n)}function i(e){e=e||[];var t=e.map(function(e){return{code:e.code,name:e.description}});return angular.toJson(t)}function o(e){var a;return l()&&(a=t.criteria.gatewayCodes),a||(a=s(a,e)),a}function s(t,a){if(t=e.get(a),"string"==typeof t)try{t=angular.fromJson(t)}catch(n){t=null}return t}function l(){return t.state===t.POPULATED}function r(e,t){var a=e.filter(function(e){return t.indexOf(e.code)>=0});return a.length>0?a:null}function c(e){return e=e||[],e.map(function(e){return e.code})}var d=this;d.getPersistedGateways=a,d.persist=n,d.toString=i}angular.module("vhols-multiple-departure-picker").service("DepartureGatewayPersistenceService",e),e.$inject=["localStorageService","ApplicationState"]}(),function(){"use strict";function e(e,t,a,n){function i(e){return h.selectedGateways.indexOf(e)>=0}function o(e){s(e.gateways)}function s(t){if(h.selectedGateways.length=0,t&&t.length>0){var a=e.getPersistedGateways(h.persistKey,t);h.selectedGateways=a?a:p(t),h.firstSelectedGateway=h.selectedGateways[0],c(h.selectedGateways)}}function l(){return!h.gateways||0===h.gateways.length}function r(t){var n=h.selectedGateways.indexOf(t);n>=0?h.selectedGateways.splice(n,1):(h.selectedGateways.push(t),m(h.selectedGateways)),h.firstSelectedGateway=h.selectedGateways[0],c(h.selectedGateways),e.persist(h.persistKey,h.selectedGateways),a.sendEvent({name:"Departure Point Change",holidayType:h.bookingType.shortName,gateway:h.selectedGateways.map(function(e){return e.code})})}function c(e){t.$emit(n.UPDATE_SEARCH_CRITERIA,{selectedDepartureGateways:e,selectedDepartureGateway:e.length>0?e[0]:null})}function d(){l()||(h.listVisible=!h.listVisible)}function u(){h.listVisible=!1}function m(e){e.sort(function(e,t){return e.index-t.index})}function p(e){for(var t=[],a=0;a<e.length;a++)e[a].preferred&&t.push(e[a]);return t}var h=this;h.selectedGateways=h.selectedGateways||[],h.displayProperty=h.displayProperty||"description",h.persistKey=h.persistKey||"chSelectedDepGw",h.listVisible=!1,h.toggleGatewaySelection=r,h.isGatewaySelected=i,h.resetSelectedGateways=s,h.toggleListVisibility=d,h.initialisePersistence=o,h.closeList=u,h.isDisabled=l}angular.module("vhols-multiple-departure-picker").controller("MultipleDeparturePickerController",e),e.$inject=["DepartureGatewayPersistenceService","$rootScope","SearchTracking","API_EVENTS"]}(),function(){"use strict";function e(e,t,a){function n(e,n,i,o){function s(){var e=n[0].getElementsByClassName("gateway-selected-value")[0],t=e.offsetWidth;return l(e)&&(t-=c),t}function l(e){return 1===e.getElementsByClassName("more-selected").length}function r(t){n[0].contains(t.target)||(o.closeList(),e.$apply())}var c=70;e.$on("$destroy",e.$watch("vm.gateways",o.resetSelectedGateways)),o.getMaxAirportNameWidth=s,angular.element(document).on("click",r);var d=t.$on(a.STATE_CHANGED,function(){o.initialisePersistence(e)});e.$on("$destroy",d),e.$on("$destroy",e.$watchGroup(["vm.selectedGateways.length",o.isDisabled],function(t){var a=t[0],n=t[1];e.$emit("setFormValidity","gatewayError",!!a||n)}))}return{restrict:"E",scope:{gateways:"=",selectedGateways:"=",firstSelectedGateway:"=",displayProperty:"@",persistKey:"@",bookingType:"=",isFormSubmitted:"="},link:n,controller:"MultipleDeparturePickerController",controllerAs:"vm",bindToController:!0,template:e.get("multipleDepartureGateway.html")}}angular.module("vhols-multiple-departure-picker").directive("vhmMultipleDeparturePicker",e),e.$inject=["$templateCache","$rootScope","API_EVENTS"]}(),function(){"use strict";function e(){function e(e,a){return t(e,"$parent",a)}function t(e,a,n){if(null!=e[a])return null!=e[a]?e[a][n]:t(e[a],a,n)}var a={recursiveKeySearch:t,searchScopeParents:e};return a}angular.module("vhols-utils").factory("ObjectUtils",e),e.$inject=[]}(),function(){"use strict";angular.module("vhols-utils").run(["$rootScope",function(e){e.$safeApply=function(t){var a=e.$$phase;"$apply"===a||"$digest"===a?t&&"function"==typeof t&&t():e.$apply(t)}}])}(),function(){"use strict";function e(){function e(e,t,a,n){function i(e){var t=/((\(?0\d{4}\)?\s?\d{3}\s?\d{3})|(\(?0\d{3}\)?\s?\d{3}\s?\d{4})|(\(?0\d{2}\)?\s?\d{4}\s?\d{4}))(\s?\#(\d{4}|\d{3}))?/;return n.$setValidity("validTelephone",t.test(e)),e}n.$parsers.unshift(i)}var t={link:e,require:"ngModel",restrict:"A"};return t}angular.module("vhols-validation").directive("validTelephone",e),
e.$inject=[]}(),function(){"use strict";angular.module("vhols-dates",[]),angular.module("vhols-dates").factory("dates",function(){var e=function(){function t(t){return t instanceof e?t.date:t}function a(e,t){e="undefined"==typeof e?new Date:e,this.date=e instanceof Date?moment(e):moment(e,t||a.defaultFormat)}return a.defaultFormat="DD/MM/YYYY",a.years="years",a.months="months",a.weeks="weeks",a.days="days",a.day="day",a.minutes="minutes",a.prototype.asDate=function(){return this.date.toDate()},a.prototype.formatISO=function(){return this.date.toISOString()},a.prototype.format=function(e){return this.date.format(e||a.defaultFormat)},a.prototype.addYears=function(e){return this.date.add(e,a.years),this},a.prototype.addMonths=function(e){return this.date.add(e,a.months),this},a.prototype.addWeeks=function(e){return this.date.add(e,a.weeks),this},a.prototype.addDays=function(e){return this.date.add(e,a.days),this},a.prototype.addMinutes=function(e){return this.date.add(e,a.minutes),this},a.prototype.isValid=function(){return this.date.isValid()},a.prototype.diffYears=function(e){return e.date.diff(this.date,a.years)},a.prototype.diffMonths=function(e){return e.date.diff(this.date,a.months)},a.prototype.diffWeeks=function(e){return e.date.diff(this.date,a.weeks)},a.prototype.diffDays=function(e){return e.date.diff(this.date,a.days)},a.prototype.diffMinutes=function(e){return e.date.diff(this.date,a.minutes)},a.prototype.isBefore=function(e,n){return this.date.isBefore(t(e),n||a.day)},a.prototype.isAfter=function(e,n){return this.date.isAfter(t(e),n||a.day)},a.prototype.isoWeekday=function(){return this.date.isoWeekday()},a.prototype.isSame=function(e,n){return this.date.isSame(t(e),n||a.day)},a.prototype.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},a.prototype.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},a}();return function(t,a){return new e(t,a)}})}(),function(){"use strict";var e=angular.module("vhols-persistence",["ipCookie","vhols-dates"]);e.factory("persist",["ipCookie","dates",function(e,t){function a(e,t){this.$scope=e,this.props=null!=t?t:{path:"/"}}return a.prototype.store=function(t,a){function n(e){var t={};return a.filter(function(t){return i.call(e,t)}).reduce(function(t,a){return t[a]=e[a],t},t)}var i=Object.prototype.hasOwnProperty,o=this;return a=null!=a?a:[],function(i){null==i&&""!==i||e(t,a.length?n(i):i,o.props)}},a.prototype.storeDate=function(e){var a=this.store(e);return function(e){a(t(e).format())}},a.prototype.get=function(t){return e(t)},a.prototype.remove=function(t){return e.remove(t)},a.prototype.put=function(t,a,n){return n?e(t,a,{path:"/",expires:n}):e(t,a,{path:"/"})},a.prototype.watch=function(e,t){this.$scope.$watch(e,this.store(e,t),!0)},a.prototype.watchDate=function(e){this.$scope.$watch(e,this.storeDate(e))},a.prototype.appendToCookie=function(t,a,n){var i=a,o=e(t),s=365;if("saved-searches"===t&&e("VHOLS_NEW_REQUEST","0",{path:"/",expires:s}),o){if(o.length>=n){var l=o.length-(n-1);o.splice(0,l)}i=o.concat(i)}return this.put(t,i,s)},function(e,t){return new a(e,t)}}])}(),function(e,t,a,n,i,o,s,l,r,c,d){window.addEventListener("initialise-tabbed-bar",function(u){var m=u.detail&&u.detail.tabbedBar||document.getElementsByClassName(e);(void 0!==m&&null!==m||0!==m.length)&&s(m,function(e){var s=l(e,a),u=e.getElementsByClassName(t),m=l(e,n),p=c(u)+m.offsetWidth,h=p/u.length*-1,v=(p-window.innerWidth)*-1,g=0,f=0,y=!1;r(m,"click",function(){s.classList.add(i);var e=d(s,g,v,h,y);g=e.shift,y=e.finalShift,y?m.classList.add("left"):m.classList.remove("left")}),r(e,"touchstart",function(e){s.classList.remove(i),f=o(e.changedTouches).clientX}),r(e,"touchmove",function(e){var t=o(e.changedTouches).clientX,a=t-f;g=d(s,g,v,a,y).shift,f=t})})})}("tabbed-bar","bar-tab","bar-tabs-container","scroller","scroll-transition",function(e){return e[0]},function(e,t){return Array.prototype.forEach.call(e,t)},function(e,t){if(void 0!==e&&null!==e){var a=e.getElementsByClassName(t);return"undefined"!=typeof a&&null!==a&&a.length>0?a[0]:null}},function(e,t,a){return e.addEventListener(t,a)},function(e,t){return[].reduce.call(e,function(e,t){return e+t.getBoundingClientRect().width},0)},function(e,t,a,n,i){var o=t+n;return o<a?i?(o=0,i=!1):(o=a,i=!0):o>0&&(o=0),e.style.transform="translateX("+o+"px)",{shift:o,finalShift:i}}),function(){"use strict";angular.module("vholsSearchPanel").constant("BOOKING_TYPES",[{id:1,name:"Holiday",uri:"templates/holiday.html","default":!0,shortName:"holiday"},{id:6,name:"Multi-Destination",uri:"templates/multi-centre.html","default":!1,shortName:"multidestination"},{id:2,name:"Flydrive",uri:"templates/flydrive.html","default":!1,shortName:"flydrive"},{id:3,name:"Cruise",uri:"templates/cruises.html","default":!1,shortName:"cruise"},{id:7,name:"Tours",uri:"templates/tours.html","default":!1,shortName:"tours"},{id:4,name:"Hotel Only",uri:"templates/hotels.html","default":!1,shortName:"hotel"},{id:5,name:"Car hire",uri:"templates/cars.html","default":!1,shortName:"car"},{id:8,name:"Tour",uri:"templates/tour.html","default":!1,shortName:"tour",hideOtherTabs:!0},{id:9,name:"CruiseOptions",uri:"templates/cruise-options.html","default":!1,shortName:"cruise_options",hideOtherTabs:!0}]).constant("BUSINESS_CONTEXT",{CONTEXT:"205"}).constant("LOCATION_DEFAULTS",{DEFAULT_LOCATION:"orlando"}).constant("FLYDRIVE_NAME_TEST","vholsSPFlydriveNameTest").constant("PERSIST_KEY",{BOOKING_TYPE_KEY:"vh.selectedBookingType"}).run(["ABConfig",function(e){e.set("f91",!0)}])}(),angular.module("vhols-search-panel-tpls",[]).run(["$templateCache",function(e){e.put("bookingtype.html",'<div data-booking-types="{{bookingTypes.length}}" class="tabbed-bar" tabbed-bar><div class="bar-tabs-container"><a ng-repeat="bt in bookingTypes track by bt.id" ng-if="!bt.hideOtherTabs" class="bar-tab" ng-class="{\'multi-centre-tab\': bt.id === 6 && (bt.shortName === \'multi-destination\' || \'multidestination\' || \'multicentre\'), \'active\' : bt.id === selectedBookingType.id}" ng-click="setSelectedBookingType(bt)"><span class="qa_{{bt.shortName}}_button">{{ bt.id === 2 && name_type === \'b\' ? \'Flight + Car\' : bt.name }}</span></a></div><div class="scroller"><i class="shim-icon" aria-label="Click to scroll right" shim-include="" src="\'/static-resources/assets/old-icons/chevron-right.svg\'"></i></div></div>'),e.put("checkboxList.html",'<label ng-repeat="item in items"><input type="checkbox" ng-model="item.selected" ng-disabled="item.disabled" ng-click="performToggle(item)" class="qa_childLoc">{{item[itemId]}}</label>'),e.put("dateinput.html",'<div><div class="date-picker-wrapper labelled-text-input"><label class="hsp-label" ng-class="{\'label-sr\' : srLabel}" for="{{dateInputId}}">{{label}}</label><input id="{{dateInputId}}" type="text" placeholder="Select a date" class="form-control" ng-model="date" is-open="opened" min-date="minDate" max-date="maxDate" months-to-show="$parent.monthsToShow" datepicker-popup="{{format}}" datepicker-options="dateOptions" datepicker-append-to-body="{{datepickerAppendToBody}}" ng-required="true" show-button-bar="false" readonly="readonly" ng-click="open($event)"> <span class="svg-icon calendar" ng-click="open($event)" shim-include="" src="\'/static-resources/assets/outline-icons/outline-calendar.svg\'"></span></div><span ng-show="showNights" class="label">{{noNights}} nights</span></div>'),e.put("vholsDateSelectList.html",'<div class="pl-select-box"><select class="form-control" ng-model="selectedMonth" ng-options="dt as (dt | date:selectedFormat) for dt in datesArray"></select></div>'),e.put("departureGateway.html",'<div class="gateway-list pl-select-box" ng-class="{\'empty\': !gateways || gateways.length == 0}"><span class="svg-icon flight" ng-show="!(gateways && gateways.length)" ng-include="\'/static-resources/assets/outline-icons/outline-plane.svg\'"></span><select id="id" class="form-control qa_depFrom" ng-model="selectedDepartureGateway" ng-change="persist(selectedDepartureGateway)" ng-options="departureGateway.description for departureGateway in gateways track by departureGateway.description" ng-disabled="!gateways || gateways.length == 0"><option value="" disabled="true">Choose an airport</option></select><span class="svg-icon flight" ng-show="!(gateways && gateways.length)" shim-include="" src="\'/static-resources/assets/outline-icons/outline-plane.svg\'"></span></div>'),e.put("patternDepartureGateway.html",'<div class="input-container gateway-list" ng-class="{\'empty\': !gateways || gateways.length == 0}"><label class="select-box pl-select-box"><select id="id" class="qa_depFrom" ng-model="selectedDepartureGateway" ng-change="persist(selectedDepartureGateway)" ng-options="departureGateway.description for departureGateway in gateways track by departureGateway.description" ng-disabled="!gateways || gateways.length == 0" ng-required="required" name="{{ name }}"><option value="" disabled="true">Choose an airport</option></select></label></div>'),e.put("destinationsList.html",'<div class="destinations-list"><ul><li ng-repeat="item in parentLocations" class="{{item.type}}" ng-class="{\'expanded\': $index === selectedIdx}"><span ng-click="selectLocation(item, $index)">{{item.locationDescription}} <i class="shim-icon" ng-if="$index !== selectedIdx" aria-label="Click to open" shim-include="" src="\'/static-resources/assets/old-icons/chevron-down.svg\'"></i> <i class="shim-icon" ng-if="$index === selectedIdx" aria-label="Click to close" shim-include="" src="\'/static-resources/assets/old-icons/chevron-up.svg\'"></i></span><ul><li ng-click="selectLocationForSearch(item)">All {{item.locationDescription}}</li><li ng-repeat="child in item.children | orderBy:[\'!!index\', \'index\']" ng-click="selectLocationForSearch(child)">{{child.locationDescription}}</li></ul></li></ul></div>'),e.put("destinationsListModal.html",'<div class="modal-header"><h3 class="modal-title text-center">Destinations</h3><span ng-click="cancel()" class="modal-close pointer"><i class="shim-icon" aria-label="Click to close" shim-include="" src="\'/static-resources/assets/old-icons/x-symbol.svg\'"></i></span></div><div class="modal-body" stop-event="touchend"><destinations-list requires-departure-gateway="{{requiresDepartureGateway}}" selected-parent-location="selectedParentLocation" selected-child-location="selectedChildLocation" selected-departure-gateway="selectedDepartureGateway" brand="{{brand}}" with-ecms-id="withECMSId" popular-destinations="popularDestinations" booking-type="{{bookingType}}" result-size="100"></destinations-list></div>'),e.put("destinationsListOpen.html",'<a ng-click="open();trackClick();" class="destinations-list-open action-link"><span class="svg-icon" shim-include="" src="\'/static-resources/assets/solid-icons/icon-store-finder.svg\'"></span> Destinations List</a>'),e.put("durationPicker.html",'<div class="pl-select-box"><select class="form-control qa_duration" focus-blur ng-model="selectedDuration" ng-options="duration as duration|durationFormatter for duration in durationRange" ng-change="persist(selectedDuration)"></select></div>'),e.put("persistentCheckbox.html",'<div class="persistent-checkbox"><label for="{{vm.checkboxId}}" class="checkbox-label">{{vm.checkboxText}}</label><input type="checkbox" id="{{vm.checkboxId}}" class="checkbox-input" ng-model="vm.checkboxValue" ng-change="vm.persist(vm.checkboxValue)"></div>'),e.put("cruisepicker.html",'<div class="search-panel holiday-picker cruise-picker"><h1 class="picker-title">Select date</h1><div class="picker-loader-wrapper" ng-if="!isDataLoaded"><div class="picker-loader"></div></div><vhm-holiday-date-picker ng-if="isDataLoaded" date="startDate" on-date-selected="changeSelectedDate" available-dates="availableDates" available-months-from="availableMonthsFrom" available-months-amount="availableMonthsAmount"></vhm-holiday-date-picker><party-summary selected-rooms="selectedRooms" context="partyCompositionContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="cruisePartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" party-label="partyLabel"></party-summary><room-party-composition selected-rooms="selectedRooms" context="partyCompositionContext" max-adults="maximumAdults" default-num-adults="defaultNumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="toursPartyComp" view-state="viewState" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" column-offset="0"></room-party-composition><button type="button" ng-click="submit()" ng-disabled="!startDate || !availableDates.length" class="btn btn-primary btn-block btn-lg">Check availability</button></div>'),e.put("tourspicker.html",'<div class="search-panel holiday-picker tours-picker"><h1 class="picker-title">Select tour start date</h1><div class="picker-loader-wrapper" ng-if="!isDataLoaded"><div class="picker-loader"></div></div><vhm-holiday-date-picker ng-if="isDataLoaded" date="startDate" on-date-selected="changeSelectedDate" available-dates="availableDates"></vhm-holiday-date-picker><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="toursPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" party-label="partyLabel"></party-summary><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" default-num-adults="defaultNumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="toursPartyComp" view-state="viewState" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" column-offset="0" party-label="partyLabel"></room-party-composition><button type="button" ng-click="submit()" ng-disabled="!startDate || !availableDates.length" class="btn btn-primary btn-block btn-lg">Check availability</button></div>'),e.put("room-strip-wrapper.html",'<div ng-repeat="room in selectedRooms track by $index"><div class="room-strip party-comp" ng-class="{\'first\' : $first, \'summary-hidden\': viewState === VIEW_STATE.FORM && context !== \'FLY_DRIVE\'}"><div class="container"><div class="room clearfix"><div class="room-details col-md-offset-{{columnOffset}} col-md-2" ng-class="{\'first-room\': $first && (viewState === VIEW_STATE.FORM || context == \'FLY_DRIVE\'), \'phone-bookings\': maxChildren === 0}"><div class="room-title" ng-show="(context !== \'FLY_DRIVE\' && context !== \'CRUISE\')"><span class="label">Room {{room.roomNumber}}</span></div><div class="room-pax"><label for="room_{{room.roomNumber}}_adults">Adults</label><div class="pl-select-box validatable-select-input" infant-validation infant-error="infantError" ng-class="{\'invalid\': infantError}"><select id="room_{{room.roomNumber}}_adults" class="form-control" ng-model="room.adults" ng-options="adult as adult for adult in adults" ng-change="passengerChange(room)"></select></div></div><div class="room-pax"><label class="label-overflow" for="room_{{room.roomNumber}}_children">Children <small>(0 - {{maxChildAge}})</small></label><div ng-if="maxChildren > 0" class="pl-select-box validatable-select-input" infant-validation infant-error="infantError" ng-class="{\'invalid\': infantError}"><select id="room_{{room.roomNumber}}_children" class="form-control" ng-model="room.numberOfMinors" ng-options="child for child in children" ng-change="passengerChange(room);validateOnClick()"></select></div><div ng-if="maxChildren === 0 && $first" class="input-group paxInput select-group squared phone-bookings-text"><span class="phone-bookings-text">If your party includes <strong>children</strong> please call <strong><span class="rTapNumber232189">0344 417 3706</span></strong> to make your booking.</span></div></div></div></div></div></div><div class="room-strip child-ages" ng-show="room.numberOfMinors > 0 && maxChildren !== 0" ng-class="{\'summary-hidden\': viewState === VIEW_STATE.FORM && context !== \'FLY_DRIVE\', \'first\': $first}"><div class="container"><div class="row"><div class="room clearfix"><div class="col-md-6 col-xs-12 col-sm-12 col-md-offset-{{columnOffset-4}} col-sm-offset-0 col-xs-offset-0 room-children"><div class="child-age-prompt" ng-show="room.numberOfMinors > 0">Child ages on departure date<em>:</em></div><div class="child-age" row-count="filtered.length" ng-repeat="child in filtered = (room.minors) track by $index"><div class="labelled-text-input" ng-class="{\'valid\': child.age >= minChildAge}"><label for="child-age-{{child.id}}">Child {{child.id}}</label><div class="pl-select-box validatable-select-input" ng-class="{\'invalid\': !child.age && isFormSubmitted}"><select id="child-age-{{child.id}}" class="form-control" name="child" ng-model="child.age" focus-blur ng-change="passengerChange(room);validateChildAges()" ng-options="age|infantAgeFormatter for age in childAges track by age" required="required"><option value="" selected="true">Age</option></select></div></div></div><div class="arrow-above"></div></div></div></div></div></div></div>'),e.put("room-summary.html",'<div class="room-summary"><div ng-show="viewState === VIEW_STATE.SUMMARY && (context !== \'FLY_DRIVE\') && (context !== \'CRUISE\')"><h6 class="label">Rooms &amp; guests</h6><p ng-repeat="room in selectedRooms track by $index">Room {{$index + 1}}<ng-pluralize count="room.adults" when="{\n            \'0\': \': 0 adults.\',\n            \'one\': \': 1 adult\',\n            \'other\': \': {} adults\'\n        }"></ng-pluralize><ng-pluralize count="room.numberOfMinors" ng-if="maxChildren > 0" when="{\n            \'0\': \', 0 children\',\n            \'one\': \', 1 child\',\n            \'other\': \', {} children\'\n        }"></ng-pluralize></p><a class="action-link open-rooms" ng-click="toggleRooms()" ng-class="{\'closed\': showRooms}" ng-bind="showRooms ? \'Hide room details\' : \'Edit rooms &amp; guests\'"></a></div><div ng-show="viewState === VIEW_STATE.FORM || (context === \'FLY_DRIVE\') || (context === \'CRUISE\')" class="room clearfix" ng-repeat="room in selectedRooms | limitTo: 1"><div class="room-details col-md-2 col-md-offset-8" ng-class="{\'first-room\': $first && (viewState === VIEW_STATE.FORM || context == \'FLY_DRIVE\'), \'phone-bookings\': maxChildren === 0}"><div class="room-title" ng-show="(context !== \'FLY_DRIVE\') && (context !== \'CRUISE\')"><span class="label" ng-if="!partyLabel">Room {{room.roomNumber}}</span> <span class="label" ng-if="partyLabel">{{ partyLabel }}</span></div><div class="labelled-text-input room-pax"><label for="room_{{room.roomNumber}}_adults">Adults</label><div class="pl-select-box validatable-select-input" infant-validation infant-error="infantError" ng-class="{\'invalid\': infantError}"><select id="room_{{room.roomNumber}}_adults" class="form-control" ng-model="room.adults" ng-options="adult as adult for adult in adults" ng-change="passengerChange(room);checkNinePlus()"></select></div></div><div class="labelled-text-input room-pax"><label class="label-overflow" for="room_{{room.roomNumber}}_children">Children <small>(0 - {{maxChildAge}})</small></label><div ng-if="maxChildren > 0" class="pl-select-box validatable-select-input" infant-validation infant-error="infantError" ng-class="{\'invalid\': infantError}"><select id="room_{{room.roomNumber}}_children" class="form-control" ng-model="room.numberOfMinors" ng-options="child for child in children" ng-change="passengerChange(room);validateOnClick()"></select></div><div ng-if="maxChildren === 0" class="input-group paxInput select-group squared phone-bookings-text"><span>If your party includes <strong>children</strong> please call <strong><span class="rTapNumber232189">0344 417 3706</span></strong> to make your booking.</span></div></div></div><div class="room-strip child-ages" ng-show="room.numberOfMinors > 0 && maxChildren !== 0"><div class="room clearfix"><div class="col-md-10 col-xs-12 text-right room-children"><div class="row"><div class="child-age-prompt" ng-show="room.numberOfMinors > 0">Child ages on departure date<em>:</em></div><div class="child-age" row-count="filtered.length" ng-repeat="child in filtered = (room.minors) track by $index"><label for="child-age-{{child.id}}">Child {{child.id}}</label><div class="pl-select-box validatable-select-input" ng-class="{\'invalid\': !child.age && isFormSubmitted}"><select id="child-age-{{child.id}}" class="form-control" ng-model="child.age" focus-blur ng-change="passengerChange(room);validateChildAges();" ng-options="age|infantAgeFormatter for age in childAges track by age" required="required"><option value="" selected="true">Age</option></select></div></div></div></div></div></div></div><div class="form-error top down left" ng-show="(formError || (childAgeError && !childAgeValid && isFormSubmitted))" ng-class="{\'pax-error\': paxError && !isNinePlusEnabled, \'mega-error\': childAgeError && infantError && (paxError && !isNinePlusEnabled)}"><p ng-if="!ninePlusEnabled" ng-show="paxError">To book online please select a maximum of 9 passengers, to book 10 adults or more please call <b>0344 557 3978</b></p><p ng-show="childAgeError && !childAgeValid && isFormSubmitted">Please enter all child ages</p><p ng-show="infantError">There must be 1 adult per child under two years of age travelling, please adjust your passenger number</p></div><vhols-nine-plus-panel ng-if="isNinePlusEnabled" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors"></vhols-nine-plus-panel></div>'),e.put("rooms.html",'<div ng-init="showRooms = false" ng-show="showRooms"><div><div class="rooms" shim-include src="\'room-strip-wrapper.html\'"></div><div class="container" ng-show="(context !== \'FLY_DRIVE\') && (context !== \'CRUISE\') && (context !== \'TOURS\')"><div class="col-md-6 col-md-offset-{{roomLinksOffset}} room-links"><div ng-class="{roomChangeButtons: room.numberOfChildren > 0, addRemove: !showRemove}"><div ng-class="{addRemoveToggle: showRemove}"><a ng-show="selectedRooms.length < maxRooms" ng-click="addRoom()" class="action-link add-room"><i class="shim-icon" shim-include="" src="\'/static-resources/assets/old-icons/plus.svg\'"></i> <span>Add a room</span></a> <a ng-show="selectedRooms.length > 1" ng-click="removeRoom()" class="action-link remove-room"><i class="shim-icon" shim-include="" src="\'/static-resources/assets/old-icons/minus.svg\'"></i> <span>Remove a room</span></a></div></div></div></div></div></div>'),e.put("multipleDepartureGateway.html",'<div class="multiple-departure-gateway" ng-class="{ active: vm.listVisible, \'invalid\': vm.isFormSubmitted && !vm.isDisabled() && vm.selectedGateways.length === 0 }" role="listbox" ng-disabled="vm.isDisabled()"><div class="gateway-selected-value" ng-click="vm.toggleListVisibility()"><span class="value" ng-style="{\'max-width\': vm.getMaxAirportNameWidth(vm.selectedGateways.length) + \'px\'}" ng-class="{\'has-more\': vm.selectedGateways.length > 1}" ng-if="vm.selectedGateways.length > 0">{{vm.selectedGateways[0][vm.displayProperty]}}</span> <span class="value more-selected" ng-if="vm.selectedGateways.length > 1">+ {{vm.selectedGateways.length - 1}} more</span> <span class="value" ng-if="vm.selectedGateways.length === 0">Choose an airport</span> <span class="input-group-addon inputAddon"><i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/solid-arrow-down.svg\'"></i></span></div><ul class="gateway-values-list" ng-class="{hidden: !vm.listVisible}" role="presentation"><li class="gateway" role="option" ng-repeat="gateway in vm.gateways" ng-click="vm.toggleGatewaySelection(gateway)" ng-mouseenter="hoverIndex = $index" ng-mouseleave="hoverIndex = null" ng-mouseup="hoverIndex = null" ng-class="{ selected: vm.isGatewaySelected(gateway), hover: hoverIndex === $index}"><label class="gateway-value">{{gateway[vm.displayProperty]}}</label><span class="tick"></span></li><li><button type="button" class="btn btn-default btn-close-opt-list" ng-click="vm.closeList()">Done</button></li></ul></div>'),e.put("ninePlus.html",'<div class="lightb-opener" ng-class="{ \'open\' : ninePlus }"></div><div class="lightb-overlay nineplus-lightbox"><div class="lightb" ng-class="{\'nineplus-lightb-dark\' : vm.currentStep > 0}"><a class="close-link" ng-click="closeNinePlus($event);"></a><div class="nineplus-container"><div class="nineplus-inner" ng-class="{ \'nineplus-hidden-xs\' : vm.currentStep > 0 }"><h1 class="heading-sm underline-center text-center nineplus-heading">Bookings for 9+ passengers</h1><p ng-if="vm.currentStep < 3" class="body-md text-center"><strong>We love a big party!</strong><br>However, we can only book up to 9 passengers online. So that we may help you further, please fill out a quote request form.</p></div><div class="nineplus-inner nineplus-headings"><div class="nineplus-heading-spacer"></div><div class="nineplus-headings-center"><div class="nineplus-request-quote" ng-class="{ \'nineplus-xs\' : vm.currentStep > 0 }"><span class="pattern-icon"><i class="shim-icon" aria-label="Online chat icon" shim-include="" src="\'/static-resources/assets/outline-icons/online-chat.svg\'"></i></span><h2 class="heading-xxs">Request a quote</h2><p class="body-md hidden-sm hidden-md hidden-lg" ng-class="{\'hidden-xs\': vm.currentStep > 0}"><a ng-click="vm.details()" class="nineplus-quote-expander">We just need a few details <i class="shim-icon" ng-if="vm.currentStep < 1 " aria-label="Click to scroll right" shim-include="" src="\'/static-resources/assets/old-icons/chevron-right.svg\'"></i></a></p><p class="body-md" ng-class="{\'hidden-xs\': vm.currentStep == 0}">We just need a few details</p></div></div><div class="nineplus-heading-spacer"></div></div><div class="nineplus-inner nineplus-travel-plans" ng-show="vm.currentStep < 2" ng-class="{\'nineplus-expand-mobile\': vm.currentStep == 1}"><ng-form name="vm.travelplans"><div class="row"><div class="col-xs-12 col-sm-8 col-sm-offset-2"><div class="booking-steps-dotted" current-step-number="1 of 2" current-step-name="Travel Plans"><a class="step current active" option-name="Travel Plans"></a> <a class="step ie10step" option-name="Contact Details"></a></div></div></div><div class="row"><div class="col-xs-12"><h2 class="heading-xxs">Travel Plans</h2></div></div><div class="row"><div class="col-xs-12"><div class="input-container"><label for="destination">Destination</label><div class="validatable-text-input" error-message="Please enter a value" ng-class="{\n                                        \'invalid\' : (vm.travelplans.$submitted ||vm.travelplans.locationsTypeAhead.$touched) && vm.travelplans.locationsTypeAhead.$invalid,\n                                        \'valid\' : (vm.travelplans.$submitted ||vm.travelplans.locationsTypeAhead.$touched) && vm.travelplans.locationsTypeAhead.$valid\n                                        }"><vhols-pattern-type-ahead popular-destinations="popularDestinations" name="locationsTypeAhead" persist-key="{{vm.typeaheadPersistKey}}" async-selected="vm.selectedChildLocation" prompt="Destination / hotel name" brand="{{vm.brand}}" max-results="4" booking-type="{{vm.bookingType}}" with-ecms-id="false" no-results="noResults" use-tracking="vm.useTracking"></vhols-pattern-type-ahead></div></div></div></div><div class="row"><div class="col-xs-12"><label for="flying from">Flying from</label><div class="validatable-select-input" error-message="Please enter a value" ng-class="{\n                                        \'invalid\' : (vm.travelplans.$submitted || vm.travelplans.flyingFrom.$touched) && vm.travelplans.flyingFrom.$invalid,\n                                        \'valid\' : (vm.travelplans.$submitted || vm.travelplans.flyingFrom.$touched) && vm.travelplans.flyingFrom.$valid\n                                        }"><pattern-departure-gateway class="input-container" ng-if="!isMultipleDepartureEnabled" gateways="vm.selectedChildLocation.locationMetadata.gateway" selected-departure-gateway="vm.nineplus.flyingFrom" persist-key="{{vm.depGwPersistKey}}" name="flyingFrom" use-tracking="vm.useTracking" required></pattern-departure-gateway></div></div></div><div class="row"><div class="col-xs-6"><div class="input-container"><date-input label="When" popup-type="start" show-nights="false" date="vm.checkInDate" persist-key="checkInDate" date-input-id="departure-date" initial-date="vm.initialCheckInDate" min-date="vm.minDepartureDate" max-date="vm.maxDepartureDate" no-nights="notUsed" datepicker-append-to-body="true" months-to-show="vm.monthsToShowStart" use-tracking="vm.useTracking"></date-input></div></div><div class="col-xs-6"><div class="input-container"><label for="duration">How long</label><div class="validatable-select-input" error-message="Please enter a value" ng-class="{\n                                        \'invalid\' : (vm.travelplans.$submitted || vm.travelplans.duration.$touched) && vm.travelplans.duration.$invalid,\n                                        \'valid\' : (vm.travelplans.$submitted || vm.travelplans.duration.$touched) && vm.travelplans.duration.$valid\n                                        }"><div class="select-box pl-select-box"><select ng-model="vm.nineplus.duration" name="duration" required ng-options="ncount as ncount + \' Night\' + (ncount > 1 ? \'s\' : \'\') for ncount in vm.range(1,28)"></select></div></div></div></div></div><div class="row"><div class="col-xs-6"><div class="input-container"><label for="adults">Adults</label><div class="validatable-text-input" error-message="Please enter a value" ng-class="{\n                                        \'invalid\' : (vm.travelplans.$submitted || vm.travelplans.adults.$touched) && vm.travelplans.adults.$invalid,\n                                        \'valid\' : (vm.travelplans.$submitted || vm.travelplans.adults.$touched) && vm.travelplans.adults.$valid\n                                        }"><input class="text-input" type="number" min="0" step="1" name="adults" ng-min="1" ng-model="vm.nineplus.adults" placeholder="How many?" required></div></div></div><div class="col-xs-6"><div class="input-container"><label for="children">Children (0-17)</label><div class="validatable-text-input" error-message="Please enter a value" ng-class="{\n                                        \'invalid\' : (vm.travelplans.$submitted || vm.travelplans.children.$touched) && vm.travelplans.children.$invalid,\n                                        \'valid\' : (vm.travelplans.$submitted || vm.travelplans.children.$touched) && vm.travelplans.children.$valid\n                                        }"><input class="text-input" type="number" min="0" step="1" name="children" ng-model="vm.nineplus.children" placeholder="How many?" required></div></div></div></div><div class="row"><div class="col-xs-12"><div class="input-container nineplus-continue"><button class="button button-secondary" id="continue" name="submit" ng-click="vm.doContinue()">continue <i class="shim-icon" ng-if="vm.currentStep < 1 " role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/chevron-right.svg\'"></i></button></div></div></div></ng-form></div><div class="nineplus-inner nineplus-contact-form" ng-show="vm.currentStep == 2"><ng-form name="vm.contact"><div class="col-xs-12 col-sm-8 col-sm-offset-2"><div class="booking-steps-dotted" current-step-number="2 of 2" current-step-name="Contact details"><a class="step active" option-name="Travel Plans" ng-click="vm.currentStep = 1"></a> <a class="step current active ie10step" option-name="Contact Details"></a></div></div><div class="row"><div class="col-xs-12"><h2 class="heading-xxs">Your Details</h2></div></div><div class="row"><div class="col-xs-6"><div class="input-container"><label for="title">Title</label><div class="validatable-select-input" error-message="Please enter your title." ng-class="{\n                                        \'invalid\' : (vm.contact.$submitted || vm.contact.title.$touched) && vm.contact.title.$invalid,\n                                        \'valid\' : (vm.contact.$submitted || vm.contact.title.$touched) && vm.contact.title.$valid\n                                        }"><div class="select-box pl-select-box"><select ng-model="vm.nineplus.title" name="title" required><option value="" selected="selected">Select title</option><option value="mr">Mr</option><option value="mrs">Mrs</option><option value="miss">Miss</option><option value="ms">Ms</option><option value="sir">Sir</option><option value="dr">Dr</option><option value="prof">Prof.</option><option value="rev">Rev</option></select></div></div></div></div><div class="col-xs-6"><div class="input-container"><label for="firstname">First name</label><div class="validatable-text-input" error-message="Please enter your first name." ng-class="{\n                                        \'invalid\' : (vm.contact.$submitted || vm.contact.firstname.$touched) && vm.contact.firstname.$invalid,\n                                        \'valid\' : (vm.contact.$submitted || vm.contact.firstname.$touched) && vm.contact.firstname.$valid\n                                        }"><input class="text-input" type="text" id="firstname" name="firstname" ng-model="vm.nineplus.firstname" ng-pattern="/^([a-zA-Z-\'’ \\\\-u007f\\\\-u00ff\\\\-u2019\\\\-u0000]{2,255})$/" required></div></div></div></div><div class="row"><div class="col-xs-12"><div class="input-container"><label for="lastname">Last name</label><div class="validatable-text-input" error-message="Please enter your last name." ng-class="{\n                                        \'invalid\' : (vm.contact.$submitted || vm.contact.lastname.$touched) && vm.contact.lastname.$invalid,\n                                        \'valid\' : (vm.contact.$submitted || vm.contact.lastname.$touched) && vm.contact.lastname.$valid\n                                        }"><input class="text-input" type="text" id="lastname" name="lastname" ng-model="vm.nineplus.lastname" ng-pattern="/^([a-zA-Z-\'’ \\\\-u007f\\\\-u00ff\\\\-u2019\\\\-u0000]{2,255})$/" required></div></div></div></div><div class="row"><div class="col-xs-12"><div class="input-container"><label for="telephone">Telephone number</label><div class="validatable-text-input" error-message="Please enter a valid telephone number." ng-class="{\n                                        \'invalid\' : (vm.contact.$submitted || vm.contact.telephone.$touched) && vm.contact.telephone.$invalid,\n                                        \'valid\' : (vm.contact.$submitted || vm.contact.telephone.$touched) && vm.contact.telephone.$valid\n                                        }"><input class="text-input" type="text" valid-telephone id="telephone" name="telephone" ng-model="vm.nineplus.telephone" required placeholder="e.g. 01234 567890"></div></div></div></div><div class="row"><div class="col-xs-12"><div class="input-container"><label for="email">Email address</label><div class="validatable-text-input" error-message="Please enter a valid email address." ng-class="{\n                                        \'invalid\' : (vm.contact.$submitted || vm.contact.email.$touched) && vm.contact.email.$invalid,\n                                        \'valid\' : (vm.contact.$submitted || vm.contact.email.$touched) && vm.contact.email.$valid\n                                        }"><input class="text-input" type="text" id="email" name="email" ng-model="vm.nineplus.email" required ng-pattern="/^(([^&lt;&gt;()[\\]\\\\.,;:\\s@\\&quot;]+(\\.[^&lt;&gt;()[\\]\\\\.,;:\\s@\\&quot;]+)*)|(\\&quot;.+\\&quot;))@((\\[[0-9]{1,4}\\.[0-9]{1,4}\\.[0-9]{1,4}\\.[0-9]{1,4}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,4}))$/"></div><span class="help-text">We will only contact you about this quote</span></div></div></div><div class="row"><div class="col-xs-12"><div class="input-container"><button class="button button-primary button-block" id="submit" name="submit" ng-click="vm.doSubmit()">Send request</button></div></div></div></ng-form></div><div class="nineplus-inner nineplus-thank-you" ng-show="vm.currentStep == 3"><div class="row"><div class="col-xs-12"><div ng-if="!vm.error"><h2 class="heading-xxs underline-center text-center">Thank you for your quote request</h2><p class="body-md text-center">One of our travel experts will be in touch within 48 hours to help with your enquiry</p></div><div ng-if="vm.error"><h2 class="heading-xxs underline-center text-center">Sorry, there was an error</h2><p class="body-md text-center">Please try again later or call our booking team on 0344 557 4321</p></div></div></div></div><div class="nineplus-inner nineplus-footers"><p>Please read our <a href="/important/privacy-statement" target="_blank">privacy policy</a></p></div></div></div></div>'),
e.put("rangepicker-modal.html",'<div class="rangepicker-modal"><div class="modal-header"><h3 class="modal-title" ng-if="!modal.fromDate && !modal.errorMessage">Select your <strong>departure</strong> date</h3><h3 class="modal-title" ng-if="modal.fromDate && !modal.errorMessage">Now, select your <strong>return</strong> date</h3><h3 class="modal-title modal-alert" ng-if="modal.errorMessage"><span>{{modal.errorMessage}}</span></h3><span ng-click="modal.cancel()" class="modal-close pointer"><i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/cross.svg\'"></i></span></div><div class="modal-body" id="modal-body"><vhm-rangepicker-content initial-from-date="modal.initialFromDate" initial-to-date="modal.initialToDate" from-date="modal.fromDate" to-date="modal.toDate" min-date="modal.minDate" max-date="modal.maxDate" min-range="modal.minRange" max-range="modal.maxRange" months-to-show="modal.monthsToShow" on-complete="modal.ok" on-error="modal.error" booking-type="modal.bookingType"></vhm-rangepicker-content></div></div>'),e.put("rangepicker-wrapper.html",'<div class="row rangepicker-wrapper"><div class="col-xs-8 col-sm-6"><div class="date-picker-wrapper" vhm-rangepicker from-date="checkInDate" to-date="checkOutDate" min-date="minDate" max-date="maxDate" min-range="minNights" max-range="maxNights" months-to-show="monthsToShow" on-change="updateRange" booking-type="bookingType"><label class="hsp-label ng-binding" for="checkin-date" ng-click="$event.stopPropagation();">{{fromDateLabel}}</label><input id="checkin-date" type="text" placeholder="Select a date" class="form-control" ng-model="checkInDate" vhm-date-field="DD/MM/YYYY" readonly="true" ng-required="true"> <span class="svg-icon calendar" shim-include="" src="\'/static-resources/assets/outline-icons/outline-calendar.svg\'"></span></div></div><div class="col-xs-8 col-sm-6"><div class="date-picker-wrapper" vhm-rangepicker from-date="checkInDate" to-date="checkOutDate" min-date="minDate" max-date="maxDate" min-range="minNights" max-range="maxNights" return-only="true" months-to-show="monthsToShow" on-change="updateRange" booking-type="bookingType"><label class="hsp-label ng-binding" for="checkout-date" ng-click="$event.stopPropagation()">{{toDateLabel}}</label><input id="checkout-date" type="text" placeholder="Select a date" class="form-control" ng-model="checkOutDate" vhm-date-field="DD/MM/YYYY" readonly="true" ng-required="true"> <span class="svg-icon calendar" shim-include="" src="\'/static-resources/assets/outline-icons/outline-calendar.svg\'"></span></div></div></div>'),e.put("synchroniseCheckbox.html",'<input class="qa_altDropOff" type="checkbox" ng-change="toggleWatching(toggleState)" ng-model="toggleState.value">'),e.put("timePicker.html",'<div class="pl-select-box"><select class="form-control qa_pickUpTime" ng-model="selectedTime" ng-options="o as (o | date:\'HH:mm\') for o in pickUpTimes track by selectedTimeTracker(o)" ng-change="update()" id="{{id}}" ng-disabled="!inputValuesValid()"><option value="" disabled="true">Time</option></select></div>'),e.put("destinationsListDropdown.html",'<div class="destination-list-dropdown"><div class="pl-select-box validatable-select-input" ng-class="{\'invalid\': !selectedItem && isFormSubmitted}"><select ng-select class="form-control" ng-model="selectedItem" ng-change="updateSelection()" ng-options="item as item.listName group by item.groupLabel for item in dropdownList | orderBy:\'displayOrder\'" required="required"><option value="" disabled="disabled" selected="selected">Select a destination</option></select></div></div>'),e.put("datepicker/holiday-datepicker.html",'<div class="holiday-date-picker-content"><div class="row holiday-header"><div class="col-xs-3"><button class="pull-right control btn btn-link" type="button" ng-click="vm.selectPrevMonth()" ng-disabled="!vm.hasPrevMonth()"><i class="shim-icon" aria-label="Click to go back" shim-include="" src="\'/static-resources/assets/old-icons/chevron-left.svg\'"></i></button></div><div class="col-xs-6 text-center"><div class="holiday-month-selector"><select class="form-control" id="month-selector" ng-model="vm.selectedMonth" ng-options="month | date:\'MMM yyyy\' for month in vm.availableMonths" ng-change="vm.changeSelectedMonth(vm.selectedMonth)"></select></div></div><div class="col-xs-3"><button class="pull-left control btn btn-link" type="button" ng-click="vm.selectNextMonth()" ng-disabled="!vm.hasNextMonth()"><i class="shim-icon" aria-label="Click to scroll right" shim-include="" src="\'/static-resources/assets/old-icons/chevron-right.svg\'"></i></button></div></div><div class="holiday-date-picker"><table class="table"><thead class="table-head"><tr class="row"><td class="cell">Mon</td><td class="cell">Tue</td><td class="cell">Wed</td><td class="cell">Thu</td><td class="cell">Fri</td><td class="cell">Sat</td><td class="cell">Sun</td></tr></thead><tbody class="table-body"><tr class="row" ng-repeat="week in vm.selectedMonthWeeks"><td class="cell" ng-repeat="day in week track by $index" ng-class="{\'selected\': vm.isSelectedDate(day), \'outside-selected-month\': !vm.isSameMonth(day, vm.selectedMonth) }" ng-disabled="vm.isOutsideRange(day)" ng-click="vm.isOutsideRange(day) || vm.changeSelectedDay(day)"><span>{{day | date:\'d\'}}</span></td></tr></tbody></table></div></div>'),e.put("datepicker-popup/holiday-datepicker-modal.html",'<vhm-holiday-date-picker date="vm.date" on-date-selected="vm.ok" available-dates="vm.availableDates"></vhm-holiday-date-picker>'),e.put("datepicker-popup/holiday-datepicker-popup.html",'<div class="row date-picker-wrapper"><label class="holiday-datepicker-label" for="holiday-date-picker">{{label}}</label><input id="holiday-date-picker" type="text" class="form-control" placeholder="Select date" ng-model="date" vhm-date-field="DD/MM/YYYY" readonly="true" ng-required="true"> <span class="svg-icon calendar" ng-click="open($event)" shim-include="" src="\'/static-resources/assets/outline-icons/outline-calendar.svg\'"></span></div>'),e.put("content/rangepicker-content.html",'<div class="rangepicker-content"><div class="row"><div class="col-sm-6 col-xs-12"><div class="header-bar field"><vhols-date-select list="vm.availableMonths" selected="vm.selectedMonth" format="MMMM yyyy"></vhols-date-select></div></div><div class="col-sm-6 hidden-xs selected-month"><p>{{vm.nextMonth | date:\'MMMM yyyy\'}}</p><i class="icon-checked" ng-if="!vm.isLastMonthSelected()" ng-click="vm.selectNextMonth()"></i></div></div><div class="row"><div class="col-sm-6 col-xs-12"><vhols-date-picker month="vm.selectedMonth" initial-from-date="vm.initialFromDate" initial-to-date="vm.initialToDate" min-date="vm.minDate" max-date="vm.maxDate" from-date="vm.fromDate" to-date="vm.toDate"></vhols-date-picker></div><div class="col-sm-6 hidden-xs"><vhols-date-picker month="vm.nextMonth" initial-from-date="vm.initialFromDate" initial-to-date="vm.initialToDate" min-date="vm.minDate" max-date="vm.maxDate" from-date="vm.fromDate" to-date="vm.toDate"></vhols-date-picker></div><div class="selected-duration text-center"><ng-pluralize count="vm.hoverDuration || vm.duration" when="{\'0\': \'{{vm.hoverDuration || vm.duration}} nights\',\n                                \'1\': \'{{vm.hoverDuration || vm.duration}} night\',\n                                \'other\': \'{{vm.hoverDuration || vm.duration}} nights\'}"></ng-pluralize></div></div></div>'),e.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)" ng-init="monthsToShow = $root.monthsToShow"><span ng-init="monthSelection = $parent.monthSelection"></span> <span ng-init="selectedMonth = $parent.selectedMonth"></span><daypicker ng-switch-when="day" tabindex="0"></daypicker><monthpicker ng-switch-when="month" tabindex="0"></monthpicker><yearpicker ng-switch-when="year" tabindex="0"></yearpicker></div>'),e.put("template/datepicker/day.html",'<div class="calendar"><table><thead><tr class="headings"><th ng-show="showWeeks" class="text-center"></th><th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th></tr></thead><tbody><tr ng-repeat="row in rows track by $index"><td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td><td ng-repeat="(daynum, dt) in row track by dt.date" ng-class="{\'direct-flight\' : directFlight(dt.date) && !dt.secondary && !dt.disabled, \'foof\': dt.secondary}" class="text-center day-box" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}"><button type="button" class="btn btn-default btn-sm btn-sq btn-dt-select" ng-class="{\'btn-info\': dt.selected, \'direct-flight\' : directFlight(dt.date), \'btn-secondary\' : dt.secondary}" ng-click="select(dt.date)" ng-disabled="dt.disabled"><span class="day-name">{{labels[daynum].abbr}}</span> {{dt.label | number}}</button></td></tr></tbody></table></div>'),e.put("template/datepicker/popup.html",'<div class="modal fade in datepicker {{$parent.popupType}}" ng-click="isOpen = false" ng-show="isOpen" ng-class="{\'opened\': isOpen}" ng-style="{display: (isOpen && \'block\') || \'none\'}"><div class="modal-dialog" stop-event="touchend" ng-init="monthsLimit = $parent.monthsToShow" ng-click="$event.stopPropagation();"><div class="modal-content modal-content-calendar"><div class="calendarHeader"><div class="dialogHeader"><div class="row"><div class="col-xs-8"><span class="title">{{$parent.dateLabel}}</span></div><div class="col-xs-4 text-right"><a href="" class="vIconAlign" ng-click="isOpen = false"><span class="text">{{closeText}}</span> <i class="shim-icon" aria-label="Click to close" shim-include="" src="\'/static-resources/assets/old-icons/x-symbol.svg\'"></i></a></div></div></div></div><div><div class="row dateHeader"><div class="col-xs-4"><button class="control btn btn-link pull-left" type="button" disabled="disabled" ng-click="$parent.monthsFromStart = $parent.monthsFromStart - 1;$parent.monthMove(-1);$parent.monthSelection($parent.monthsFromStart);" ng-disabled="$parent.monthsFromStart < 1"><i class="shim-icon" aria-label="Click to scroll left" shim-include="" src="\'/static-resources/assets/old-icons/chevron-left.svg\'"></i> <span class="month-select-text previous-month-select">Previous <span class="extended-text">month</span></span></button></div><div class="col-xs-4 text-center"><div class="month-selector pl-select-box"><select stop-event="touchend" class="form-control" id="month-selector" ng-model="$parent.selectedMonth" ng-options="item.label for item in $parent.dateSelections track by item.move" ng-change="$parent.monthsFromStart = $parent.selectedMonth.idx;$parent.monthMove($parent.selectedMonth.move);$parent.monthSelection($parent.monthsFromStart);"></select></div></div><div class="col-xs-4"><button class="control btn btn-link pull-right" type="button" ng-click="$parent.monthsFromStart = $parent.monthsFromStart + 1;$parent.monthMove(1);$parent.monthSelection($parent.monthsFromStart);" ng-disabled="$parent.monthsFromStart >= $parent.monthsToShow"><i class="shim-icon" aria-label="Click to scroll right" shim-include="" src="\'/static-resources/assets/old-icons/chevron-right.svg\'"></i> <span class="month-select-text next-month-select">Next <span class="extended-text">month</span></span></button></div></div></div><div ng-transclude></div></div></div></div>'),e.put("content/date-picker/date-picker.html",'<div class="date-picker"><table class="table"><thead class="table-head"><tr class="row"><td class="cell">Mo</td><td class="cell">Tu</td><td class="cell">We</td><td class="cell">Th</td><td class="cell">Fr</td><td class="cell">Sa</td><td class="cell">Su</td></tr></thead><tbody class="table-body"><tr class="row" ng-repeat="week in selectedMonthWeeks"><td class="cell" ng-repeat="day in week track by $index" ng-class="{\'disabled\': isOutsideRange(day), \'selected\': isSelectedDate(day), \'between\': isBetween(day), \'empty\': !day}" ng-mouseover="onMouseOver(day)" ng-mouseleave="onMouseLeave()" ng-mouseup="onMouseLeave()" ng-click="selectDay(day)"><span>{{day | date:\'d\'}}</span></td></tr></tbody></table></div>'),e.put("content/date-select/date-select.html",'<div class="date-select" ng-class="{ active: listVisible }" role="listbox"><div class="date-display" ng-click="show();"><span class="value">{{selected | date:format}}</span> <i class="shim-icon" ng-if="listVisible" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/icon-arrow-up.svg\'"></i> <i class="shim-icon" ng-if="!listVisible" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/icon-arrow-down.svg\'"></i></div><ul class="optList" ng-class="{hidden: !listVisible}" role="presentation"><li class="option" role="option" ng-repeat="item in list" ng-click="select(item)" ng-class="{ selected: isSelected(item) }"><span>{{item | date:format}}</span></li></ul></div>'),e.put("template/typeahead/pattern-typeahead.html",'<div class="typeahead-wrapper"><input class="text-input validatable-text-input invalid" error-message="No Results" name="{{name}}" ng-model="asyncSelected" type="text" placeholder="{{prompt}}" typeahead="location as location.indexedDescription for location in getLocation($viewValue)" typeahead-loading="loadingLocations" typeahead-min-length="3" value="{{asyncSelected.indexedDescription}}" autocomplete="off" required> <span class="form-error up bottom left" ng-show="noResults" role="listbox" aria-hidden="{{!noResults}}"><p shim-include src="\'typeahead-error.html\'"></p></span> <span class="svg-icon clear" ng-click="clear()" ng-show="asyncSelected"><i class="shim-icon" aria-label="Click to close" shim-include="" src="\'/static-resources/assets/old-icons/x-symbol.svg\'"></i></span></div>'),e.put("template/typeahead/typeahead-match.html",'<a class="suggestion pointer" tabindex="-1" ng-click="$parent.selectMatch(index); $event.stopPropagation()" ng-class="{active: $parent.isActive(index)}" ng-mouseenter="$parent.selectActive(index)"><i class="shim-icon" ng-if="match.model.locationTypeId == 100" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/hotel.svg\'"></i> <i class="shim-icon" ng-if="match.model.locationTypeId != 100" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/sp-marker.svg\'"></i> <span bind-html-unsafe="match.model.highlightedDescription || match.model.indexedDescription"></span></a>'),e.put("template/typeahead/typeahead-popup.html",'<div class="typeahead dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block" role="listbox" aria-hidden="{{!isOpen()}}"><ul id="typeahead"><li ng-repeat="match in matches" role="option" ng-class="{\'dropdown-hotel\': match.model.locationTypeId == 100, \'dropdown-destination\': match.model.locationTypeId != 100}"><div ng-init="hotelCountString = match.model.totalCount > 1 ? \' hotels \' : \' hotel \'" class="section-title" vhols-typeahead-title="" go="query" type="match.model.locationTypeId" ng-class="{first: $first}">{{match.model.locationTypeId == 100 ? \'Best Match Hotels\' : \'Best Match Destinations\'}}</div><div typeahead-match index="$index" match="match" query="query" template-url="template/typeahead/typeahead-match.html"></div></li><li class="view-destinations-list" ng-show="$parent.bookingType != 5"><destinations-list-modal requires-departure-gateway="false" selected-parent-location="selectedParentLocation" selected-child-location="$parent.$parent.$parent.selectedChildLocation" selected-departure-gateway="selectedDepartureGateway" brand="{{$parent.brand}}" with-ecms-id="$parent.withEcmsId" popular-destinations="$parent.popularDestinations" booking-type="{\'id\': $parent.bookingType}">Destinations list</destinations-list-modal><!-- Not ideal using $parent here but the alternatives are horrid. MB --></li></ul></div>'),e.put("template/typeahead/typeahead.html",'<div type-ahead-validation class="labelled-text-input"><div class="typeahead-wrapper validatable-text-input" ng-class="{\'empty\': !asyncSelected, \'invalid\': (isFormSubmitted && (!asyncSelected || !asyncSelected.locationMetadata)) || (noResults && !!asyncSelected)}"><input name="{{name}}" ng-model="asyncSelected" type="text" placeholder="{{prompt}}" typeahead="location as location.indexedDescription for location in getLocation($viewValue)" typeahead-loading="loadingLocations" typeahead-min-length="3" class="form-control" value="{{asyncSelected.indexedDescription}}" autocomplete="off" required> <span class="svg-icon sp-marker" ng-show="!asyncSelected" shim-include="" src="\'/static-resources/assets/outline-icons/outline-store-finder.svg\'"></span> <span class="svg-icon clear" ng-click="clear()" ng-show="asyncSelected"><i class="shim-icon" aria-label="Click to close" shim-include="" src="\'/static-resources/assets/old-icons/x-symbol.svg\'"></i></span></div><div class="form-error" ng-show="noResults && !!asyncSelected"><span shim-include src="\'typeahead-error.html\'"></span></div></div>'),e.put("form-error.html","<span>Oops, something's not quite right. Please fix the below errors and try again.</span>"),e.put("typeahead-error.html","<span>Sorry, no matches were found.</span>"),e.put("templates/cars.html",'<div class="car-search-panel" ng-cloak="" ng-controller="CarOnlySearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section><label>Pick up</label><span>{{selectedPickUpDepot.locationDescription}}</span></section><section><label>Depart</label><span>{{checkInDate | date: \'EEE dd MMM yyyy\'}}</span></section><section><label>Time</label><span>{{selectedPickupTime | date: \'HH:mm\'}}</span></section><section><label>Drop off</label><span>{{selectedDropOffDepot.locationDescription}}</span></section><section><label>Return</label><span>{{checkOutDate | date: \'EEE dd MMM yyyy\'}}</span></section><section><label>Time</label><span>{{selectedDropOffTime | date: \'HH:mm\'}}</span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="carOnlySearchForm" class="search-panel-form" action="{{formAction}}" method="post" novalidate="novalidate" form-validation="carOnlySearchForm"><input type="hidden" name="erd" value="false"> <input type="hidden" name="businessContext" value="{{businessContext}}"> <input type="hidden" name="bookingType" value="{{selectedBookingType.id}}"><div class="container"><p class="main-form-error" ng-show="mainFormError"><shim-include src="\'form-error.html\'"></shim-include></p><div class="row"><div class="col-xs-12 col-sm-12 col-md-5"><div class="row"><div class="col-xs-12 col-sm-4 col-md-4 col-lg-4"><div class="form-group"><label for="pickupTypeAhead">Pick up</label><vhols-type-ahead id="qaFreeText" popular-destinations="popularDestinations" required="required" name="pickupTypeAhead" persist-key="coTypeAheadPickUp" async-selected="selectedPickUpDepot" prompt="Type city / airport" brand="{{businessContext}}" max-results="4" default-loc="defaultLoc" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" no-results="validPickUpDestination" is-form-submitted="carOnlySearchForm.$submitted"></vhols-type-ahead><input type="hidden" name="pickupCity" value="{{selectedPickUpDepot.details.cityName}}"> <input type="hidden" name="pickupArea" value="{{selectedPickUpDepot.details.carLocationId}}"> <span class="form-error nowrap" ng-show="(carOnlySearchForm.$submitted && (carOnlySearchForm.pickupTypeAhead.$error.required || !selectedPickUpDepot.details.carLocationId)) && !validPickUpDestination">please select a pick up point</span></div></div><div class="col-xs-6 col-sm-3 col-md-4 col-lg-4"><div class="form-group"><date-input label="Check in date" sr-label="true" popup-type="start" show-nights="false" date="checkInDate" persist-key="checkInDate" date-input-id="checkin-date" initial-date="initialCheckInDate" min-date="minCheckInDate" max-date="maxCheckInDate" no-nights="noNights" datepicker-append-to-body="true" months-to-show="monthsToShowStart" class="qa_pickUpDate"></date-input><input type="hidden" name="pickUpDate" value="{{checkInDate | date:\'dd/MM/yyyy\'}}"></div></div><div class="col-xs-6 col-sm-3 col-md-4 col-lg-4 no-label"><div class="form-group"><label for="pickUpTimes" class="label-sr">Pick up times</label><time-picker name="pickupTimes" for-date="checkInDate" location="selectedPickUpDepot" selected-time="selectedPickupTime" required-time="requiredPickupTime" increment-by="15" id="pickupTimes" persist-key="coPickUpime"></time-picker><input type="hidden" name="pickupTime" value="{{selectedPickupTime}}"></div></div></div></div><div class="col-xs-12 col-sm-12 col-md-7"><div class="row"><div class="col-xs-12 col-sm-4 col-md-3 drop-off"><div class="form-group"><label for="dropOffTypeAhead">Drop off</label><div ng-hide="!toggleState.value"><vhols-type-ahead popular-destinations="popularDestinations" id="qa_freeTextDropOff" name="dropOffTypeAhead" persist-key="coTypeAheadDropOff" async-selected="selectedDropOffDepot" prompt="Type city / airport" brand="{{businessContext}}" default-loc="defaultLoc" max-results="4" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" no-results="validDropOffDestination" is-form-submitted="carOnlySearchForm.$submitted"></vhols-type-ahead><input type="hidden" name="dropOffCity" value="{{selectedDropOffDepot.details.cityName}}"> <input type="hidden" name="dropOffArea" value="{{selectedDropOffDepot.details.carLocationId}}"> <span class="form-error down top left nowrap" ng-show="(carOnlySearchForm.$submitted && (carOnlySearchForm.dropOffTypeAhead.$error.required || !selectedDropOffDepot.details.carLocationId)) && !validDropOffDestination">please select a drop off point</span></div></div><label class="return-selection" ng-class="{\'solo-box\': !toggleState.value}"><synchronise-checkbox watch="selectedPickUpDepot" update="selectedDropOffDepot" when="false" toggle-state="toggleState" persist-key="coSyncCkbx"></synchronise-checkbox>At different location</label></div><div class="col-xs-6 col-sm-3 col-md-3"><div class="form-group"><date-input label="Check out date" sr-label="true" popup-type="end" show-nights="true" date="checkOutDate" persist-key="checkOutDate" date-input-id="checkout-date" min-date="minCheckOutDate" max-date="maxCheckOutDate" min-nights="minimumNights" max-nights="maximumNights" watch-check-in="checkInDate" watch-check-out="checkOutDate" no-nights="noNights" datepicker-append-to-body="true" months-to-show="monthsToShowEnd" class="qa_dropOffDate"></date-input></div></div><input type="hidden" name="dropOffDate" value="{{checkOutDate | date:\'dd/MM/yyyy\'}}"><div class="col-xs-6 col-sm-3 col-md-3"><div class="form-group"><label for="dropOffTimes" class="label-sr">Drop off times</label><time-picker name="dropOffTimes" for-date="checkOutDate" location="selectedDropOffDepot" selected-time="selectedDropOffTime" required-time="requiredDropOffTime" increment-by="15" id="dropOffTimes" persist-key="coDropOffTime"></time-picker><input type="hidden" name="dropOffTime" value="{{selectedDropOffTime}}"></div></div><div class="col-xs-12 col-sm-2 col-md-3"><div class="age-disclaimer colxs-12 visible-xs"><strong class="note">Please note:</strong> Drivers must be over the age of 21 to hire a car unless otherwise specified. Drivers between 21 and 24 years of age may be subject to additional costs.</div><div class="submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Cars <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></div></div></div><div class="row"><div class="age-disclaimer col-md-12 hidden-xs"><strong class="note">Please note:</strong> Drivers must be over the age of 21 to hire a car unless otherwise specified. Drivers between 21 and 24 years of age may be subject to additional costs.</div></div></div></form></div>'),e.put("templates/cruise-options.html",'<div class="cruise-options-search-panel" ng-cloak="" ng-controller="CruiseSearchPanelCtrl" ng-init="activate();"><div class="edit-search-overlay"><div class="container"><div><section><label class="search-title">You searched for</label><span class="search-value">Cruise</span></section><section><label class="search-title">Cruise Name</label><span class="search-value" ng-bind-html="cruiseName | to_trusted"></span></section><section><label class="search-title">Depart</label><span class="search-value">{{startDate | date: \'EEE dd MMM yyyy\'}}</span></section><section class="guests"><label class="search-title">No. of guests</label><span class="search-value"><em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em> <em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit</button></section></div></div></div><form name="cruiseOptionsSearchForm" class="search-panel-form" novalidate="novalidate"><div class="container"><div class="row"><div class="col-sm-5 col-md-4"><div class="row"><div class="col-xs-12 col-sm-7"><div class="form-group"><label>You searched for</label><span>Cruise</span></div></div><div class="col-xs-12 col-sm-5"><div class="form-group"><label>Cruise Name</label><span ng-bind-html="cruiseName | to_trusted"></span></div></div></div></div><div class="col-sm-7 col-md-6"><div class="row"><div class="col-sm-4"><div class="row"><div class="col-xs-8 col-sm-12 col-md-10"><div class="form-group"><vhm-holiday-date-picker-popup label="Depart" date="startDate" on-date-selected="changeSelectedDate" available-dates="availableDates"></vhm-holiday-date-picker-popup></div></div></div></div><div class="col-sm-8"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="cruisePartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState"></party-summary></div></div></div><div class="col-md-2 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" ng-disabled="!startDate || !partyCompValid" class="button button-primary">Update search</button></div></div></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="cruisePartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" column-offset="6"></room-party-composition></div><div class="container"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" ng-disabled="!startDate || !partyCompValid" class="button button-primary">Update search</button></div></div></form></div>'),e.put("templates/cruises.html",'<div class="cruise-search-panel" ng-cloak="" ng-controller="CruisesSearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="cruiseDriveSearchForm" class="search-panel-form" action="https://www.virginholidayscruises.co.uk/redirect.phtml" method="get" novalidate="novalidate"><input type="hidden" name="product" value="cruise"> <input type="hidden" name="sid" value="16956"> <input type="hidden" name="regionid" value="{{selectedDepartureGateway.id}}"> <input type="hidden" name="monthyear" value="{{selectedMonth | date:\'MM_yyyy\'}}"><div class="container"><div class="row"><section class="col-xs-12 col-sm-12 col-md-8"><div class="row"><div class="col-xs-12 col-sm-3 col-md-3 region-input"><div class="form-group"><label for="departingFrom">Region</label><departure-gateway id="qa_searchDepFrom" gateways="gateways" selected-departure-gateway="selectedDepartureGateway" persist-key="cruiseSelectedDepGw"></departure-gateway></div></div><div class="col-xs-12 col-sm-3 col-md-3 departing-input"><div class="form-group"><label class="hsp-label">Departing in</label><vhols-date-select-list persist-key="cruiseMonth" date-range="37" start-from="1" increment-by="1" selected-format="\'MMMM yyyy\'" selected-month="selectedMonth" id="qa_cruise_dep"></vhols-date-select-list></div></div><div class="col-xs-12 col-sm-3 col-md-3 submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Cruise <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></section></div></div></form></div>'),e.put("templates/flydrive.html",'<div class="flydrive-search-panel" ng-cloak="" ng-controller="FlyDriveSearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section><label>Going to</label><span>{{selectedChildLocation.indexedDescription}}</span></section><section><label>Flying from</label><span>{{selectedDepartureGateway.description}}</span></section><section><label>Depart</label><div><span ng-class="{ \'date-widened\': isDateWidened }">{{checkInDate | date: \'EEE dd MMM yyyy\'}}</span></div></section><section><label>Return</label><div><span ng-class="{ \'date-widened\': isDateWidened }">{{checkOutDate | date: \'EEE dd MMM yyyy\'}}</span></div></section><section class="guests"><label>Passengers</label><span><em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em><em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="flyDriveSearchForm" class="search-panel-form" novalidate="novalidate" form-validation="flyDriveSearchForm"><div class="container"><p class="main-form-error" ng-show="mainFormError"><shim-include src="\'form-error.html\'"></shim-include></p><div class="row"><div class="col-sm-12 col-md-5"><div class="row"><!-- Destination --><div class="col-sm-6 typeahead-input"><div class="form-group"><label for="goingTo">Destination</label><destinations-list-dropdown selected-child-location="selectedChildLocation" brand="{{businessContext}}" max-results="100" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" persist-key="fdTypeAhead" allow-parent-select="true" is-form-submitted="flyDriveSearchForm.$submitted"></destinations-list-dropdown><span class="form-error" ng-show="flyDriveSearchForm.$submitted && !selectedChildLocation.locationMetadata">Please select a location</span></div></div><div class="col-xs-12 col-sm-6 gateway"><div class="form-group"><label for="departingFrom">Flying from</label><departure-gateway id="departingFrom" gateways="selectedChildLocation.locationMetadata.gateway" selected-departure-gateway="selectedDepartureGateway" persist-key="fdSelectedDepGw"></departure-gateway></div></div></div></div><div class="col-sm-12 col-md-5"><div class="row"><div class="col-sm-6 col-md-7"><div class="form-group"><vhm-rangepicker-wrapper ng-if="isRangePickerEnabled" min-date="minCheckInDate" max-date="maxCheckInDate" initial-check-in-date="initialCheckInDate" min-nights="minimumNights" max-nights="maximumNights" check-in-date="checkInDate" check-out-date="checkOutDate" duration="chDuration" months-to-show="monthsToShowStart" check-in-persist-key="checkInDate" check-out-persist-key="checkOutDate" duration-persist-key="chDuration" from-date-label="Departing" to-date-label="Return" booking-type="selectedBookingType"></vhm-rangepicker-wrapper></div><div class="row" ng-if="!isRangePickerEnabled"><div class="col-xs-7"><div class="form-group"><!-- no-nights is not used when there is only one calender, this attribute can be removed if the business decide to permanently go with one calender --><date-input label="When" popup-type="start" show-nights="false" date="checkInDate" persist-key="checkInDate" date-input-id="checkin-date" initial-date="initialCheckInDate" min-date="minCheckInDate" max-date="maxCheckInDate" no-nights="notUsed" datepicker-append-to-body="true" months-to-show="monthsToShowStart"></date-input></div></div><div class="col-xs-5 calendar-input"><!-- DO NOT REMOVE COMMENTED OUT RETURN DATE (awaiting business decision between calender versus duration component) --><!-- <date-input\n                                            ng-hide="true"\n                                            label="Return"\n                                            popup-type="end"\n                                            show-nights="true"\n                                            date="checkOutDate"\n                                            persist-key="checkOutDate"\n                                            date-input-id="checkout-date"\n                                            min-date="minCheckOutDate"\n                                            max-date="maxCheckOutDate"\n                                            min-nights="minimumNights"\n                                            max-nights="maximumNights"\n                                            watch-check-in="checkInDate"\n                                            watch-check-out="checkOutDate"\n                                            no-nights="noNights"\n                                            datepicker-append-to-body="false"\n                                            months-to-show="monthsToShowEnd">\n                                    </date-input> --><div class="form-group"><label for="durationPick" class="label-overflow duration-overflow">How long</label><duration-picker id="durationPick" start-date="checkInDate" end-date="checkOutDate" range="1-28" default-duration="7" persist-key="chDuration"></duration-picker></div></div></div></div><div class="col-sm-6 col-md-5"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="flyDriveSearchForm.$submitted" persist-key="flyDrvPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" nine-plus-enabled="isNinePlusEnabled"></party-summary></div></div></div><div class="col-md-2 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find {{ name_type !== "b" ? selectedBookingType.name : \'Flight + Car\'}} <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></div><div class="hidden-xs hidden-sm search-panel-spacer"></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="flyDriveSearchForm.$submitted" persist-key="flyDrvPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" olumn-offset="6" nine-plus-enabled="isNinePlusEnabled"></room-party-composition></div><div class="container"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find {{ name_type !== "b" ? selectedBookingType.name : \'Flight + Car\'}} <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></form><vhols-nine-plus-panel ng-if="isNinePlusEnabled" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" max-pax="maximumPeople" check-in-date="checkInDate" brand="{{businessContext}}" booking-type="{{selectedBookingType.id}}" typeahead-persist-key="fdTypeAhead" selected-child-location="selectedChildLocation" dep-gw-persist-key="fdSelectedDepGw"></vhols-nine-plus-panel></div>'),
e.put("templates/holiday.html",'<div class="holiday-search-panel" ng-cloak="" ng-controller="CompleteHolidaySearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section><label>Going to</label><span>{{selectedChildLocation.indexedDescription}}</span></section><section><label>Flying from</label><span>{{selectedDepartureGateway.description}}</span> <span ng-if="isMultipleDepartureEnabled && selectedDepartureGateways.length > 1">And {{selectedDepartureGateways.length - 1}} more</span></section><section><label>Depart</label><div><span ng-class="{ \'date-widened\': isDateWidened }">{{checkInDate | date: \'EEE dd MMM yyyy\'}}</span></div></section><section><label>Return</label><div><span ng-class="{ \'date-widened\': isDateWidened }">{{checkOutDate | date: \'EEE dd MMM yyyy\'}}</span></div></section><section class="guests"><label>Rooms & guests</label><span>{{selectedRooms.length}} Room{{selectedRooms.length > 1 ? \'s\' : \'\'}} / <em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em><em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="holidaySearchForm" class="search-panel-form holiday-search-form" novalidate="novalidate" form-validation="holidaySearchForm"><div class="container"><p class="main-form-error" ng-show="mainFormError"><shim-include src="\'form-error.html\'"></shim-include></p><div class="row"><div class="col-sm-12 col-md-5"><div class="row"><div class="col-sm-6"><div class="form-group"><label for="goingTo">Destination</label><vhols-type-ahead id="goingTo" popular-destinations="popularDestinations" name="locationsTypeAhead" persist-key="chTypeAhead" async-selected="selectedChildLocation" prompt="Destination / hotel name" brand="{{businessContext}}" default-loc="defaultLoc" max-results="4" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" no-results="noResults" is-form-submitted="holidaySearchForm.$submitted"></vhols-type-ahead><div class="form-error" ng-show="(holidaySearchForm.$submitted && (holidaySearchForm.locationsTypeAhead.$error.required || !selectedChildLocation.locationMetadata)) && !noResults">Please select a location</div><span class="hidden-md hidden-lg" id="destinations-picker"><destinations-list-modal id="qa_destLink" requires-departure-gateway="false" selected-parent-location="selectedParentLocation" selected-child-location="selectedChildLocation" selected-departure-gateway="selectedDepartureGateway" brand="{{businessContext}}" with-ecms-id="withECMSId" popular-destinations="popularDestinations" booking-type="selectedBookingType">Destinations list</destinations-list-modal><span class="multicentre"><a ng-if="showMulticentreLink()" ng-click="selectMultiDestination($event)" class="multi-destination-link action-link"><i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/multi-dest.svg\'"></i> Multiple destinations?</a></span></span></div></div><div class="col-xs-12 col-sm-6 gateway"><div class="form-group"><label for="departingFrom">Flying from</label><div id="departingFrom" class="departure-picker"><vhm-multiple-departure-picker ng-if="isMultipleDepartureEnabled" gateways="selectedChildLocation.locationMetadata.gateway" selected-gateways="selectedDepartureGateways" first-selected-gateway="selectedDepartureGateway" booking-type="selectedBookingType" is-form-submitted="holidaySearchForm.$submitted"></vhm-multiple-departure-picker><departure-gateway ng-if="!isMultipleDepartureEnabled" gateways="selectedChildLocation.locationMetadata.gateway" selected-departure-gateway="selectedDepartureGateway" persist-key="chSelectedDepGw"></departure-gateway><vhm-persistent-checkbox ng-if="isDirectFlightsCheckboxEnabled" checkbox-value="cbDirectFlights" checkbox-text="I prefer direct flights" checkbox-id="cbDirectFlights" persist-key="cbDirectFlights" event-name="Direct Flight Toggle" booking-type="selectedBookingType"></vhm-persistent-checkbox><div class="form-error" ng-show="holidaySearchForm.$submitted && isMultipleDepartureEnabled && !selectedDepartureGateway && !!selectedChildLocation.locationMetadata">Please select a departure airport</div></div></div></div></div></div><div class="col-sm-12 col-md-5"><div class="row"><div class="col-sm-6 col-md-7"><div class="form-group"><vhm-rangepicker-wrapper ng-if="isRangePickerEnabled" min-date="minCheckInDate" max-date="maxCheckInDate" initial-check-in-date="initialCheckInDate" min-nights="minimumNights" max-nights="maximumNights" check-in-date="checkInDate" check-out-date="checkOutDate" duration="chDuration" months-to-show="monthsToShowStart" check-in-persist-key="checkInDate" check-out-persist-key="checkOutDate" duration-persist-key="chDuration" from-date-label="Departing" to-date-label="Return" booking-type="selectedBookingType"></vhm-rangepicker-wrapper></div><div class="row" ng-if="!isRangePickerEnabled"><div class="col-xs-7"><div class="form-group"><!-- no-nights is not used when there is only one calender, this attribute can be removed if the business decide to permanently go with one calender --><date-input label="When" popup-type="start" show-nights="false" date="checkInDate" persist-key="checkInDate" date-input-id="checkin-date" initial-date="initialCheckInDate" min-date="minCheckInDate" max-date="maxCheckInDate" no-nights="notUsed" datepicker-append-to-body="true" months-to-show="monthsToShowStart"></date-input></div></div><div class="col-xs-5"><div class="form-group"><label for="durationPick" class="label-overflow duration-overflow">How long</label><duration-picker id="durationPick" start-date="checkInDate" end-date="checkOutDate" range="1-28" default-duration="7" persist-key="chDuration"></duration-picker></div></div></div></div><div class="col-sm-6 col-md-5"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="compHolsPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" nine-plus-enabled="isNinePlusEnabled"></party-summary></div></div></div><div class="col-md-2 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Holidays <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></div><div class="container"><div class="col-xs-12"><span class="visible-md visible-lg destinations-picker" ng-class="{absolute: viewState == 0}" id="destinations-picker"><destinations-list-modal id="qa_destLink" requires-departure-gateway="false" selected-parent-location="selectedParentLocation" selected-child-location="selectedChildLocation" selected-departure-gateway="selectedDepartureGateway" brand="{{businessContext}}" with-ecms-id="withECMSId" popular-destinations="popularDestinations" booking-type="selectedBookingType">Destinations list</destinations-list-modal><span class="multi-destination"><a ng-if="showMulticentreLink()" ng-click="selectMultiDestination($event)" class="multi-destination-link action-link"><i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/multi-dest.svg\'"></i> Going to multiple destinations?</a></span></span></div></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="compHolsPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" nine-plus-enabled="isNinePlusEnabled" column-offset="8"></room-party-composition></div><div class="container"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Holidays <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></form><vhols-nine-plus-panel ng-if="isNinePlusEnabled" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" max-pax="maximumPeople" check-in-date="checkInDate" initial-check-in-date="initialCheckInDate" brand="{{businessContext}}" booking-type="{{selectedBookingType.id}}" typeahead-persist-key="chTypeAhead" selected-child-location="selectedChildLocation" dep-gw-persist-key="chSelectedDepGw"></vhols-nine-plus-panel></div>'),e.put("templates/hotels.html",'<div class="hotels-search-panel" ng-cloak="" ng-controller="HotelOnlySearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section><label>Going to</label><span>{{selectedChildLocation.indexedDescription}}</span></section><section><label>Check-in</label><span>{{checkInDate | date: \'EEE dd MMM yyyy\'}}</span></section><section><label>Check-out</label><span>{{checkOutDate | date: \'EEE dd MMM yyyy\'}}</span></section><section class="guests"><label>Rooms & guests</label><span>{{selectedRooms.length}} Room{{selectedRooms.length > 1 ? \'s\' : \'\'}} / <em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em><em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="hotelSearchForm" class="search-panel-form" action="//book.virginholidays.co.uk/" method="get" novalidate="novalidate" form-validation="hotelSearchForm"><!-- Searching for --><div class="container"><p class="main-form-error" ng-show="mainFormError"><shim-include src="\'form-error.html\'"></shim-include></p><div class="row"><section class="col-xs-12 col-md-5"><div class="row"><!-- Destination --><div class="col-xs-12"><div class="form-group"><label for="goingTo">Destination</label><vhols-type-ahead id="qaFreeText" popular-destinations="popularDestinations" name="locationsTypeAhead" persist-key="hoTypeAhead" async-selected="selectedChildLocation" prompt="Destination / hotel name" brand="{{businessContext}}" max-results="4" default-loc="defaultLoc" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" no-results="noResults" is-form-submitted="hotelSearchForm.$submitted"></vhols-type-ahead><span class="form-error down top left" ng-show="(hotelSearchForm.$submitted && (holidaySearchForm.locationsTypeAhead.$error.required || !selectedChildLocation.locationMetadata)) && !noResults">Please select a location</span><div class="destinations-picker" ng-class="{absolute: viewState == 0}"><destinations-list-modal id="qa_destLink" requires-departure-gateway="false" selected-parent-location="selectedParentLocation" selected-child-location="selectedChildLocation" selected-departure-gateway="selectedDepartureGateway" brand="{{businessContext}}" with-ecms-id="withECMSId" popular-destinations="popularDestinations" booking-type="selectedBookingType">Destinations list</destinations-list-modal></div></div></div></div></section><section class="col-xs-12 col-sm-12 col-md-7 depart-section"><div class="row"><div class="col-xs-12 col-sm-8 col-md-5 col-lg-5"><div class="form-group"><vhm-rangepicker-wrapper ng-if="isRangePickerEnabled" min-date="minCheckInDate" max-date="maxCheckInDate" initial-check-in-date="initialCheckInDate" min-nights="minimumNights" max-nights="maximumNights" check-in-date="checkInDate" check-out-date="checkOutDate" duration="chDuration" months-to-show="monthsToShowStart" check-in-persist-key="checkInDate" check-out-persist-key="checkOutDate" duration-persist-key="hoDuration" from-date-label="Check in" to-date-label="Check out" booking-type="selectedBookingType"></vhm-rangepicker-wrapper></div><div class="row" ng-if="!isRangePickerEnabled"><div class="col-xs-7 calendar-input"><div class="form-group"><!-- no-nights is not used when there is only one calender, this attribute can be removed if the business decide to permanently go with one calender --><date-input label="Check in" popup-type="start" show-nights="false" date="checkInDate" persist-key="checkInDate" date-input-id="checkin-date" initial-date="initialCheckInDate" min-date="minCheckInDate" max-date="maxCheckInDate" no-nights="notUsed" datepicker-append-to-body="true" months-to-show="monthsToShowStart" flying-days="flyingDays" flying-days-leg="flyingDays.inDay"></date-input></div></div><div class="col-xs-5 calendar-input"><!-- return --><!-- DO NOT REMOVE COMMENTED OUT RETURN DATE (awaiting business decision between calender versus duration component) --><!-- <date-input\n                                            label="Check Out"\n                                            popup-type="end"\n                                            show-nights="true"\n                                            date="checkOutDate"\n                                            persist-key="checkOutDate"\n                                            date-input-id="checkout-date"\n                                            min-date="minCheckOutDate"\n                                            max-date="maxCheckOutDate"\n                                            min-nights="minimumNights"\n                                            max-nights="maximumNights"\n                                            watch-check-in="checkInDate"\n                                            watch-check-out="checkOutDate"\n                                            no-nights="noNights"\n                                            datepicker-append-to-body="false"\n                                            months-to-show="monthsToShowEnd"\n                                            flying-days="flyingDays"\n                                            flying-days-leg="flyingDays.outDay">\n                                    </date-input> --><div class="form-group"><label for="durationPick" class="label-overflow duration-overflow">How long</label><duration-picker id="durationPick" start-date="checkInDate" end-date="checkOutDate" range="1-28" default-duration="7" persist-key="hoDuration"></duration-picker></div></div></div></div><!-- party composition --><div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 party-comp-input"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="hotelSearchForm.$submitted" persist-key="hotOnlyPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" nine-plus-enabled="isNinePlusEnabled"></party-summary></div><div class="col-md-3 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Hotels <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></section></div></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="hotelSearchForm.$submitted" persist-key="hotOnlyPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" column-offset="8" nine-plus-enabled="isNinePlusEnabled"></room-party-composition></div><div class="container"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Hotels <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></form><vhols-nine-plus-panel ng-if="isNinePlusEnabled" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" max-pax="maximumPeople" check-in-date="checkInDate" brand="{{businessContext}}" booking-type="{{selectedBookingType.id}}" typeahead-persist-key="hoTypeAhead" selected-child-location="selectedChildLocation"></vhols-nine-plus-panel></div>'),e.put("templates/multi-centre.html",'<div class="multicentre-search-panel" ng-cloak="" ng-controller="MultiCentreSearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section><label>Going to</label><span>{{selectedChildLocation.indexedDescription}}</span></section><section><label>Depart</label><span>{{checkInDate | date: \'EEE dd MMM yyyy\'}}</span></section><section class="guests"><label>Rooms & guests</label><span>{{selectedRooms.length}} Room{{selectedRooms.length > 1 ? \'s\' : \'\'}} / <em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em><em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="multiCentreSearchForm" class="search-panel-form" novalidate="novalidate" form-validation="multiCentreSearchForm"><div class="container"><p class="main-form-error" ng-show="mainFormError"><shim-include src="\'form-error.html\'"></shim-include></p><div class="row"><div class="col-xs-12"><div class="col-md-3 col-sm-4 col-xs-12"><div class="form-group"><label>My holiday should include:</label><destinations-list-dropdown selected-child-location="selectedChildLocation" brand="{{businessContext}}" max-results="100" booking-type="{{selectedBookingType.id}}" with-ecms-id="withECMSId" persist-key="multicentreSelectedLocationId" is-form-submitted="multiCentreSearchForm.$submitted"></destinations-list-dropdown><span class="form-error" ng-show="(multiCentreSearchForm.$submitted && !selectedChildLocation.locationMetadata)">Please select a location</span></div></div><div class="col-md-2 col-sm-4 col-xs-9"><div class="form-group"><date-input label="When" popup-type="start" show-nights="false" date="checkInDate" initial-date="initialCheckInDate" persist-key="checkInDate" date-input-id="checkin-date" min-date="multicentreMinCheckinDate" max-date="multicentreMaxCheckinDate" no-nights="notUsed" datepicker-append-to-body="true" months-to-show="monthsToShow"></date-input></div></div><div class="col-md-2 col-sm-4 col-xs-12 party-summary-container"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="multiCentreSearchForm.$submitted" persist-key="multiDestPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" nine-plus-enabled="isNinePlusEnabled"></party-summary></div><div class="col-md-2 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Holidays <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></div></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="multiCentreSearchForm.$submitted" persist-key="multiDestPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" column-offset="5" room-links-offset="1" nine-plus-enabled="isNinePlusEnabled"></room-party-composition></div><div class="row"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Holidays <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></form><vhols-nine-plus-panel ng-if="isNinePlusEnabled" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" max-pax="maximumPeople" check-in-date="checkInDate" brand="{{businessContext}}" booking-type="{{selectedBookingType.id}}" typeahead-persist-key="chTypeAhead" selected-child-location="selectedChildLocation" dep-gw-persist-key="mdSelectedDepGw"></vhols-nine-plus-panel></div>'),e.put("templates/searchPanel.html","<div class=\"search-panel sp-vhols vhols\" ng-class=\"{'hide-search-panel' : hideSearchPanel, 'tour-panel': selectedBookingType.shortName === 'tour', 'cruise-options-panel': selectedBookingType.shortName === 'cruise_options', 'multi-destination-panel' : (selectedBookingType.shortName === 'multi-destination' || selectedBookingType.shortName === 'multidestination' || selectedBookingType.shortName === 'multicentre') }\" ng-controller=\"SearchPanelCtrl as parentCtrl\"><div class=\"bookingtype-select-containter\"><div ng-show=\"!!selectedBookingType && !selectedBookingType.hideOtherTabs\" class=\"container booking-type-select\"><vhols-bookingtype-select selected-booking-type=\"selectedBookingType\" label=\"Search for\"></vhols-bookingtype-select></div></div><shim-include src=\"selectedBookingType.uri\"></shim-include></div>"),e.put("templates/tour.html",'<div class="tour-search-panel" ng-cloak="" ng-controller="TourSearchPanelCtrl" ng-init="activate();"><div class="edit-search-overlay"><div class="container"><div><section><label class="search-title">You searched for</label><span class="search-value">Tours</span></section><section><label class="search-title">Tour Name</label><span class="search-value" ng-bind-html="tourName | to_trusted"></span></section><section><label class="search-title">Depart</label><span class="search-value">{{startDate | date: \'EEE dd MMM yyyy\'}}</span></section><section class="guests"><label class="search-title">Rooms &amp; guests</label><span class="search-value">{{selectedRooms.length}} Room{{selectedRooms.length > 1 ? \'s\' : \'\'}} / <em>{{ totalSelectedAdults }} Adult{{totalSelectedAdults > 1 ? \'s\' : \'\'}}</em><em ng-if="totalSelectedMinors > 0">, {{totalSelectedMinors}} {{totalSelectedMinors > 1 ? \'Children\' : \'Child\'}}</em></span> <a class="tour-config action-link" ng-click="scrollTo(\'slide-down-room\')" ng-if="totalSelectedAdults > 1">Change configuration</a></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit</button></section></div></div></div><form name="tourSearchForm" class="search-panel-form" novalidate="novalidate"><div class="container"><div class="row"><div class="col-sm-5 col-md-4"><div class="row"><div class="col-xs-12 col-sm-7"><div class="form-group"><label>You searched for</label><span>Tours</span></div></div><div class="col-xs-12 col-sm-5"><div class="form-group"><label>Tour Name</label><span ng-bind-html="tourName | to_trusted"></span></div></div></div></div><div class="col-sm-7 col-md-6"><div class="row"><div class="col-sm-4"><div class="row"><div class="col-xs-8 col-sm-12 col-md-10"><div class="form-group"><vhm-holiday-date-picker-popup label="Depart" date="startDate" on-date-selected="changeSelectedDate" available-dates="availableDates"></vhm-holiday-date-picker-popup></div></div></div></div><div class="col-sm-8"><party-summary selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="tourPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState"></party-summary></div></div></div><div class="col-md-2 visible-md visible-lg submit-container"><button type="button" ng-click="submit($event)" ng-disabled="!startDate || !partyCompValid" class="button button-primary">Update search</button></div></div></div><div class="rooms-list" ng-class="{\'show-rooms\': selectedRooms.length === 1}"><room-party-composition selected-rooms="selectedRooms" context="holidayContext" max-adults="maximumAdults" max-child-age="maximumChildAge" max-children="maximumChildren" max-infants="maximumInfants" min-child-age="minimumChildAge" max-pax="maximumPeople" child-age-valid="childAgeValid" party-comp-valid="partyCompValid" is-form-submitted="isFormSubmitted" persist-key="tourPartyComp" total-selected-adults="totalSelectedAdults" total-selected-minors="totalSelectedMinors" view-state="viewState" column-offset="6"></room-party-composition></div><div class="container"><div class="col-xs-12 col-sm-6 col-sm-offset-3 hidden-md hidden-lg submit-container"><button type="button" ng-click="submit($event)" ng-disabled="!startDate || !partyCompValid" class="button button-primary">Update search</button></div></div></form></div>'),e.put("templates/tours.html",'<div class="tours-search-panel" ng-cloak="" ng-controller="ToursSearchPanelCtrl"><div class="edit-search-overlay"><div class="container"><div><section><label>You searched for</label><span>{{selectedBookingType.name}}</span></section><section class="btn-container"><button ng-click="parentCtrl.editPanel()" class="button button-secondary">Edit search</button></section></div></div></div><form name="toursDriveSearchForm" class="search-panel-form" novalidate="novalidate"><div class="container"><div class="row"><section class="col-xs-12 col-sm-12 col-md-8"><div class="row"><div class="col-xs-12 col-sm-3 col-md-3 region-input"><div class="form-group"><label for="departingFrom">Destination</label><departure-gateway id="qa_searchDepFrom" gateways="gateways" selected-departure-gateway="selectedDepartureGateway" persist-key="tourSelectedDepGw"></departure-gateway></div></div><div class="col-xs-12 col-sm-3 col-md-3 departing-input"><div class="form-group"><label class="hsp-label">Departing in</label><vhols-date-select-list persist-key="tourMonth" date-range="14" start-from="2" increment-by="1" selected-format="\'MMMM yyyy\'" selected-month="selectedMonth" id="qa_tours_dep"></vhols-date-select-list></div></div><div class="col-xs-12 col-sm-3 col-md-3 submit-container"><button type="button" ng-click="submit($event)" class="button button-primary search-button">Find Tours <i class="shim-icon" role="presentation" shim-include="" src="\'/static-resources/assets/old-icons/search-reverse.svg\'"></i></button></div></div></section></div></div></form></div>')}]),function(){"use strict";angular.module("vhols-submit").factory("SubmitFactory",["UnifySubmitFactory","SearchSubmitFactory","$rootScope","API_EVENTS",function(e,t,a,n){var i={};return a.$on(n.OVERRIDE_DEFAULT_SUBMIT,function(){i.submitHotel=function(e){a.$emit(n.SUBMITTED,e)},i.submitHoliday=function(e){a.$emit(n.SUBMITTED,e)},i.submitFlyDrive=function(e){a.$emit(n.SUBMITTED,e)},i.submitCar=function(e){a.$emit(n.SUBMITTED,e)},i.submitMultiCentre=function(e){a.$emit(n.SUBMITTED,e)}}),i.submitHotel=function(e){e.gateway=null,e.selectedDepartureGateway=null,t.submitLink(e)},i.submitMultiCentre=function(e){e.selectedDepartureGateway=null,t.submitLink(e)},i.submitHoliday=function(e){t.submitLink(e)},i.submitFlyDrive=function(e){t.submitLink(e)},i.submitCar=function(e){t.submitCar(e)},i.submitTourCruise=function(e){t.submitTourCruise(e)},i}]).run(["SubmitFactory",function(e){}])}(),function(){"use strict";angular.module("vhols-submit").factory("UnifySubmitFactory",["dates","$window","LOCATION_TYPE_ID","URL",function(e,t,a,n){function i(t,a){a.push(d("businessContext","205")),a.push(d("bookingType",t.selectedBookingType.id)),a.push(d("dateRange.startDate",e(t.checkInDate).format())),a.push(d("dateRange.endDate",e(t.checkOutDate).format())),a.push(d("dateRange.duration",e(t.checkInDate).diffDays(e(t.checkOutDate)))),s(t.selectedChildLocation.locationTypeId)?(a.push(d("selectedLocationMap["+t.selectedBookingType.id+"][0]",t.selectedChildLocation.parentEcmsId)),a.push(d("hotelCode",t.selectedChildLocation.locationId))):a.push(d("selectedLocationMap["+t.selectedBookingType.id+"][0]",t.selectedChildLocation.locationMetadata.ecmsId))}function o(e,t){t.push(d("departurePoint",e.selectedDepartureGateway.code))}function s(e){return e===a.HOTEL}function l(e,t){var a=e.selectedRooms;t.push(d("rooms",a.length));for(var n=0;n<a.length;n++){var i=a[n].roomNumber-1;t.push(d("partyCompositionList["+i+"].adults",a[n].adults)),t.push(d("partyCompositionList["+i+"].children",a[n].numberOfChildren)),t.push(d("partyCompositionList["+i+"].infants",a[n].numberOfInfants));for(var o=a[n].children,s=0;s<o.length;s++)t.push(d("childAgesList["+i+"]["+(o[s].id-1)+"]",o[s].age))}}function r(e){e.push(d("searchType","BROWSE")),e.push(d("portal:componentId","2860")),e.push(d("portal:type","action")),e.push(d("portal:portletMode","view")),e.push(d("erd","false")),e.push(d("promo","0"))}function c(e,a){var i=e.join(n.DELIMITER),o=a+"?"+i;t.location.href=o}function d(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}var u={};return u.submitHotel=function(e,t){var a=[];i(e,a),l(e,a),r(a),c(a,t)},u.submitHoliday=function(e,t){var a=[];i(e,a),o(e,a),l(e,a),r(a),c(a,t)},u.submitFlyDrive=function(e,t){var a=[];i(e,a),o(e,a),l(e,a),r(a),c(a,t)},u}])}(),function(){"use strict";angular.module("vhols-submit").factory("SearchSubmitFactory",["dates","$window","$http","$filter","LOCATIONS","LOCATION_TYPE_ID","BOOKING_TYPE_CONST","DATES","URL","BookingTypeFactory","DepartureGatewayPersistenceService",function(e,t,a,n,i,o,s,l,r,c,d){function u(e,t){D(e.shortName,t)}function m(t,a,n){k("departureDate",e(t.checkInDate).format(l.URL_STRING),n),f(t.holidayContext)||k("duration",e(t.checkInDate).diffDays(e(t.checkOutDate)),n),g(t.selectedChildLocation.locationTypeId)?(D(t.selectedChildLocation.parentLocationUrlDescription,a),D(t.selectedChildLocation.locationUrlDescription,a),D("options",a)):D(t.selectedChildLocation.locationUrlDescription,a),t.selectedDepartureGateways&&(k("gateways",d.toString(t.selectedDepartureGateways),n),
k("vhab.f8609",!0,n)),void 0!==t.selectedDepartureGateway&&null!==t.selectedDepartureGateway&&k("gateway",t.selectedDepartureGateway.code,n)}function p(e,t){e.searchTarget&&D(e.searchTarget,t)}function h(t,a){k("departureDate",e(t.checkInDate).format(l.URL_STRING),a),k("pickUpTime",e(t.selectedPickupTime).format(l.URL_TIME),a),k("dropOffTime",e(t.selectedDropOffTime).format(l.URL_TIME),a),k("duration",t.noNights,a)}function v(e,t){D(e.selectedPickUpDepot.locationUrlDescription,t),D(e.selectedDropOffDepot.locationUrlDescription,t)}function g(e){return e===o.HOTEL}function f(e){return e===s.MULTI_CENTRE}function y(e,t,a){for(var n=e.selectedRooms,i=2==a?"passengers":"room",o=0;o<n.length;o++){for(var s=["a"+n[o].adults,"i"+n[o].numberOfInfants],l=n[o].children,r=0;null!=l&&r<l.length;r++)s.push("c"+l[r].age);var c=s.join(",");k(i,c,t)}}function b(e,a){var n=e.join("/"),i=a.join(r.DELIMITER),o="/"+n+"?"+i;t.location.href=o}function D(e,t){t.push(e)}function k(e,t,a){a.push(e+"="+t)}var S={};return S.submitLink=function(e){var t=e.selectedBookingType.id,a=[],n=[],i=c.getBookingType(t);u(i,a),m(e,a,n),p(e,a),y(e,n,t),b(a,n)},S.submitCar=function(e){var t=e.selectedBookingType.id,a=[],n=[],i=c.getBookingType(t);u(i,a),v(e,a),h(e,n),b(a,n)},S.submitTourCruise=function(t){var a=[],n=[];D(t.searchType,a),D(t.regionUrlValue,a),D(t.urlFriendlyId,a),D("options",a),k("departureDate",e(t.startDate).format(l.URL_STRING),n),y(t,n),b(a,n)},S}])}();